import{u as H,a as Y,y as v,r as N,c as j,b,d as I,f as L,B as h,w as J,F as z,e as K,k as u,g as W,h as g,o as c,i as y,t as _,z as V,A as X}from"./index-8-F5s4j3.js";import{u as Z,r as l,m as ee}from"./i18n-validators-72j1n4q8.js";import{a as oe,u as ae}from"./generic.services-CQjHStj7.js";import{u as F}from"./useQuery-KERFi8ks.js";import{c as re}from"./crud.services-Xs683v05.js";import{c as se,d as le}from"./manual.services-4pjALTqx.js";const ne={class:"manage section-height shadowed"},te={class:"manage__inner section-padding"},ye={__name:"create",async setup(de){let a,p;const P=oe(),S=W();H(),Y();const{data:E,isSuccess:B,isLoading:q}=([a,p]=v(()=>F({queryKey:["organizations"],queryFn:()=>se()})),a=await a,p(),a),{data:C,isSuccess:k,isLoading:O}=([a,p]=v(()=>F({queryKey:["roles"],queryFn:()=>le()})),a=await a,p(),a),s=N({fullName:"",userName:"",password:"",phoneNumber:"",organizationId:[],roleId:[]}),R=j(()=>({fullName:{required:l},userName:{required:l},password:{required:l,minLength:ee},phoneNumber:{required:l},organizationId:{required:l},roleId:{required:l}})),r=Z(R,s),M=N([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password",errorKey:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),T=N([{id:1,model:"organizationId",label:"employeesOrganizationLabel",placeholder:"employeesOrganizationPlaceholder",errorKey:"organizationId",options:E,success:B,loading:q},{id:2,model:"roleId",label:"employeesRoleLabel",placeholder:"employeesRolePlaceholder",errorKey:"roleId",options:C,success:k,loading:O}]),{mutate:x}=ae({onMutate:o=>{o.organizationId=o.organizationId[0],o.roleId=o.roleId[0]},mutationFn:o=>re("user",o),onSuccess:()=>{P.invalidateQueries({queryKey:["employees"]}),S.push(X.EMPLOYEES.path)}}),U=()=>{r.value.$validate(),!r.value.$errors.length&&(x(s.value),r.value.$reset())};return(o,ie)=>{var $,w;const Q=g("Title"),A=g("FormInput"),G=g("FormSelect"),D=g("CustomButton");return c(),b("section",ne,[I("div",te,[L(Q,null,{default:h(()=>[y(`\r
                `+_(o.$t("addNewEmployeesTitle"))+`\r
            `,1)]),_:1}),I("form",{class:"manage__form form-manage",onSubmit:J(U,["prevent"])},[(c(!0),b(z,null,K(M.value,e=>{var n,t,d,i,m;return c(),V(A,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":f=>s.value[e.model]=f,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(t=(n=u(r))==null?void 0:n[e.errorKey])==null?void 0:t.$error,textError:(m=(i=(d=u(r))==null?void 0:d[e.errorKey])==null?void 0:i.$errors[0])==null?void 0:m.$message},{default:h(()=>[y(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(c(!0),b(z,null,K(T.value,e=>{var n,t,d,i,m;return c(),V(G,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":f=>s.value[e.model]=f,width:500,options:e.options,error:(t=(n=u(r))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:t.$error,placeholder:e==null?void 0:e.placeholder,textError:(m=(i=(d=u(r))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:i.$errors[0])==null?void 0:m.$message,success:e.success,loading:e.loading},{default:h(()=>[y(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),L(D,{className:`form__submit ${(w=($=u(r))==null?void 0:$.roleId.$errors[0])!=null&&w.$message?"centered":""}`},{default:h(()=>[y(_(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{ye as default};
//# sourceMappingURL=create-9OafIUqn.js.map
