import{u as de,a as ie,r as d,z as y,c as S,y as C,d as $,e as E,k as M,h as i,w as ne,F as k,C as N,D as K,l as le,E as ue,m as I,o as p,B as L,A as R,f as O,t as q}from"./index-qZ69CyC7.js";import{u as ce,r as n}from"./i18n-validators-dGSGbQKY.js";import{a as me,u as ge}from"./generic.services-34GP1Yc8.js";import{u as v}from"./useQuery-IZNqF3Xo.js";import{a as pe,u as he}from"./crud.services-qYEmjzHd.js";import{m as ye,a as Ie,b as ve}from"./manual.services-BxKPmsPu.js";const be={class:"manage section-height shadowed"},_e={class:"manage__inner section-padding"},Be={__name:"update",async setup(fe){let s,r;const b=me(),B=le(),x=ue();de(),ie();const _=d(x.params.id),w=d(!1),f=d(!1),t=d({id:"",name:"",address:"",regionId:[],districtId:[],stateId:[]}),{data:D,isSuccess:Q,isLoading:T}=([s,r]=y(()=>v({queryKey:["regions"],queryFn:()=>ye()})),s=await s,r(),s),h=S(()=>t.value.regionId),H=S(()=>!!h.value.length);C(h,()=>{!f.value&&!w.value&&(t.value.districtId=[]),f.value=!1},{immediate:!0});const{data:P,isSuccess:U,isLoading:G}=([s,r]=y(()=>v({queryKey:["districts",{districtId:h}],queryFn:()=>Ie(h.value),enabled:H})),s=await s,r(),s),{data:A,isSuccess:J,isLoading:z}=([s,r]=y(()=>v({queryKey:["states"],queryFn:()=>ve()})),s=await s,r(),s),W=S(()=>({id:{required:n},name:{required:n},address:{required:n},regionId:{required:n},districtId:{required:n},stateId:{required:n}})),o=ce(W,t),X=d([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),Y=d([{id:1,model:"regionId",label:"regionObjectLabel",placeholder:"regionObjectPlaceholder",errorKey:"regionId",options:D,success:Q,loading:T},{id:2,model:"districtId",label:"districtObjectLabel",placeholder:"districtObjectPlaceholder",errorKey:"districtId",options:P,success:U,loading:G},{id:3,model:"stateId",label:"stateObjectLabel",placeholder:"stateObjectLabel",errorKey:"stateId",options:A,success:J,loading:z}]),{isError:Z}=([s,r]=y(()=>v({queryKey:["objectById",_],queryFn:()=>pe("building_object",_.value),select:a=>{t.value.id=a.id,t.value.name=a.fullName,t.value.address=a.address,t.value.regionId=[a.regionId],t.value.districtId=[a.districtId],t.value.stateId=[a.stateId],f.value=!0}})),s=await s,r(),s);C(Z,a=>{a&&B.push(L.HOME.path)});const{mutate:ee}=ge({onMutate:a=>{w.value=!0,a.regionId=a.regionId[0],a.districtId=a.districtId[0],a.stateId=a.stateId[0]},mutationFn:a=>he("building_object",a),onSuccess:()=>{b.invalidateQueries({queryKey:["objects"]}),b.invalidateQueries({queryKey:["objectById",_]}),b.invalidateQueries({queryKey:["objectsList"]}),B.push(L.OBJECTS.path)}}),ae=async()=>{o.value.$validate(),!o.value.$errors.length&&(ee(t.value),o.value.$reset())};return(a,je)=>{var F,V;const se=I("ManageHead"),te=I("FormInput"),re=I("FormSelect"),oe=I("CustomButton");return p(),$("section",be,[E("div",_e,[M(se,{title:"editObjectTitle",to:i(L).OBJECTS.path},null,8,["to"]),E("form",{class:"manage__form form-manage",onSubmit:ne(ae,["prevent"])},[(p(!0),$(k,null,N(X.value,e=>{var l,u,c,m,g;return p(),R(te,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":j=>t.value[e.model]=j,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(u=(l=i(o))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(g=(m=(c=i(o))==null?void 0:c[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:g.$message},{default:K(()=>[O(q(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),$(k,null,N(Y.value,e=>{var l,u,c,m,g;return p(),R(re,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":j=>t.value[e.model]=j,width:500,options:e.options,error:(u=(l=i(o))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$error,placeholder:e==null?void 0:e.placeholder,textError:(g=(m=(c=i(o))==null?void 0:c[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:g.$message,success:e.success,loading:e.loading},{default:K(()=>[O(q(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),M(oe,{className:`form__submit ${(V=(F=i(o))==null?void 0:F.stateId.$errors[0])!=null&&V.$message?"centered":""}`},{default:K(()=>[O(q(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Be as default};
//# sourceMappingURL=update-Q06z8QhE.js.map
