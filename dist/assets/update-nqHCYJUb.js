import{u as ae,a as le,r as m,y as b,c as te,x as de,b as F,d as $,f as q,B as h,w as ie,F as j,e as w,k as g,g as ne,C as ce,h as y,o as I,i as f,t as _,z as V,A as C}from"./index-8-F5s4j3.js";import{u as ue,r as l}from"./i18n-validators-72j1n4q8.js";import{a as me,u as be}from"./generic.services-CQjHStj7.js";import{u as p}from"./useQuery-KERFi8ks.js";import{a as ge,u as Ie}from"./crud.services-Xs683v05.js";import{m as pe,a as he,e as ye,b as fe}from"./manual.services-4pjALTqx.js";const _e={class:"manage section-height shadowed"},ve={class:"manage__inner section-padding"},qe={__name:"update",async setup(ke){let s,a;const O=me(),L=ne(),N=ce();ae(),le();const v=m(N.params.id),B=m(localStorage.getItem("organizationId")),{data:P,isSuccess:E,isLoading:R}=([s,a]=b(()=>p({queryKey:["regions"],queryFn:()=>pe()})),s=await s,a(),s),{data:x,isSuccess:M,isLoading:T}=([s,a]=b(()=>p({queryKey:["districts"],queryFn:()=>he()})),s=await s,a(),s),{data:A,isSuccess:D,isLoading:G}=([s,a]=b(()=>p({queryKey:["objectsList",{organizationId:B}],queryFn:()=>ye(B.value)})),s=await s,a(),s),{data:Q,isSuccess:U,isLoading:z}=([s,a]=b(()=>p({queryKey:["states"],queryFn:()=>fe()})),s=await s,a(),s),r=m({id:"",fullname:"",numberOfFloors:"",roomsOnFloor:"",address:"",buildingObjectId:[],regionId:[],districtId:[],stateId:[]}),H=te(()=>({id:{required:l},fullname:{required:l},numberOfFloors:{required:l},roomsOnFloor:{required:l},address:{required:l},buildingObjectId:{required:l},regionId:{required:l},districtId:{required:l},stateId:{required:l}})),t=ue(H,r),W=m([{id:1,model:"fullname",label:"blocksFullNameLabel",placeholder:"blocksFullNamePlaceholder",icon:"input-company",errorKey:"fullname"},{id:2,model:"numberOfFloors",label:"blocksNumberLabel",placeholder:"blocksNumberPlaceholder",icon:"signature",errorKey:"numberOfFloors"},{id:3,model:"roomsOnFloor",label:"blocksRoomsLabel",placeholder:"blocksRoomsPlaceholder",icon:"door",errorKey:"roomsOnFloor"},{id:4,model:"address",label:"blocksAddressLabel",placeholder:"blocksAddressPlaceholder",icon:"address",errorKey:"address"}]),J=m([{id:1,model:"buildingObjectId",label:"buildIdBlocksLabel",placeholder:"buildIdBlocksPlaceholder",errorKey:"buildingObjectId",options:A,success:D,loading:G},{id:2,model:"regionId",label:"regionBlocksLabel",placeholder:"regionBlocksPlaceholder",errorKey:"regionId",options:P,success:E,loading:R},{id:3,model:"districtId",label:"districtBlocksLabel",placeholder:"districtBlocksPlaceholder",errorKey:"districtId",options:x,success:M,loading:T},{id:4,model:"stateId",label:"stateBlocksLabel",placeholder:"stateBlocksPlaceholder",errorKey:"stateId",options:Q,success:U,loading:z}]),{isError:X}=([s,a]=b(()=>p({queryKey:["blocksById",v],queryFn:()=>ge("building_block",v.value),select:o=>{r.value.id=o.id,r.value.fullname=o.fullName,r.value.numberOfFloors=o.numberOfFloors,r.value.roomsOnFloor=o.roomsOnFloor,r.value.address=o.address,r.value.buildingObjectId=[o.buildingObjectId],r.value.regionId=[o.regionId],r.value.districtId=[o.districtId],r.value.stateId=[o.stateId]}})),s=await s,a(),s);de(X,o=>{o&&L.push(C.HOME.path)});const{mutate:Y}=be({onMutate:o=>{o.buildingObjectId=o.buildingObjectId[0],o.regionId=o.regionId[0],o.districtId=o.districtId[0],o.stateId=o.stateId[0]},mutationFn:o=>Ie("building_block",o),onSuccess:()=>{O.invalidateQueries({queryKey:["blocks"]}),O.invalidateQueries({queryKey:["blocksById",v]}),L.push(C.BLOCKS.path)}}),Z=async()=>{t.value.$validate(),!t.value.$errors.length&&(Y(r.value),t.value.$reset())};return(o,Fe)=>{var K,S;const ee=y("Title"),oe=y("FormInput"),se=y("FormSelect"),re=y("CustomButton");return I(),F("section",_e,[$("div",ve,[q(ee,null,{default:h(()=>[f(`\r
                `+_(o.$t("editCompanyTitle"))+`\r
            `,1)]),_:1}),$("form",{class:"manage__form form-manage",onSubmit:ie(Z,["prevent"])},[(I(!0),F(j,null,w(W.value,e=>{var d,i,n,c,u;return I(),V(oe,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":k=>r.value[e.model]=k,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(i=(d=g(t))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:i.$error,textError:(u=(c=(n=g(t))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:c.$errors[0])==null?void 0:u.$message},{default:h(()=>[f(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(I(!0),F(j,null,w(J.value,e=>{var d,i,n,c,u;return I(),V(se,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":k=>r.value[e.model]=k,width:500,options:e.options,error:(i=(d=g(t))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:i.$error,placeholder:e==null?void 0:e.placeholder,textError:(u=(c=(n=g(t))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:c.$errors[0])==null?void 0:u.$message,success:e.success,loading:e.loading},{default:h(()=>[f(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),q(re,{className:`form__submit ${(S=(K=g(t))==null?void 0:K.stateId.$errors[0])!=null&&S.$message?"centered":""}`},{default:h(()=>[f(_(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{qe as default};
//# sourceMappingURL=update-nqHCYJUb.js.map
