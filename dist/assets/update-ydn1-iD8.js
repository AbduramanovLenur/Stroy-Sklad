import{u as oe,a as se,n as te,r as p,y,c as ne,x as ie,b as N,d as O,f as w,B as h,w as de,F as q,e as V,k as m,g as le,C as ue,h as b,o as g,i as f,t as _,z as B,A as F}from"./index-TqTqIbHh.js";import{u as ce,r as s}from"./i18n-validators-zAZPYeBJ.js";import{a as me,u as ge}from"./generic.services-wmG985Iz.js";import{u as I}from"./useQuery-ZuTrOc-G.js";import{a as pe,u as ye}from"./crud.services-ChiVIUDS.js";import{m as he,a as be,b as fe}from"./manual.services-2IlJk8n9.js";const _e={class:"manage section-height shadowed"},Ie={class:"manage__inner section-padding"},we={__name:"update",async setup(ve){let r,t;const $=me(),S=le(),C=ue();oe(),se();const P=te(),{setPagePagination:E,setLimitPagination:k}=P,v=p(C.params.id),{data:T,isSuccess:x,isLoading:M}=([r,t]=y(()=>I({queryKey:["regions"],queryFn:()=>he()})),r=await r,t(),r),{data:R,isSuccess:D,isLoading:Q}=([r,t]=y(()=>I({queryKey:["districts"],queryFn:()=>be()})),r=await r,t(),r),{data:U,isSuccess:A,isLoading:G}=([r,t]=y(()=>I({queryKey:["states"],queryFn:()=>fe()})),r=await r,t(),r),o=p({id:"",fullName:"",inn:"",address:"",phoneNumber:"",director:"",regionId:"",districtId:"",stateId:""}),H=ne(()=>({id:{required:s},fullName:{required:s},inn:{required:s},address:{required:s},phoneNumber:{required:s},director:{required:s},regionId:{required:s},districtId:{required:s},stateId:{required:s}})),n=ce(H,o),W=p([{id:1,model:"fullName",label:"nameOrganizationLabel",placeholder:"nameOrganizationPlaceholder",icon:"input-company",errorKey:"fullName"},{id:2,model:"inn",label:"innOrganizationLabel",placeholder:"innOrganizationPlaceholder",icon:"tin",errorKey:"inn"},{id:3,model:"address",label:"addressOrganizationLabel",placeholder:"addressOrganizationPlaceholder",icon:"address",errorKey:"address"},{id:4,model:"phoneNumber",label:"phoneOrganizationLabel",placeholder:"phoneOrganizationPlaceholder",icon:"phone",errorKey:"phoneNumber"},{id:5,model:"director",label:"directorOrganizationLabel",placeholder:"directorOrganizationPlaceholder",icon:"person",errorKey:"director"}]),j=p([{id:1,model:"regionId",label:"regionOrganizationLabel",options:T,success:x,loading:M,errorKey:"regionId"},{id:2,model:"districtId",label:"districtOrganizationLabel",options:R,success:D,loading:Q,errorKey:"districtId"},{id:3,model:"stateId",label:"stateOrganizationLabel",options:U,success:A,loading:G,errorKey:"stateId"}]),{isError:J}=([r,t]=y(()=>I({queryKey:["companiesById",v],queryFn:()=>pe("organization",v.value),select:a=>{o.value.id=a.id,o.value.fullName=a.fullName,o.value.inn=a.inn,o.value.address=a.address,o.value.phoneNumber=a.phoneNumber,o.value.director=a.director,o.value.regionId=a.regionId,o.value.districtId=a.districtId,o.value.stateId=a.stateId}})),r=await r,t(),r);ie(J,a=>{a&&S.push(F.HOME.path)});const{mutate:X}=ge({mutationFn:a=>ye("organization",a),onSuccess:async()=>{await $.invalidateQueries({queryKey:["companies"]}),await $.invalidateQueries({queryKey:["companiesById",v]}),E(1),k(10),S.push(F.COMPANIES.path)}}),Y=async()=>{n.value.$validate(),!n.value.$errors.length&&(X(o.value),n.value.$reset())};return(a,Ke)=>{var z,L;const Z=b("Title"),ee=b("FormInput"),ae=b("FormSelect"),re=b("CustomButton");return g(),N("section",_e,[O("div",Ie,[w(Z,null,{default:h(()=>[f(`\r
                `+_(a.$t("editCompanyTitle"))+`\r
            `,1)]),_:1}),O("form",{class:"manage__form form-manage",onSubmit:de(Y,["prevent"])},[(g(!0),N(q,null,V(W.value,e=>{var i,d,l,u,c;return g(),B(ee,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":K=>o.value[e.model]=K,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(d=(i=m(n))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(n))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message},{default:h(()=>[f(_(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(g(!0),N(q,null,V(j.value,e=>{var i,d,l,u,c;return g(),B(ae,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":K=>o.value[e.model]=K,width:500,options:e.options,error:(d=(i=m(n))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(n))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:h(()=>[f(_(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),w(re,{className:`form__submit ${(L=(z=m(n))==null?void 0:z.stateId.$errors[0])!=null&&L.$message?"centered":""}`},{default:h(()=>[f(_(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{we as default};
//# sourceMappingURL=update-ydn1-iD8.js.map
