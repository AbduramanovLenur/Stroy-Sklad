import{x as Q,y as x,r as w,z as H,d as f,e as K,k as v,h as e,A as C,i as m,t as L,m as s,o as r,s as T}from"./index-dfDRnHVv.js";import{a as M,u as O}from"./generic.services-RbGpw9-f.js";import{u as R}from"./useQuery-dYILSx3_.js";import{g as V,d as F}from"./crud.services-ogW4KK8c.js";import{r as U}from"./index-00EIgC-x.js";const W={class:"company section-height"},$={class:"company__inner section-padding"},j={key:2,class:"empty-table shadowed"},te={__name:"index",async setup(G){let o,p;const _=M(),A=Q(),{page:c,limit:l,search:N}=x(A),g=w(""),y=U(N,500),P=w([{id:1,label:"organizationName",width:220},{id:2,label:"organizationInn",width:115},{id:3,label:"organizationRegion",width:200},{id:4,label:"organizationDistrict",width:155},{id:5,label:"organizationAddress",width:200},{id:6,label:"organizationPhone",width:170},{id:7,label:"organizationDirector",width:230}]),{data:n,isLoading:k,isSuccess:u,isError:D}=([o,p]=H(()=>R({queryKey:["companies",{page:c,limit:l,debouncedSearch:y}],queryFn:()=>V("organization",c.value,l.value,y.value),select:t=>{let d={...t};return d.organizations=t==null?void 0:t.organizations.map(a=>{const i={...a,company:a.organizationName};return delete i.organizationName,i}),d}})),o=await o,p(),o),{mutate:E}=O({mutationFn:t=>F("organization",t),onSuccess:async t=>{await _.invalidateQueries({queryKey:["companies"]}),await _.invalidateQueries({queryKey:["companiesById",g]})}}),I=t=>{g.value=t,E(t)};return(t,d)=>{var h,b,z,S;const a=s("HeadPage"),i=s("Table"),q=s("Pagination"),B=s("Spinner");return r(),f("section",W,[K("div",$,[v(a,{title:"comapnyTitle",to:e(T).CREATE_COMPANIES.path},null,8,["to"]),e(u)&&((h=e(n))!=null&&h.count)?(r(),C(i,{key:0,headers:P.value,table:(b=e(n))==null?void 0:b.organizations,to:e(T).UPDATE_COMPANIES.name,options:{page:e(c),limit:e(l)},onOnActionDelete:I},null,8,["headers","table","to","options"])):m("",!0),v(q,{count:(z=e(n))==null?void 0:z.count,isSucces:e(u)},null,8,["count","isSucces"]),e(k)?(r(),C(B,{key:1})):m("",!0),e(u)&&!((S=e(n))!=null&&S.count)||e(D)?(r(),f("div",j,L(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{te as default};
