import{u as ee,a as ae,r as y,x as p,c as se,B as oe,b as $,d as L,f as V,A as I,w as re,F as w,e as F,k as m,g as te,C as ie,h as b,o as g,i as _,t as v,y as O,z as C}from"./index-W4j50O3a.js";import{u as ne,r as i}from"./i18n-validators-wfnkgHY1.js";import{a as de,u as le}from"./generic.services-ZP-K_-d6.js";import{u as h}from"./useQuery-5o_SWOVE.js";import{a as ue,u as ce}from"./crud.services-KnaxdDp-.js";import{m as me,a as ge,b as ye}from"./manual.services-CzpFxLUz.js";const pe={class:"manage section-height"},Ie={class:"manage__inner section-padding"},je={__name:"update",async setup(be){let s,r;const S=de(),K=te(),z=ie();ee(),ae();const j=y(z.params.id),{data:E,isSuccess:k,isLoading:N}=([s,r]=p(()=>h({queryKey:["regions"],queryFn:()=>me()})),s=await s,r(),s),{data:T,isSuccess:x,isLoading:R}=([s,r]=p(()=>h({queryKey:["districts"],queryFn:()=>ge()})),s=await s,r(),s),{data:D,isSuccess:M,isLoading:Q}=([s,r]=p(()=>h({queryKey:["states"],queryFn:()=>ye()})),s=await s,r(),s),o=y({id:"",name:"",address:"",organizationId:"",regionId:"",districtId:"",stateId:""}),U=se(()=>({id:{required:i},name:{required:i},address:{required:i},organizationId:{required:i},regionId:{required:i},districtId:{required:i},stateId:{required:i}})),t=ne(U,o),G=y([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),A=y([{id:1,model:"regionId",label:"regionObjectLabel",options:E,errorKey:"regionId",success:k,loading:N},{id:2,model:"districtId",label:"districtObjectLabel",options:T,errorKey:"districtId",success:x,loading:R},{id:3,model:"stateId",label:"stateObjectLabel",options:D,success:M,loading:Q}]),{isError:H}=([s,r]=p(()=>h({queryKey:["objectById",j],queryFn:()=>ue("building_object",j.value),select:a=>{o.value.id=a.id,o.value.name=a.fullName,o.value.organizationId=a.organizationId,o.value.regionId=a.regionId,o.value.districtId=a.districtId,o.value.address=a.address,o.value.stateId=a.stateId}})),s=await s,r(),s);oe(H,a=>{a&&K.push(C.HOME.path)});const{mutate:P}=le({mutationFn:a=>ce("building_object",a),onSuccess:()=>{S.invalidateQueries({queryKey:["objects"]}),S.invalidateQueries({queryKey:["objectById"]}),K.push(C.OBJECTS.path)}}),J=async()=>{o.value.organizationId=1,t.value.$validate(),!t.value.$errors.length&&(P(o.value),t.value.$reset())};return(a,_e)=>{var q,B;const W=b("Title"),X=b("FormInput"),Y=b("FormSelect"),Z=b("CustomButton");return g(),$("section",pe,[L("div",Ie,[V(W,null,{default:I(()=>[_(`\r
                `+v(a.$t("editObjectTitle"))+`\r
            `,1)]),_:1}),L("form",{class:"manage__form form-manage",onSubmit:re(J,["prevent"])},[(g(!0),$(w,null,F(G.value,e=>{var n,d,l,u,c;return g(),O(X,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":f=>o.value[e.model]=f,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(d=(n=m(t))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(t))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message},{default:I(()=>[_(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(g(!0),$(w,null,F(A.value,e=>{var n,d,l,u,c;return g(),O(Y,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":f=>o.value[e.model]=f,width:500,options:e.options,error:(d=(n=m(t))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(t))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:I(()=>[_(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),V(Z,{className:`form__submit ${(B=(q=m(t))==null?void 0:q.stateId.$errors[0])!=null&&B.$message?"centered":""}`},{default:I(()=>[_(v(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{je as default};
//# sourceMappingURL=update-4Lq9ompf.js.map
