import{u as re,a as se,n as le,r as y,y as g,c as te,x as ne,b as v,d as K,f as E,k as n,w as de,F,e as q,B as N,g as ie,C as ue,h,o as p,A as b,z as V,i as S,t as L}from"./index-xEhNh2bJ.js";import{u as me,r as t}from"./i18n-validators-6dxtFobU.js";import{a as ce,u as pe}from"./generic.services-cTEduup6.js";import{u as I}from"./useQuery-9UwmWmpU.js";import{a as ye,u as ge}from"./crud.services-QxvbF8R1.js";import{c as he,d as Ie,b as _e}from"./manual.services-qdVUyuV6.js";const fe={class:"manage section-height shadowed"},ve={class:"manage__inner section-padding"},Ke={__name:"update",async setup(Ne){let a,s;const w=ce(),P=ie(),B=ue();re(),se();const M=le(),{setPagePagination:C,setLimitPagination:O}=M,_=y(B.params.id),{data:R,isSuccess:k,isLoading:x}=([a,s]=g(()=>I({queryKey:["organizations"],queryFn:()=>he()})),a=await a,s(),a),{data:H,isSuccess:Q,isLoading:T}=([a,s]=g(()=>I({queryKey:["roles"],queryFn:()=>Ie()})),a=await a,s(),a),{data:U,isSuccess:G,isLoading:A}=([a,s]=g(()=>I({queryKey:["states"],queryFn:()=>_e()})),a=await a,s(),a),r=y({id:"",fullName:"",userName:"",password:"",phoneNumber:"",organizationId:[],roleId:[],stateId:[]}),Y=te(()=>({id:{required:t},fullName:{required:t},userName:{required:t},phoneNumber:{required:t},organizationId:{required:t},roleId:{required:t},stateId:{required:t}})),l=me(Y,r),D=y([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),W=y([{id:1,model:"organizationId",label:"employeesOrganizationLabel",placeholder:"employeesOrganizationPlaceholder",errorKey:"organizationId",options:R,success:k,loading:x},{id:2,model:"roleId",label:"employeesRoleLabel",placeholder:"employeesRolePlaceholder",errorKey:"roleId",options:H,success:Q,loading:T},{id:3,model:"stateId",label:"employeesStatePlaceholder",placeholder:"employeesStatePlaceholder",options:U,success:G,loading:A}]),{isError:j}=([a,s]=g(()=>I({queryKey:["employeesById",_],queryFn:()=>ye("user",_.value),select:o=>{r.value.id=o.id,r.value.fullName=o.fullName,r.value.userName=o.userName,r.value.phoneNumber=o.phoneNumber,r.value.organizationId=[o.organizationId],r.value.roleId=[o.roleId],r.value.stateId=[o.stateId]}})),a=await a,s(),a);ne(j,o=>{o&&P.push(b.HOME.path)});const{mutate:J}=pe({onMutate:o=>{o.organizationId=o.organizationId[0],o.roleId=o.roleId[0],o.stateId=o.stateId[0]},mutationFn:o=>ge("user",o),onSuccess:()=>{w.invalidateQueries({queryKey:["employees"]}),w.invalidateQueries({queryKey:["employeesById",_]}),C(1),O(10),P.push(b.EMPLOYEES.path)}}),X=async()=>{l.value.$validate(),!l.value.$errors.length&&(J(r.value),l.value.$reset())};return(o,be)=>{var $,z;const Z=h("ManageHead"),ee=h("FormInput"),oe=h("FormSelect"),ae=h("CustomButton");return p(),v("section",fe,[K("div",ve,[E(Z,{title:"editEmployeesTitle",to:n(b).EMPLOYEES.path},null,8,["to"]),K("form",{class:"manage__form form-manage",onSubmit:de(X,["prevent"])},[(p(!0),v(F,null,q(D.value,e=>{var d,i,u,m,c;return p(),V(ee,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":f=>r.value[e.model]=f,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(i=(d=n(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:i.$error,textError:(c=(m=(u=n(l))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:c.$message},{default:N(()=>[S(L(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),v(F,null,q(W.value,e=>{var d,i,u,m,c;return p(),V(oe,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":f=>r.value[e.model]=f,width:500,options:e.options,error:(i=(d=n(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:i.$error,placeholder:e==null?void 0:e.placeholder,textError:(c=(m=(u=n(l))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:N(()=>[S(L(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),E(ae,{className:`form__submit ${(z=($=n(l))==null?void 0:$.stateId.$errors[0])!=null&&z.$message?"centered":""}`},{default:N(()=>[S(L(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Ke as default};
//# sourceMappingURL=update-NeApWPiG.js.map
