import{_ as Q,n as V,s as F,q as H,r as w,x as K,b as T,d as P,f as k,k as e,y as A,l as u,t as R,h as i,o as r,z as q}from"./index-F4UHGcq2.js";import{a as Y,u as U}from"./generic.services-wQ89JmWC.js";import{u as W}from"./useQuery-ccCSBUF5.js";import{g as $,d as j}from"./crud.services-rreQBCQx.js";import{r as G}from"./index-V-M1nI8H.js";const J={class:"employees section-height"},X={class:"employees__inner section-padding"},Z={class:"shadowed"},ee={key:2,class:"empty-table"},te={__name:"index",async setup(se){let l,m;const d=Y(),p=V(),{setSearchValue:y}=p,{page:_,limit:h,search:C}=F(p);H(()=>{y("")});const b=w(""),S=G(C,500),x=w([{id:1,label:"employeesFullName",width:300},{id:2,label:"employeesOrganization",width:320},{id:3,label:"employeesPhone",width:255},{id:4,label:"employeesRole",width:195},{id:5,label:"employeesState",width:250},{id:8,label:"employeesAction",width:190}]),{data:n,isLoading:B,isSuccess:c,isError:L}=([l,m]=K(()=>W({queryKey:["employees",{page:_,limit:h,debouncedSearch:S,isAdmin:!0}],queryFn:()=>$("user",_.value,h.value,S.value,{isAdmin:!0}),select:t=>{let a={...t};return a.users=t==null?void 0:t.users.map(s=>{const o={...s,phone:s.phoneNumber,company:s.organizationName,name:s.fullName};return delete o.fullName,delete o.phoneNumber,delete o.organizationName,o}),a}})),l=await l,m(),l),{mutate:M}=U({mutationFn:t=>j("user",t),onSuccess:()=>{d.invalidateQueries({queryKey:["employees"]}),d.invalidateQueries({queryKey:["employeesById",b]})}}),O=t=>{b.value=t,M(t)};return(t,a)=>{var f,g,E,v,N;const s=i("HeadPage"),o=i("Table"),z=i("Pagination"),D=i("Spinner");return r(),T("section",J,[P("div",X,[k(s,{title:"employeesTitle",to:e(q).CREATE_EMPLOYEES.path,onOnSearch:a[0]||(a[0]=I=>e(y)(I))},null,8,["to"]),P("div",Z,[e(c)&&((f=e(n))!=null&&f.count)?(r(),A(o,{key:0,headers:x.value,table:(g=e(n))==null?void 0:g.users,to:e(q).UPDATE_EMPLOYEES.name,onOnActionDelete:O},null,8,["headers","table","to"])):u("",!0),k(z,{count:(E=e(n))==null?void 0:E.count,isSucces:e(c),isEmpty:!!((v=e(n))!=null&&v.count)},null,8,["count","isSucces","isEmpty"]),e(B)?(r(),A(D,{key:1})):u("",!0),e(c)&&!((N=e(n))!=null&&N.count)||e(L)?(r(),T("div",ee,R(t.$t("emptyTableTitle")),1)):u("",!0)])])])}}},re=Q(te,[["__scopeId","data-v-2ba160ed"]]);export{re as default};
//# sourceMappingURL=index-ZUGv33ZD.js.map
