import{u as ae,a as te,r as c,z as h,c as re,y as se,d as v,e as B,k as F,h as u,w as oe,F as L,C as W,D as f,l as ue,E as ne,m as I,o as y,B as w,A as M,f as S,t as T}from"./index-qZ69CyC7.js";import{u as le,r as p}from"./i18n-validators-dGSGbQKY.js";import{a as ie,u as de}from"./generic.services-34GP1Yc8.js";import{u as g}from"./useQuery-IZNqF3Xo.js";import{a as me,u as ce}from"./crud.services-qYEmjzHd.js";import{g as ye,h as pe,b as he}from"./manual.services-BxKPmsPu.js";const Ie={class:"manage section-height shadowed"},ge={class:"manage__inner section-padding"},Ke={__name:"update",async setup(qe){let t,s;const $=ie(),K=ue(),b=ne();ae(),te();const q=c(b.params.id),C=c(localStorage.getItem("organizationId")),{data:Q,isSuccess:k,isLoading:H}=([t,s]=h(()=>g({queryKey:["types"],queryFn:()=>ye()})),t=await t,s(),t),{data:U,isSuccess:x,isLoading:N}=([t,s]=h(()=>g({queryKey:["materials",{organizationId:C}],queryFn:()=>pe()})),t=await t,s(),t),{data:P,isSuccess:A,isLoading:R}=([t,s]=h(()=>g({queryKey:["states"],queryFn:()=>he()})),t=await t,s(),t),r=c({id:"",materialId:[],quantity:"",quantityTypeId:[],stateId:[]}),z=re(()=>({id:{required:p},materialId:{required:p},quantity:{required:p},quantityTypeId:{required:p},stateId:{required:p}})),o=le(z,r),O=c([{id:1,model:"quantity",label:"quantityWarehouseLabel",placeholder:"quantityWarehousePlaceholder",icon:"list",errorKey:"quantity"}]),D=c([{id:1,model:"materialId",label:"materialsWarehouseLabel",placeholder:"materialsWarehousePlaceholder",errorKey:"materialId",options:U,success:x,loading:N},{id:2,model:"quantityTypeId",label:"qunatityTypesWarehouseLabel",placeholder:"qunatityTypesWarehousePlaceholder",errorKey:"quantityTypeId",options:Q,success:k,loading:H},{id:3,model:"stateId",label:"stateWarehouseLabel",placeholder:"stateWarehousePlaceholder",errorKey:"stateId",options:P,success:A,loading:R}]),{isError:G}=([t,s]=h(()=>g({queryKey:["warehouseById",q],queryFn:()=>me("warehouse",q.value),select:a=>{r.value.id=a.id,r.value.materialId=[a.materialId],r.value.quantity=a.quantity,r.value.quantityTypeId=[a.quantityTypeId],r.value.stateId=[a.stateId]}})),t=await t,s(),t);se(G,a=>{a&&K.push(w.HOME.path)});const{mutate:j}=de({onMutate:a=>{a.materialId=a.materialId[0],a.quantityTypeId=a.quantityTypeId[0],a.stateId=a.stateId[0]},mutationFn:a=>ce("warehouse",a),onSuccess:()=>{$.invalidateQueries({queryKey:["warehouse"]}),$.invalidateQueries({queryKey:["warehouseById",q]}),K.push(w.WAREHOUSE.path)}}),J=async()=>{o.value.$validate(),!o.value.$errors.length&&(j(r.value),o.value.$reset())};return(a,_e)=>{var E,V;const X=I("ManageHead"),Y=I("FormInput"),Z=I("FormSelect"),ee=I("CustomButton");return y(),v("section",Ie,[B("div",ge,[F(X,{title:"editProductTitle",to:u(w).WAREHOUSE.path},null,8,["to"]),B("form",{class:"manage__form form-manage",onSubmit:oe(J,["prevent"])},[(y(!0),v(L,null,W(O.value,e=>{var n,l,i,d,m;return y(),M(Y,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":_=>r.value[e.model]=_,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(l=(n=u(o))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:l.$error,textError:(m=(d=(i=u(o))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:m.$message},{default:f(()=>[S(T(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(y(!0),v(L,null,W(D.value,e=>{var n,l,i,d,m;return y(),M(Z,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":_=>r.value[e.model]=_,width:500,options:e.options,error:(l=(n=u(o))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:l.$error,placeholder:e==null?void 0:e.placeholder,textError:(m=(d=(i=u(o))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:m.$message,success:e.success,loading:e.loading},{default:f(()=>[S(T(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),F(ee,{className:`form__submit ${(V=(E=u(o))==null?void 0:E.stateId.$errors[0])!=null&&V.$message?"centered":""}`},{default:f(()=>[S(T(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Ke as default};
//# sourceMappingURL=update-TsADQzcE.js.map
