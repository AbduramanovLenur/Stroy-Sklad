import{u as G,a as J,r as y,y as w,c as X,b as q,d as S,f as V,k as s,w as Y,F as K,e as b,B as f,g as Z,h as p,o as m,A as E,z as F,i as I,t as v}from"./index-x0me4eeV.js";import{u as ee,r as h}from"./i18n-validators-N3krClQx.js";import{a as ae,u as oe}from"./generic.services-3OPQu4nG.js";import{u as M}from"./useQuery-xv1pFEHU.js";import{c as re}from"./crud.services-2_QkeFR9.js";import{f as te,g as se}from"./manual.services-gWBYdErO.js";const ne={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},ge={__name:"create",async setup(le){let r,c;const B=ae(),C=Z();G(),J();const g=y(localStorage.getItem("organizationId")),{data:L,isSuccess:W,isLoading:k}=([r,c]=w(()=>M({queryKey:["types"],queryFn:()=>te()})),r=await r,c(),r),{data:z,isSuccess:N,isLoading:Q}=([r,c]=w(()=>M({queryKey:["materials",{organizationId:g}],queryFn:()=>se(g.value)})),r=await r,c(),r),t=y({materialId:[],quantity:"",quantityTypeId:[],organizationId:""}),U=X(()=>({materialId:{required:h},quantity:{required:h},quantityTypeId:{required:h},organizationId:{required:h}})),o=ee(U,t),x=y([{id:1,model:"quantity",label:"quantityWarehouseLabel",placeholder:"quantityWarehousePlaceholder",icon:"list",errorKey:"quantity"}]),H=y([{id:1,model:"materialId",label:"materialsWarehouseLabel",placeholder:"materialsWarehousePlaceholder",errorKey:"materialId",options:z,success:N,loading:Q},{id:2,model:"quantityTypeId",label:"qunatityTypesWarehouseLabel",placeholder:"qunatityTypesWarehousePlaceholder",errorKey:"quantityTypeId",options:L,success:W,loading:k}]),{mutate:A}=oe({onMutate:a=>{a.materialId=a.materialId[0],a.quantityTypeId=a.quantityTypeId[0]},mutationFn:a=>re("warehouse",a),onSuccess:()=>{B.invalidateQueries({queryKey:["warehouse"]}),C.push(E.WAREHOUSE.path)}}),P=()=>{t.value.organizationId=g.value,o.value.$validate(),console.log(o.value.$errors),!o.value.$errors.length&&(A(t.value),o.value.$reset())};return(a,ie)=>{var $,T;const R=p("ManageHead"),O=p("FormInput"),D=p("FormSelect"),j=p("CustomButton");return m(),q("section",ne,[S("div",ue,[V(R,{title:"addNewProductTitle",to:s(E).WAREHOUSE.path},null,8,["to"]),S("form",{class:"manage__form form-manage",onSubmit:Y(P,["prevent"])},[(m(!0),q(K,null,b(x.value,e=>{var n,u,l,i,d;return m(),F(O,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":_=>t.value[e.model]=_,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(u=(n=s(o))==null?void 0:n[e.errorKey])==null?void 0:u.$error,textError:(d=(i=(l=s(o))==null?void 0:l[e.errorKey])==null?void 0:i.$errors[0])==null?void 0:d.$message},{default:f(()=>[I(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(m(!0),q(K,null,b(H.value,e=>{var n,u,l,i,d;return m(),F(D,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":_=>t.value[e.model]=_,width:500,options:e.options,error:(u=(n=s(o))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:u.$error,placeholder:e==null?void 0:e.placeholder,textError:(d=(i=(l=s(o))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:i.$errors[0])==null?void 0:d.$message,success:e.success,loading:e.loading},{default:f(()=>[I(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),V(j,{className:`form__submit ${(T=($=s(o))==null?void 0:$.quantityTypeId.$errors[0])!=null&&T.$message?"centered":""}`},{default:f(()=>[I(v(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{ge as default};
//# sourceMappingURL=create-2YDUosBi.js.map
