import{u as G,a as J,b as W,s as X,c as b,r as h,x as Y,d as f,e as w,k as I,h as r,w as Z,F as P,B as K,C as g,i as ee,l as ae,m as c,o as i,z as B,y as E,f as T,t as v,E as oe}from"./index--8tqH1cI.js";import{u as te,r as F}from"./i18n-validators-ifF63VWe.js";import{a as re,u as se}from"./generic.services-lNDsx7jF.js";import{u as ne}from"./useQuery-_ggqNrTF.js";import{c as ue}from"./crud.services-U-Ys9NO0.js";import{g as le}from"./manual.services-Zmd6WN_N.js";const de={key:0,class:"manage section-height shadowed"},ie={class:"manage__inner section-padding"},ge={__name:"create",async setup(me){let m,$;const q=re(),U=ae();G(),J();const k=W(),{user:p}=X(k),C=b(()=>{var a,y;return!!((y=(a=p==null?void 0:p.value.user)==null?void 0:a.modules)!=null&&y.includes(oe.PRODUCT.CREATE))}),t=h({fullname:"",quantityTypeId:[]}),M=b(()=>({fullname:{required:F},quantityTypeId:{required:F}})),o=te(M,t),{data:N,isSuccess:Q,isLoading:x}=([m,$]=Y(()=>ne({queryKey:["types"],queryFn:()=>le(),enabled:C})),m=await m,$(),m),L=h([{id:1,model:"fullname",label:"nameProductsLabel",placeholder:"nameProductsPlaceholder",icon:"pen",errorKey:"fullname"}]),R=h([{id:1,model:"quantityTypeId",label:"qunatityTypesProductsLabel",placeholder:"qunatityTypesProductsPlaceholder",errorKey:"quantityTypeId",options:N,success:Q,loading:x}]),{mutate:D}=se({onMutate:a=>{a.quantityTypeId=a.quantityTypeId[0]},mutationFn:a=>ue("construction_material",a),onSuccess:()=>{q.invalidateQueries({queryKey:["products"]}),q.invalidateQueries({queryKey:["materialsList"]}),U.push(B.PRODUCTS.path)}}),H=()=>{o.value.$validate(),!o.value.$errors.length&&(D(t.value),o.value.$reset())};return(a,y)=>{var V,S;const O=c("ManageHead"),A=c("FormInput"),z=c("FormSelect"),j=c("CustomButton");return C.value?(i(),f("section",de,[w("div",ie,[I(O,{title:"addNewProductTitle",to:r(B).PRODUCTS.path},null,8,["to"]),w("form",{class:"manage__form form-manage",onSubmit:Z(H,["prevent"])},[(i(!0),f(P,null,K(L.value,e=>{var s,n,u,l,d;return i(),E(A,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":_=>t.value[e.model]=_,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(n=(s=r(o))==null?void 0:s[e.errorKey])==null?void 0:n.$error,textError:(d=(l=(u=r(o))==null?void 0:u[e.errorKey])==null?void 0:l.$errors[0])==null?void 0:d.$message},{default:g(()=>[T(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(i(!0),f(P,null,K(R.value,e=>{var s,n,u,l,d;return i(),E(z,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":_=>t.value[e.model]=_,width:500,options:e.options,error:(n=(s=r(o))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(d=(l=(u=r(o))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:d.$message,success:e.success,loading:e.loading},{default:g(()=>[T(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),I(j,{className:`form__submit ${(S=(V=r(o))==null?void 0:V.quantityTypeId.$errors[0])!=null&&S.$message?"centered":""}`},{default:g(()=>[T(v(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])):ee("",!0)}}};export{ge as default};
//# sourceMappingURL=create-4qBA8oqE.js.map
