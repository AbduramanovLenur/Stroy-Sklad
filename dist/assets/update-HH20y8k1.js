import{u as re,a as se,n as le,r as y,y as h,c as te,x as ne,b as S,d as P,f as K,B as g,w as de,F,e as q,k as c,g as ie,C as ue,h as I,o as p,i as f,t as _,z as V,A as B}from"./index-8-F5s4j3.js";import{u as me,r as t}from"./i18n-validators-72j1n4q8.js";import{a as ce,u as pe}from"./generic.services-CQjHStj7.js";import{u as v}from"./useQuery-KERFi8ks.js";import{a as ye,u as he}from"./crud.services-Xs683v05.js";import{c as ge,d as Ie,b as fe}from"./manual.services-4pjALTqx.js";const _e={class:"manage section-height shadowed"},ve={class:"manage__inner section-padding"},Ke={__name:"update",async setup(Ne){let a,s;const $=ce(),w=ie(),E=ue();re(),se();const C=le(),{setPagePagination:O,setLimitPagination:R}=C,N=y(E.params.id),{data:k,isSuccess:M,isLoading:T}=([a,s]=h(()=>v({queryKey:["organizations"],queryFn:()=>ge()})),a=await a,s(),a),{data:x,isSuccess:Q,isLoading:U}=([a,s]=h(()=>v({queryKey:["roles"],queryFn:()=>Ie()})),a=await a,s(),a),{data:G,isSuccess:A,isLoading:H}=([a,s]=h(()=>v({queryKey:["states"],queryFn:()=>fe()})),a=await a,s(),a),r=y({id:"",fullName:"",userName:"",password:"",phoneNumber:"",organizationId:[],roleId:[],stateId:[]}),D=te(()=>({id:{required:t},fullName:{required:t},userName:{required:t},phoneNumber:{required:t},organizationId:{required:t},roleId:{required:t},stateId:{required:t}})),l=me(D,r),W=y([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),Y=y([{id:1,model:"organizationId",label:"employeesOrganizationLabel",placeholder:"employeesOrganizationPlaceholder",errorKey:"organizationId",options:k,success:M,loading:T},{id:2,model:"roleId",label:"employeesRoleLabel",placeholder:"employeesRolePlaceholder",errorKey:"roleId",options:x,success:Q,loading:U},{id:3,model:"stateId",label:"employeesStatePlaceholder",placeholder:"employeesStatePlaceholder",options:G,success:A,loading:H}]),{isError:j}=([a,s]=h(()=>v({queryKey:["employeesById",N],queryFn:()=>ye("user",N.value),select:o=>{r.value.id=o.id,r.value.fullName=o.fullName,r.value.userName=o.userName,r.value.phoneNumber=o.phoneNumber,r.value.organizationId=[o.organizationId],r.value.roleId=[o.roleId],r.value.stateId=[o.stateId]}})),a=await a,s(),a);ne(j,o=>{o&&w.push(B.HOME.path)});const{mutate:J}=pe({onMutate:o=>{o.organizationId=o.organizationId[0],o.roleId=o.roleId[0],o.stateId=o.stateId[0]},mutationFn:o=>he("user",o),onSuccess:()=>{$.invalidateQueries({queryKey:["employees"]}),$.invalidateQueries({queryKey:["employeesById",N]}),O(1),R(10),w.push(B.EMPLOYEES.path)}}),X=async()=>{l.value.$validate(),!l.value.$errors.length&&(J(r.value),l.value.$reset())};return(o,be)=>{var L,z;const Z=I("Title"),ee=I("FormInput"),oe=I("FormSelect"),ae=I("CustomButton");return p(),S("section",_e,[P("div",ve,[K(Z,null,{default:g(()=>[f(`\r
                `+_(o.$t("editEmployeesTitle"))+`\r
            `,1)]),_:1}),P("form",{class:"manage__form form-manage",onSubmit:de(X,["prevent"])},[(p(!0),S(F,null,q(W.value,e=>{var n,d,i,u,m;return p(),V(ee,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":b=>r.value[e.model]=b,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(d=(n=c(l))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(m=(u=(i=c(l))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:m.$message},{default:g(()=>[f(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),S(F,null,q(Y.value,e=>{var n,d,i,u,m;return p(),V(oe,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":b=>r.value[e.model]=b,width:500,options:e.options,error:(d=(n=c(l))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$error,placeholder:e==null?void 0:e.placeholder,textError:(m=(u=(i=c(l))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:m.$message,success:e.success,loading:e.loading},{default:g(()=>[f(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),K(ae,{className:`form__submit ${(z=(L=c(l))==null?void 0:L.stateId.$errors[0])!=null&&z.$message?"centered":""}`},{default:g(()=>[f(_(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Ke as default};
//# sourceMappingURL=update-HH20y8k1.js.map
