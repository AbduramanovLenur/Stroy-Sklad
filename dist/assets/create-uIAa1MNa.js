import{u as I,a as L,b as Q,y as R,c as v,r as E,d as N,e as y,k as g,h as o,w as U,F as X,C as A,D as $,i as j,l as z,m as n,o as u,s as S,A as G,f as C,t as V,H as J,E as O}from"./index-Z3zFsJx2.js";import{u as W,r as Y}from"./i18n-validators-kd_2X_k0.js";import{a as Z,u as ee}from"./generic.services-kW4H25A9.js";import{c as ae}from"./crud.services-wSM5pbSJ.js";const te={key:0,class:"manage section-height shadowed"},se={class:"manage__inner section-padding"},ce={__name:"create",setup(oe){const c=Z(),b=z(),w=I(),{t:x}=L(),B=Q(),{user:r}=R(B),T=v(()=>{var e,l;return!!((l=(e=r==null?void 0:r.value.user)==null?void 0:e.modules)!=null&&l.includes(J.EXPENS.CREATE))}),t=E({fullName:""}),k=v(()=>({fullName:{required:Y}})),s=W(k,t),M=E([{id:1,model:"fullName",label:"nameExpensesLabel",placeholder:"nameExpensesPlaceholder",icon:"input-company",errorKey:"fullName"}]),{mutate:F}=ee({mutationFn:e=>ae("cost",e),onSuccess:e=>{e!=null&&e.success&&(t.value=O(t.value),c.invalidateQueries({queryKey:["expenses"]}),c.invalidateQueries({queryKey:["costsList"]}),b.push(S.EXPENS.path),setTimeout(()=>w.success(x("createToast")),150))}}),K=()=>{if(s.value.$validate(),s.value.$errors.length)return;const e={...t.value};F(e),s.value.$reset()};return(e,l)=>{var m,d;const q=n("ManageHead"),H=n("FormInput"),P=n("CustomButton");return T.value?(u(),N("section",te,[y("div",se,[g(q,{title:"addNewExpensesTitle",to:o(S).EXPENS.path},null,8,["to"]),y("form",{class:"manage__form form-manage",onSubmit:U(K,["prevent"])},[(u(!0),N(X,null,A(M.value,a=>{var i,f,p,_,h;return u(),G(H,{key:a.id,modelValue:t.value[a.model],"onUpdate:modelValue":D=>t.value[a.model]=D,width:500,placeholder:e.$t(a.placeholder),name:a.icon,error:(f=(i=o(s))==null?void 0:i[a.errorKey])==null?void 0:f.$error,textError:(h=(_=(p=o(s))==null?void 0:p[a.errorKey])==null?void 0:_.$errors[0])==null?void 0:h.$message},{default:$(()=>[C(V(e.$t(a.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),g(P,{className:`form__submit ${(d=(m=o(s))==null?void 0:m.fullName.$errors[0])!=null&&d.$message?"centered":""}`},{default:$(()=>[C(V(e.$t("formButton")),1)]),_:1},8,["className"])],32)])])):j("",!0)}}};export{ce as default};
