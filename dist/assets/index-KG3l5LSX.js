import{_ as j,q as J,s as I,r as y,b as X,c as Z,x as ee,d as M,e as se,k as O,h as e,y as q,i,t as oe,m as c,o as u,z as x,E as d}from"./index--8tqH1cI.js";import{a as te,u as ne}from"./generic.services-lNDsx7jF.js";import{u as ae}from"./useQuery-_ggqNrTF.js";import{g as re,d as le}from"./crud.services-U-Ys9NO0.js";import{r as ie}from"./index-Wjsu-XE2.js";const ce={key:0,class:"employees"},ue={class:"employees__inner section-padding"},de={key:2,class:"empty-table shadowed"},me={__name:"index",async setup(pe){let r,E;const h=te(),B=J(),{page:m,limit:p,search:Q}=I(B),Y=y(localStorage.getItem("organizationId")),z=X(),{user:o}=I(z),S=Z(()=>{var s,t;return!!((t=(s=o==null?void 0:o.value.user)==null?void 0:s.modules)!=null&&t.includes(d.EMPLOYEES.READ))}),g=y(""),b=ie(Q,500),F=y([{id:1,label:"employeesFullName",width:510},{id:3,label:"employeesPhone",width:290},{id:4,label:"employeesRole",width:210}]),{data:l,isLoading:H,isSuccess:_,isError:K}=([r,E]=ee(()=>ae({queryKey:["orgUsers",{page:m,limit:p,debouncedSearch:b,organizationId:Y}],queryFn:()=>re("user",m.value,p.value,b.value),select:s=>{let t={...s};return t.users=s==null?void 0:s.users.map(n=>{const a={...n,phone:n.phoneNumber,name:n.fullName};return delete a.fullName,delete a.phoneNumber,a}),t},enabled:S})),r=await r,E(),r),{mutate:V}=ne({mutationFn:s=>le("user",s),onSuccess:()=>{h.invalidateQueries({queryKey:["orgUsers"]}),h.invalidateQueries({queryKey:["orgUserById",g]})}}),G=s=>{g.value=s,V(s)};return(s,t)=>{var f,v,w,T,P,U,C,D,L,R,k,N,A;const n=c("HeadPage"),a=c("Table"),W=c("Pagination"),$=c("Spinner");return S.value?(u(),M("section",ce,[se("div",ue,[O(n,{title:"employeesTitle",to:e(x).CREATE_ORG_USER.path,isShowCreate:(w=(v=(f=e(o))==null?void 0:f.user)==null?void 0:v.modules)==null?void 0:w.includes(e(d).EMPLOYEES.CREATE)},null,8,["to","isShowCreate"]),e(_)&&((T=e(l))!=null&&T.count)?(u(),q(a,{key:0,headers:F.value,table:(P=e(l))==null?void 0:P.users,to:e(x).UPDATE_ORG_USER.name,options:{page:e(m),limit:e(p)},isShowUpdate:(D=(C=(U=e(o))==null?void 0:U.user)==null?void 0:C.modules)==null?void 0:D.includes(e(d).EMPLOYEES.UPDATE),isShowDelete:(k=(R=(L=e(o))==null?void 0:L.user)==null?void 0:R.modules)==null?void 0:k.includes(e(d).EMPLOYEES.DELETE),onOnActionDelete:G},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):i("",!0),O(W,{count:(N=e(l))==null?void 0:N.count,isSucces:e(_)},null,8,["count","isSucces"]),e(H)?(u(),q($,{key:1})):i("",!0),e(_)&&!((A=e(l))!=null&&A.count)||e(K)?(u(),M("div",de,oe(s.$t("emptyTableTitle")),1)):i("",!0)])])):i("",!0)}}},ge=j(me,[["__scopeId","data-v-ca2cdf94"]]);export{ge as default};
//# sourceMappingURL=index-KG3l5LSX.js.map
