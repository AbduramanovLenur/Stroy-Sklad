import{x as $,y as O,b as G,c as X,r as q,z as Y,d as L,e as Z,k as Q,h as e,A as J,i,t as ee,m as c,o as r,s as K,H as u}from"./index-zkjpq5my.js";import{a as te,u as se}from"./generic.services-wx_DtCHh.js";import{u as oe}from"./useQuery-copJlXh0.js";import{g as ae,d as ne}from"./crud.services-8TgOaY3n.js";import{r as ie}from"./index-A7S9AU-G.js";const ce={key:0,class:"object"},re={class:"object__inner section-padding"},ue={key:2,class:"empty-table shadowed"},ye={__name:"index",async setup(le){let a,p;const o=te(),P=$(),{page:l,limit:d,search:I}=O(P),U=G(),{user:s}=O(U),_=X(()=>{var t,b;return!!((b=(t=s==null?void 0:s.value.user)==null?void 0:t.modules)!=null&&b.includes(u.OBJECT.READ))}),y=q(""),h=ie(I,500),H=q([{id:1,label:"objectName",width:40},{id:2,label:"objectAddress",width:30}]),{data:n,isLoading:N,isSuccess:m,isError:R}=([a,p]=Y(()=>oe({queryKey:["objects",{page:l,limit:d,debouncedSearch:h,organizationId:s.value.user.organizationId}],queryFn:()=>ae("building_object",l.value,d.value,h.value),enabled:_})),a=await a,p(),a),{mutate:x}=se({mutationFn:t=>ne("building_object",t),onSuccess:t=>{o.invalidateQueries({queryKey:["objects"]}),o.invalidateQueries({queryKey:["objectById",y]}),o.invalidateQueries({queryKey:["objectsList"]}),o.invalidateQueries({queryKey:["blocks"]}),o.invalidateQueries({queryKey:["blocksList"]})}}),z=async t=>{y.value=t,x(t)};return(t,b)=>{var S,E,T,g,j,v,C,w,f,B,k,D,A;const V=c("HeadPage"),F=c("Table"),M=c("Pagination"),W=c("Spinner");return _.value?(r(),L("section",ce,[Z("div",re,[Q(V,{title:"objectTitle",to:e(K).CREATE_OBJECT.path,isShowCreate:(T=(E=(S=e(s))==null?void 0:S.user)==null?void 0:E.modules)==null?void 0:T.includes(e(u).OBJECT.CREATE)},null,8,["to","isShowCreate"]),e(m)&&((g=e(n))!=null&&g.count)?(r(),J(F,{key:0,headers:H.value,table:(j=e(n))==null?void 0:j.objects,to:e(K).UPDATE_OBJECT.name,options:{page:e(l),limit:e(d)},isShowUpdate:(w=(C=(v=e(s))==null?void 0:v.user)==null?void 0:C.modules)==null?void 0:w.includes(e(u).OBJECT.UPDATE),isShowDelete:(k=(B=(f=e(s))==null?void 0:f.user)==null?void 0:B.modules)==null?void 0:k.includes(e(u).OBJECT.DELETE),onOnActionDelete:z},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):i("",!0),Q(M,{count:(D=e(n))==null?void 0:D.count,isSucces:e(m)},null,8,["count","isSucces"]),e(N)?(r(),J(W,{key:1})):i("",!0),e(m)&&!((A=e(n))!=null&&A.count)||e(R)?(r(),L("div",ue,ee(t.$t("emptyTableTitle")),1)):i("",!0)])])):i("",!0)}}};export{ye as default};
