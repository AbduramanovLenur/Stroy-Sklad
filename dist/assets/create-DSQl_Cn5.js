import{u as j,a as G,r as y,y as w,c as J,b as v,d as V,f as S,B as p,w as X,F as K,e as b,k as d,g as Y,h,o as m,i as g,t as _,z as F,A as Z}from"./index-8-F5s4j3.js";import{u as ee,r as f}from"./i18n-validators-72j1n4q8.js";import{a as ae,u as re}from"./generic.services-CQjHStj7.js";import{u as B}from"./useQuery-KERFi8ks.js";import{c as oe}from"./crud.services-Xs683v05.js";import{f as te,g as se}from"./manual.services-4pjALTqx.js";const ne={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},ge={__name:"create",async setup(le){let o,c;const C=ae(),L=Y();j(),G();const q=y(localStorage.getItem("organizationId")),{data:E,isSuccess:M,isLoading:W}=([o,c]=w(()=>B({queryKey:["types"],queryFn:()=>te()})),o=await o,c(),o),{data:k,isSuccess:z,isLoading:N}=([o,c]=w(()=>B({queryKey:["materials",{organizationId:q}],queryFn:()=>se(q.value)})),o=await o,c(),o),t=y({materialId:[],quantity:"",quantityTypeId:[],organizationId:""}),Q=J(()=>({materialId:{required:f},quantity:{required:f},quantityTypeId:{required:f},organizationId:{required:f}})),r=ee(Q,t),U=y([{id:1,model:"quantity",label:"quantityWarehouseLabel",placeholder:"quantityWarehousePlaceholder",icon:"list",errorKey:"quantity"}]),x=y([{id:1,model:"materialId",label:"materialsWarehouseLabel",placeholder:"materialsWarehousePlaceholder",errorKey:"materialId",options:k,success:z,loading:N},{id:2,model:"quantityTypeId",label:"qunatityTypesWarehouseLabel",placeholder:"qunatityTypesWarehousePlaceholder",errorKey:"quantityTypeId",options:E,success:M,loading:W}]),{mutate:P}=re({onMutate:a=>{a.materialId=a.materialId[0],a.quantityTypeId=a.quantityTypeId[0]},mutationFn:a=>oe("warehouse",a),onSuccess:()=>{C.invalidateQueries({queryKey:["warehouse"]}),L.push(Z.WAREHOUSE.path)}}),A=()=>{t.value.organizationId=q.value,r.value.$validate(),console.log(r.value.$errors),!r.value.$errors.length&&(P(t.value),r.value.$reset())};return(a,ie)=>{var $,T;const H=h("Title"),R=h("FormInput"),D=h("FormSelect"),O=h("CustomButton");return m(),v("section",ne,[V("div",ue,[S(H,null,{default:p(()=>[g(`\r
                `+_(a.$t("addNewProductTitle"))+`\r
            `,1)]),_:1}),V("form",{class:"manage__form form-manage",onSubmit:X(A,["prevent"])},[(m(!0),v(K,null,b(U.value,e=>{var s,n,u,l,i;return m(),F(R,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":I=>t.value[e.model]=I,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(n=(s=d(r))==null?void 0:s[e.errorKey])==null?void 0:n.$error,textError:(i=(l=(u=d(r))==null?void 0:u[e.errorKey])==null?void 0:l.$errors[0])==null?void 0:i.$message},{default:p(()=>[g(_(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(m(!0),v(K,null,b(x.value,e=>{var s,n,u,l,i;return m(),F(D,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":I=>t.value[e.model]=I,width:500,options:e.options,error:(n=(s=d(r))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(i=(l=(u=d(r))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:i.$message,success:e.success,loading:e.loading},{default:p(()=>[g(_(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),S(O,{className:`form__submit ${(T=($=d(r))==null?void 0:$.quantityTypeId.$errors[0])!=null&&T.$message?"centered":""}`},{default:p(()=>[g(_(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{ge as default};
//# sourceMappingURL=create-DSQl_Cn5.js.map
