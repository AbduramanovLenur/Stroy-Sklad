import{u as J,a as W,r as p,y as K,c as X,b as y,d as S,f as V,k as s,w as Y,F as O,e as w,B as b,g as Z,h,o as u,A as B,z as L,i as f,t as I}from"./index-rVcEkfs7.js";import{u as ee,r as m}from"./i18n-validators-9lIM3i5c.js";import{a as re,u as oe}from"./generic.services-VYFQaCza.js";import{u as C}from"./useQuery-2Cvei3en.js";import{c as ae}from"./crud.services-eAS52g5X.js";import{m as te,a as se}from"./manual.services-j3cZoIi_.js";const ne={class:"manage section-height shadowed"},ie={class:"manage__inner section-padding"},_e={__name:"create",async setup(de){let o,g;const v=re(),F=Z();J(),W();const q=p(localStorage.getItem("organizationId")),{data:E,isSuccess:k,isLoading:M}=([o,g]=K(()=>C({queryKey:["regions"],queryFn:()=>te()})),o=await o,g(),o),{data:N,isSuccess:x,isLoading:z}=([o,g]=K(()=>C({queryKey:["districts"],queryFn:()=>se()})),o=await o,g(),o),t=p({name:"",address:"",organizationId:q.value,regionId:[],districtId:[]}),T=X(()=>({name:{required:m},address:{required:m},organizationId:{required:m},regionId:{required:m},districtId:{required:m}})),a=ee(T,t),D=p([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),P=p([{id:1,model:"regionId",label:"regionObjectLabel",placeholder:"regionObjectPlaceholder",errorKey:"regionId",options:E,success:k,loading:M},{id:2,model:"districtId",label:"districtObjectLabel",placeholder:"districtObjectPlaceholder",errorKey:"districtId",options:N,success:x,loading:z}]),{mutate:Q}=oe({onMutate:r=>{r.regionId=r.regionId[0],r.districtId=r.districtId[0]},mutationFn:r=>ae("building_object",r),onSuccess:()=>{v.invalidateQueries({queryKey:["objects"]}),v.invalidateQueries({queryKey:["objectsList"]}),F.push(B.OBJECTS.path)}}),R=()=>{a.value.$validate(),!a.value.$errors.length&&(Q(t.value),a.value.$reset())};return(r,le)=>{var $,j;const U=h("ManageHead"),H=h("FormInput"),A=h("FormSelect"),G=h("CustomButton");return u(),y("section",ne,[S("div",ie,[V(U,{title:"addNewObjectTitle",to:s(B).OBJECTS.path},null,8,["to"]),S("form",{class:"manage__form form-manage",onSubmit:Y(R,["prevent"])},[(u(!0),y(O,null,w(D.value,e=>{var n,i,d,l,c;return u(),L(H,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":_=>t.value[e.model]=_,width:500,placeholder:r.$t(e.placeholder),name:e.icon,error:(i=(n=s(a))==null?void 0:n[e.errorKey])==null?void 0:i.$error,textError:(c=(l=(d=s(a))==null?void 0:d[e.errorKey])==null?void 0:l.$errors[0])==null?void 0:c.$message},{default:b(()=>[f(I(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(u(!0),y(O,null,w(P.value,e=>{var n,i,d,l,c;return u(),L(A,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":_=>t.value[e.model]=_,width:500,options:e.options,error:(i=(n=s(a))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:i.$error,placeholder:e==null?void 0:e.placeholder,textError:(c=(l=(d=s(a))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:b(()=>[f(I(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),V(G,{className:`form__submit ${(j=($=s(a))==null?void 0:$.districtId.$errors[0])!=null&&j.$message?"centered":""}`},{default:b(()=>[f(I(r.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{_e as default};
//# sourceMappingURL=create-sZKl64gP.js.map
