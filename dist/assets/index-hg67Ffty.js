import{s as Q,x,r as w,y as H,d as f,e as K,k as v,h as e,z as C,i as m,t as L,m as s,o as r,A as T}from"./index-dNR7J35r.js";import{a as M,u as O}from"./generic.services-95joJjsH.js";import{u as R}from"./useQuery-64zn7DqL.js";import{g as V,d as F}from"./crud.services-Wr6W6qUE.js";import{r as U}from"./index-E0_WUxeb.js";const W={class:"company section-height"},$={class:"company__inner section-padding"},j={key:2,class:"empty-table shadowed"},te={__name:"index",async setup(G){let o,p;const _=M(),A=Q(),{page:c,limit:l,search:N}=x(A),g=w(""),y=U(N,500),P=w([{id:1,label:"organizationName",width:220},{id:2,label:"organizationInn",width:115},{id:3,label:"organizationRegion",width:200},{id:4,label:"organizationDistrict",width:155},{id:5,label:"organizationAddress",width:200},{id:6,label:"organizationPhone",width:170},{id:7,label:"organizationDirector",width:230}]),{data:a,isLoading:k,isSuccess:u,isError:D}=([o,p]=H(()=>R({queryKey:["companies",{page:c,limit:l,debouncedSearch:y}],queryFn:()=>V("organization",c.value,l.value,y.value),select:t=>{let d={...t};return d.organizations=t==null?void 0:t.organizations.map(n=>{const i={...n,company:n.organizationName};return delete i.organizationName,i}),d}})),o=await o,p(),o),{mutate:E}=O({mutationFn:t=>F("organization",t),onSuccess:async()=>{await _.invalidateQueries({queryKey:["companies"]}),await _.invalidateQueries({queryKey:["companiesById",g]})}}),I=t=>{g.value=t,E(t)};return(t,d)=>{var h,b,z,S;const n=s("HeadPage"),i=s("Table"),q=s("Pagination"),B=s("Spinner");return r(),f("section",W,[K("div",$,[v(n,{title:"comapnyTitle",to:e(T).CREATE_COMPANIES.path},null,8,["to"]),e(u)&&((h=e(a))!=null&&h.count)?(r(),C(i,{key:0,headers:P.value,table:(b=e(a))==null?void 0:b.organizations,to:e(T).UPDATE_COMPANIES.name,options:{page:e(c),limit:e(l)},onOnActionDelete:I},null,8,["headers","table","to","options"])):m("",!0),v(q,{count:(z=e(a))==null?void 0:z.count,isSucces:e(u)},null,8,["count","isSucces"]),e(k)?(r(),C(B,{key:1})):m("",!0),e(u)&&!((S=e(a))!=null&&S.count)||e(D)?(r(),f("div",j,L(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{te as default};
//# sourceMappingURL=index-hg67Ffty.js.map
