import{u as W,a as j,r as p,y as w,c as J,x as X,b as I,d as C,f as q,k as s,w as Y,F,e as P,B as v,g as Z,C as ee,h as g,o as m,A as $,z,i as S,t as V}from"./index-lJf7jXP7.js";import{u as ae,r as _}from"./i18n-validators-uxPccHio.js";import{a as oe,u as te}from"./generic.services-Aa1SKJf_.js";import{u as E}from"./useQuery-aSnCbYw0.js";import{a as re,u as se}from"./crud.services-puo1KH10.js";import{b as ne}from"./manual.services-vTvsoS9S.js";const le={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},ye={__name:"update",async setup(de){let t,c;const h=oe(),B=Z(),M=ee();W(),j();const y=p(M.params.id),{data:k,isSuccess:x,isLoading:U}=([t,c]=w(()=>E({queryKey:["states"],queryFn:()=>ne()})),t=await t,c(),t),o=p({id:"",fullname:"",organizationId:"",stateId:[]}),L=J(()=>({id:{required:_},fullname:{required:_},organizationId:{required:_},stateId:{required:_}})),r=ae(L,o),N=p([{id:1,model:"fullname",label:"nameProductsLabel",placeholder:"nameProductsPlaceholder",icon:"pen",errorKey:"fullname"}]),Q=p([{id:1,model:"stateId",label:"stateProductsLabel",placeholder:"stateProductsPlaceholder",errorKey:"stateId",options:k,success:x,loading:U}]),{isError:T}=([t,c]=w(()=>E({queryKey:["productsById",y],queryFn:()=>re("construction_material",y.value),select:a=>{o.value.id=a.id,o.value.fullname=a.fullname,o.value.organizationId=a.organizationId,o.value.stateId=[a.stateId]}})),t=await t,c(),t);X(T,a=>{a&&B.push($.HOME.path)});const{mutate:H}=te({onMutate:a=>{a.stateId=a.stateId[0]},mutationFn:a=>se("construction_material",a),onSuccess:()=>{h.invalidateQueries({queryKey:["products"]}),h.invalidateQueries({queryKey:["productsById",y]}),h.invalidateQueries({queryKey:["materials"]}),B.push($.PRODUCTS.path)}}),R=async()=>{const a=localStorage.getItem("organizationId");o.value.organizationId=a,r.value.$validate(),!r.value.$errors.length&&(H(o.value),r.value.$reset())};return(a,ie)=>{var K,b;const D=g("ManageHead"),O=g("FormInput"),A=g("FormSelect"),G=g("CustomButton");return m(),I("section",le,[C("div",ue,[q(D,{title:"editProductTitle",to:s($).PRODUCTS.path},null,8,["to"]),C("form",{class:"manage__form form-manage",onSubmit:Y(R,["prevent"])},[(m(!0),I(F,null,P(N.value,e=>{var n,l,u,d,i;return m(),z(O,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":f=>o.value[e.model]=f,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(l=(n=s(r))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:l.$error,textError:(i=(d=(u=s(r))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:i.$message},{default:v(()=>[S(V(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(m(!0),I(F,null,P(Q.value,e=>{var n,l,u,d,i;return m(),z(A,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":f=>o.value[e.model]=f,width:500,options:e.options,error:(l=(n=s(r))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:l.$error,placeholder:e==null?void 0:e.placeholder,textError:(i=(d=(u=s(r))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:i.$message,success:e.success,loading:e.loading},{default:v(()=>[S(V(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),q(G,{className:`form__submit ${(b=(K=s(r))==null?void 0:K.stateId.$errors[0])!=null&&b.$message?"centered":""}`},{default:v(()=>[S(V(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{ye as default};
//# sourceMappingURL=update-IX2WaUNk.js.map
