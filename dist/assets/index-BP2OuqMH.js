import{q as $,s as q,b as G,c as X,r as A,x as Y,d as J,e as Z,k as L,h as e,y as P,i,t as ee,m as c,o as r,z as Q,E as u}from"./index-YWoyi3P5.js";import{a as te,u as se}from"./generic.services-k4FTnzsm.js";import{u as oe}from"./useQuery-cUByw4Jp.js";import{g as ae,d as ne}from"./crud.services-lAAT8oXP.js";import{r as ie}from"./index-SwZqc-vw.js";const ce={key:0,class:"object"},re={class:"object__inner section-padding"},ue={key:2,class:"empty-table shadowed"},ye={__name:"index",async setup(le){let o,_;const a=te(),I=$(),{page:l,limit:d,search:K}=q(I),U=G(),{user:s}=q(U),p=X(()=>{var t,b;return!!((b=(t=s==null?void 0:s.value.user)==null?void 0:t.modules)!=null&&b.includes(u.OBJECT.READ))}),y=A(""),h=ie(K,500),N=A([{id:1,label:"objectName",width:495},{id:3,label:"objectAddress",width:270}]),{data:n,isLoading:R,isSuccess:m,isError:x}=([o,_]=Y(()=>oe({queryKey:["objects",{page:l,limit:d,debouncedSearch:h,organizationId:s.value.user.organizationId}],queryFn:()=>ae("building_object",l.value,d.value,h.value),enabled:p})),o=await o,_(),o),{mutate:z}=se({mutationFn:t=>ne("building_object",t),onSuccess:()=>{a.invalidateQueries({queryKey:["objects"]}),a.invalidateQueries({queryKey:["objectById",y]}),a.invalidateQueries({queryKey:["objectsList"]}),a.invalidateQueries({queryKey:["blocks"]})}}),H=async t=>{y.value=t,z(t)};return(t,b)=>{var S,E,T,g,j,v,C,w,f,B,D,k,O;const V=c("HeadPage"),F=c("Table"),M=c("Pagination"),W=c("Spinner");return p.value?(r(),J("section",ce,[Z("div",re,[L(V,{title:"objectTitle",to:e(Q).CREATE_OBJECTS.path,isShowCreate:(T=(E=(S=e(s))==null?void 0:S.user)==null?void 0:E.modules)==null?void 0:T.includes(e(u).OBJECT.CREATE)},null,8,["to","isShowCreate"]),e(m)&&((g=e(n))!=null&&g.count)?(r(),P(F,{key:0,headers:N.value,table:(j=e(n))==null?void 0:j.objects,to:e(Q).UPDATE_OBJECTS.name,options:{page:e(l),limit:e(d)},isShowUpdate:(w=(C=(v=e(s))==null?void 0:v.user)==null?void 0:C.modules)==null?void 0:w.includes(e(u).OBJECT.UPDATE),isShowDelete:(D=(B=(f=e(s))==null?void 0:f.user)==null?void 0:B.modules)==null?void 0:D.includes(e(u).OBJECT.DELETE),onOnActionDelete:H},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):i("",!0),L(M,{count:(k=e(n))==null?void 0:k.count,isSucces:e(m)},null,8,["count","isSucces"]),e(R)?(r(),P(W,{key:1})):i("",!0),e(m)&&!((O=e(n))!=null&&O.count)||e(x)?(r(),J("div",ue,ee(t.$t("emptyTableTitle")),1)):i("",!0)])])):i("",!0)}}};export{ye as default};
//# sourceMappingURL=index-BP2OuqMH.js.map
