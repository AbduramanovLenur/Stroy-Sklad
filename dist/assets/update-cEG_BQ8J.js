import{u as ee,a as oe,r as y,n as g,c as ae,y as se,b as $,d as q,f as z,x as h,w as re,F,e as V,k as c,g as le,z as te,h as _,o as p,i as b,t as f,q as E,s as B}from"./index-uEOOChHm.js";import{u as ne,r as t}from"./i18n-validators-Zycmru6O.js";import{a as ue,u as de}from"./generic.services-zAUdS-UM.js";import{u as I,a as ie,b as me}from"./crud.services-AVFHJS4I.js";import{c as ce,d as pe,b as ye}from"./manual.services-OPim9ts4.js";const ge={class:"manage section-height"},he={class:"manage__inner section-padding"},Le={__name:"update",async setup(_e){let a,r;const L=ue(),w=le(),P=te();ee(),oe();const v=y(P.params.id),{data:C,isSuccess:k,isLoading:O}=([a,r]=g(()=>I({queryKey:["organizations"],queryFn:()=>ce()})),a=await a,r(),a),{data:R,isSuccess:x,isLoading:M}=([a,r]=g(()=>I({queryKey:["roles"],queryFn:()=>pe()})),a=await a,r(),a),{data:T,isSuccess:Q,isLoading:U}=([a,r]=g(()=>I({queryKey:["states"],queryFn:()=>ye()})),a=await a,r(),a),s=y({id:"",fullName:"",userName:"",password:"",phoneNumber:"",organizationId:"",roleId:"",stateId:""}),G=ae(()=>({id:{required:t},fullName:{required:t},userName:{required:t},phoneNumber:{required:t},organizationId:{required:t},roleId:{required:t},stateId:{required:t}})),l=ne(G,s),H=y([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),A=y([{id:1,model:"organizationId",label:"employeesOrganizationLabel",options:C,errorKey:"organizationId",success:k,loading:O},{id:2,model:"roleId",label:"employeesRoleLabel",options:R,errorKey:"roleId",success:x,loading:M},{id:3,model:"stateId",label:"employeesStateLabel",options:T,success:Q,loading:U}]),{isError:D}=([a,r]=g(()=>I({queryKey:["employeesById",v],queryFn:()=>ie("user",v.value),select:o=>{s.value.id=o.id,s.value.fullName=o.fullname,s.value.userName=o.userName,s.value.phoneNumber=o.phoneNumber,s.value.organizationId=o.organizationId,s.value.roleId=o.roleId,s.value.stateId=o.stateId}})),a=await a,r(),a);se(D,o=>{o&&w.push(B.HOME.path)});const{mutate:W}=de({mutationFn:o=>me("user",o),onSuccess:()=>{L.invalidateQueries({queryKey:["employees"]}),L.invalidateQueries({queryKey:["employeesById",v]}),w.push(B.EMPLOYEES.path)}}),Y=async()=>{l.value.$validate(),!l.value.$errors.length&&(W(s.value),l.value.$reset())};return(o,be)=>{var S,K;const j=_("Title"),J=_("FormInput"),X=_("FormSelect"),Z=_("CustomButton");return p(),$("section",ge,[q("div",he,[z(j,null,{default:h(()=>[b(`\r
                `+f(o.$t("editEmployeesTitle"))+`\r
            `,1)]),_:1}),q("form",{class:"manage__form form-manage",onSubmit:re(Y,["prevent"])},[(p(!0),$(F,null,V(H.value,e=>{var n,u,d,i,m;return p(),E(J,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":N=>s.value[e.model]=N,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(u=(n=c(l))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(m=(i=(d=c(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:i.$errors[0])==null?void 0:m.$message},{default:h(()=>[b(f(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),$(F,null,V(A.value,e=>{var n,u,d,i,m;return p(),E(X,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":N=>s.value[e.model]=N,width:500,options:e.options,error:(u=(n=c(l))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(m=(i=(d=c(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:i.$errors[0])==null?void 0:m.$message,success:e.success,loading:e.loading},{default:h(()=>[b(f(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),z(Z,{className:`form__submit ${(K=(S=c(l))==null?void 0:S.stateId.$errors[0])!=null&&K.$message?"centered":""}`},{default:h(()=>[b(f(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Le as default};
//# sourceMappingURL=update-cEG_BQ8J.js.map
