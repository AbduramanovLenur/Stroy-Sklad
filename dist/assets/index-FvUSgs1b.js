import{u as J,a as X,x as Y,y as q,b as Z,c as ee,r as I,z as se,d as L,e as te,k as P,h as e,A as B,i as n,t as oe,m as c,o as i,s as N,H as u}from"./index--ASsptNz.js";import{u as ae}from"./generic.services-OmFX1-7T.js";import{u as ne}from"./useQuery-aJZefqwx.js";import{u as ce}from"./useMutation-KDcbY73c.js";import{g as ie,d as ue}from"./crud.services-J6Vd6xLE.js";import{r as re}from"./index-QW6gxCzp.js";const le={key:0,class:"costs"},de={class:"costs__inner section-padding"},me={key:2,class:"empty-table shadowed"},ve={__name:"index",async setup(pe){let o,_;const r=ae(),Q=J(),{t:U}=X(),H=Y(),{page:l,limit:d,search:K}=q(H),R=Z(),{user:t}=q(R),S=ee(()=>{var s,p;return!!((p=(s=t==null?void 0:t.value.user)==null?void 0:s.modules)!=null&&p.includes(u.COST.READ))}),y=I(""),h=re(K,500),x=I([{id:1,label:"costsName",width:70}]),{data:a,isLoading:z,isSuccess:m,isError:V}=([o,_]=se(()=>ne({queryKey:["costs",{page:l,limit:d,debouncedSearch:h,organizationId:t.value.user.organizationId,name:t.value.user.fullName}],queryFn:()=>ie("cost",l.value,d.value,h.value),enabled:S})),o=await o,_(),o),{mutate:F}=ce({mutationFn:s=>ue("cost",s),onSuccess:s=>{s!=null&&s.success&&(r.invalidateQueries({queryKey:["costs"]}),r.invalidateQueries({queryKey:["costById",y]}),r.invalidateQueries({queryKey:["costsList"]}),setTimeout(()=>Q.success(U("deleteToast")),150))}}),M=async s=>{y.value=s,F(s)};return(s,p)=>{var T,C,v,f,g,b,E,w,D,k,A,O;const W=c("HeadPage"),$=c("Table"),j=c("Pagination"),G=c("Spinner");return S.value?(i(),L("section",le,[te("div",de,[P(W,{title:"applicationCost",to:e(N).CREATE_COST.path,isShowCreate:(v=(C=(T=e(t))==null?void 0:T.user)==null?void 0:C.modules)==null?void 0:v.includes(e(u).COST.CREATE)},null,8,["to","isShowCreate"]),e(m)&&((f=e(a))!=null&&f.count)?(i(),B($,{key:0,headers:x.value,table:(g=e(a))==null?void 0:g.cost,to:e(N).UPDATE_COST.name,options:{page:e(l),limit:e(d)},isShowUpdate:(w=(E=(b=e(t))==null?void 0:b.user)==null?void 0:E.modules)==null?void 0:w.includes(e(u).COST.UPDATE),isShowDelete:(A=(k=(D=e(t))==null?void 0:D.user)==null?void 0:k.modules)==null?void 0:A.includes(e(u).COST.DELETE),onOnActionDelete:M},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):n("",!0),P(j,{count:(O=e(a))==null?void 0:O.count,isSucces:e(m)},null,8,["count","isSucces"]),e(z)?(i(),B(G,{key:1})):n("",!0),e(m)&&!e(a).count||e(V)?(i(),L("div",me,oe(s.$t("emptyTableTitle")),1)):n("",!0)])])):n("",!0)}}};export{ve as default};
