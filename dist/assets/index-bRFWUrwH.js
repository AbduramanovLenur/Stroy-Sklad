import{x as j,y as O,b as J,c as X,r as q,z as Y,d as P,e as Z,k as B,h as e,A as I,i as n,t as ee,m as r,o as i,s as Q,G as l}from"./index-dfDRnHVv.js";import{a as se,u as te}from"./generic.services-RbGpw9-f.js";import{u as oe}from"./useQuery-dYILSx3_.js";import{g as ae,d as ne}from"./crud.services-ogW4KK8c.js";import{r as re}from"./index-00EIgC-x.js";const ie={key:0,class:"roles"},le={class:"roles__inner section-padding"},ce={key:2,class:"empty-table shadowed"},he={__name:"index",async setup(ue){let o,_;const c=se(),U=j(),{page:u,limit:d,search:K}=O(U),N=J(),{user:t}=O(N),y=X(()=>{var s,p;return!!((p=(s=t==null?void 0:t.value.user)==null?void 0:s.modules)!=null&&p.includes(l.ROLE.READ))}),h=q(""),S=re(K,500),x=q([{id:1,label:"rolesName",width:1150}]),{data:a,isLoading:z,isSuccess:m,isError:H}=([o,_]=Y(()=>oe({queryKey:["roles",{page:u,limit:d,debouncedSearch:S,organizationId:t.value.user.organizationId}],queryFn:()=>ae("Role",u.value,d.value,S.value),enabled:y})),o=await o,_(),o),{mutate:V}=te({mutationFn:s=>ne("Role",s),onSuccess:s=>{c.invalidateQueries({queryKey:["roles"]}),c.invalidateQueries({queryKey:["rolesById",h]}),c.invalidateQueries({queryKey:["rolesList"]})}}),F=async s=>{h.value=s,V(s)};return(s,p)=>{var E,g,v,R,b,L,T,f,w,D,C,k,A;const M=r("HeadPage"),G=r("Table"),W=r("Pagination"),$=r("Spinner");return y.value?(i(),P("section",ie,[Z("div",le,[B(M,{title:"rolesTitle",to:e(Q).CREATE_ROLE.path,isShowCreate:(v=(g=(E=e(t))==null?void 0:E.user)==null?void 0:g.modules)==null?void 0:v.includes(e(l).ROLE.CREATE)},null,8,["to","isShowCreate"]),e(m)&&((R=e(a))!=null&&R.count)?(i(),I(G,{key:0,headers:x.value,table:(b=e(a))==null?void 0:b.roles,to:e(Q).UPDATE_ROLE.name,options:{page:e(u),limit:e(d)},isShowUpdate:(f=(T=(L=e(t))==null?void 0:L.user)==null?void 0:T.modules)==null?void 0:f.includes(e(l).ROLE.UPDATE),isShowDelete:(C=(D=(w=e(t))==null?void 0:w.user)==null?void 0:D.modules)==null?void 0:C.includes(e(l).ROLE.DELETE),onOnActionDelete:F},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):n("",!0),B(W,{count:(k=e(a))==null?void 0:k.count,isSucces:e(m)},null,8,["count","isSucces"]),e(z)?(i(),I($,{key:1})):n("",!0),e(m)&&!((A=e(a))!=null&&A.count)||e(H)?(i(),P("div",ce,ee(s.$t("emptyTableTitle")),1)):n("",!0)])])):n("",!0)}}};export{he as default};
