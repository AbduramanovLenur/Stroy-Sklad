import{u as W,a as j,r as p,x as w,c as J,B as X,b as $,d as C,f as F,A as _,w as Y,F as K,e as q,k as i,g as Z,C as ee,h as f,o as m,i as y,t as g,y as E,z as k}from"./index-LmWVe-1R.js";import{u as ae,r as h}from"./i18n-validators-3hJSqgzU.js";import{a as oe,u as te}from"./generic.services-SMByNSgc.js";import{u as z}from"./useQuery-y4IjI6tz.js";import{a as re,u as se}from"./crud.services-Lk4iElC7.js";import{b as ne}from"./manual.services-cTuh8iYJ.js";const ue={class:"manage section-height"},le={class:"manage__inner section-padding"},ge={__name:"update",async setup(de){let t,c;const V=oe(),b=Z(),P=ee();W(),j();const v=p(P.params.id),{data:T,isSuccess:x,isLoading:L}=([t,c]=w(()=>z({queryKey:["states"],queryFn:()=>ne()})),t=await t,c(),t),o=p({id:"",fullname:"",organizationId:"",stateId:""}),N=J(()=>({id:{required:h},fullname:{required:h},organizationId:{required:h},stateId:{required:h}})),r=ae(N,o),U=p([{id:1,model:"fullname",label:"nameProductsLabel",placeholder:"nameProductsPlaceholder",icon:"pen",errorKey:"fullname"}]),M=p([{id:1,model:"stateId",label:"stateProductsLabel",options:T,success:x,loading:L}]),{isError:Q}=([t,c]=w(()=>z({queryKey:["productsById",v],queryFn:()=>re("construction_material",v.value),select:a=>{o.value.id=a.id,o.value.fullname=a.fullname,o.value.stateId=a.stateId}})),t=await t,c(),t);X(Q,a=>{a&&b.push(k.HOME.path)});const{mutate:R}=te({mutationFn:a=>se("construction_material",a),onSuccess:()=>{V.invalidateQueries({queryKey:["products"]}),V.invalidateQueries({queryKey:["productsById",v]}),b.push(k.PRODUCTS.path)}}),A=async()=>{o.value.organizationId=1,r.value.$validate(),!r.value.$errors.length&&(R(o.value),r.value.$reset())};return(a,ie)=>{var B,S;const D=f("Title"),H=f("FormInput"),O=f("FormSelect"),G=f("CustomButton");return m(),$("section",ue,[C("div",le,[F(D,null,{default:_(()=>[y(`\r
                `+g(a.$t("editProductTitle"))+`\r
            `,1)]),_:1}),C("form",{class:"manage__form form-manage",onSubmit:Y(A,["prevent"])},[(m(!0),$(K,null,q(U.value,e=>{var s,n,u,l,d;return m(),E(H,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":I=>o.value[e.model]=I,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(n=(s=i(r))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,textError:(d=(l=(u=i(r))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:d.$message},{default:_(()=>[y(g(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(m(!0),$(K,null,q(M.value,e=>{var s,n,u,l,d;return m(),E(O,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":I=>o.value[e.model]=I,width:500,options:e.options,error:(n=(s=i(r))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,textError:(d=(l=(u=i(r))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:d.$message,success:e.success,loading:e.loading},{default:_(()=>[y(g(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),F(G,{className:`form__submit ${(S=(B=i(r))==null?void 0:B.stateId.$errors[0])!=null&&S.$message?"centered":""}`},{default:_(()=>[y(g(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{ge as default};
//# sourceMappingURL=update-lMXpuwi8.js.map
