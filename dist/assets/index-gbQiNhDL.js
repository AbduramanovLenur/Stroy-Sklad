import{q as x,s as z,r as c,x as H,y as K,z as F,d as R,e as M,k,h as e,A as E,i as u,t as U,m as a,o as n,B as P}from"./index-8f2nY-tA.js";import{a as W,u as $}from"./generic.services-2-3LJT-B.js";import{u as j}from"./useQuery-eGcy0OjN.js";import{g as G,d as J}from"./crud.services-swolhUoO.js";import{r as X}from"./index-N_tz-29j.js";const Y={class:"roles"},Z={class:"roles__inner section-padding"},ee={key:2,class:"empty-table shadowed"},le={__name:"index",async setup(te){let o,d;const m=W(),p=x(),{setSearchValue:_,setPagePagination:q}=p,{page:r,limit:l,search:y}=z(p),A=c(localStorage.getItem("organizationId"));H(()=>{_("")}),K(y,()=>{q(1)});const g=c(""),S=X(y,500),B=c([{id:1,label:"rolesName",width:550},{id:3,label:"rolesState"},{id:4,label:"rolesAction"}]),{data:s,isLoading:C,isSuccess:i,isError:I}=([o,d]=F(()=>j({queryKey:["roles",{page:r,limit:l,debouncedSearch:S,organizationId:A}],queryFn:()=>G("Role",r.value,l.value,S.value)})),o=await o,d(),o),{mutate:w}=$({mutationFn:t=>J("Role",t),onSuccess:()=>{m.invalidateQueries({queryKey:["roles"]}),m.invalidateQueries({queryKey:["rolesById",g]})}}),D=async t=>{g.value=t,w(t)};return(t,h)=>{var b,f,v,T;const L=a("HeadPage"),N=a("Table"),O=a("Pagination"),Q=a("Spinner");return n(),R("section",Y,[M("div",Z,[k(L,{title:"rolesTitle",to:e(P).CREATE_ROLES.path,onOnSearch:h[0]||(h[0]=V=>e(_)(V))},null,8,["to"]),e(i)&&((b=e(s))!=null&&b.count)?(n(),E(N,{key:0,headers:B.value,table:(f=e(s))==null?void 0:f.roles,to:e(P).UPDATE_ROLES.name,options:{page:e(r),limit:e(l)},onOnActionDelete:D},null,8,["headers","table","to","options"])):u("",!0),k(O,{count:(v=e(s))==null?void 0:v.count,isSucces:e(i)},null,8,["count","isSucces"]),e(C)?(n(),E(Q,{key:1})):u("",!0),e(i)&&!((T=e(s))!=null&&T.count)||e(I)?(n(),R("div",ee,U(t.$t("emptyTableTitle")),1)):u("",!0)])])}}};export{le as default};
//# sourceMappingURL=index-gbQiNhDL.js.map
