import{_ as I,q as Q,s as V,x as F,y as H,r as P,z as K,d as T,e as R,k as w,h as e,A as k,i as p,t as Y,m as i,o as r,B as q}from"./index-qZ69CyC7.js";import{a as U,u as W}from"./generic.services-34GP1Yc8.js";import{u as $}from"./useQuery-IZNqF3Xo.js";import{g as j,d as G}from"./crud.services-qYEmjzHd.js";import{r as J}from"./index-hYdXxYyx.js";const X={class:"employees"},Z={class:"employees__inner section-padding"},ee={key:2,class:"empty-table shadowed"},te={__name:"index",async setup(oe){let n,d;const y=U(),_=Q(),{setSearchValue:h,setPagePagination:A}=_,{page:c,limit:u,search:b}=V(_);F(()=>{h("")}),H(b,()=>{A(1)});const g=P(""),S=J(b,500),B=P([{id:1,label:"employeesFullName",width:300},{id:2,label:"employeesOrganization",width:320},{id:3,label:"employeesPhone",width:255},{id:4,label:"employeesRole",width:195},{id:5,label:"employeesState"},{id:8,label:"employeesAction"}]),{data:l,isLoading:C,isSuccess:m,isError:x}=([n,d]=K(()=>$({queryKey:["employees",{page:c,limit:u,debouncedSearch:S}],queryFn:()=>j("user",c.value,u.value,S.value),select:t=>{let a={...t};return a.users=t==null?void 0:t.users.map(o=>{const s={...o,phone:o.phoneNumber,company:o.organizationName,name:o.fullName};return delete s.fullName,delete s.phoneNumber,delete s.organizationName,s}),a}})),n=await n,d(),n),{mutate:L}=W({mutationFn:t=>G("user",t),onSuccess:()=>{y.invalidateQueries({queryKey:["employees"]}),y.invalidateQueries({queryKey:["employeesById",g]})}}),M=t=>{g.value=t,L(t)};return(t,a)=>{var f,E,v,N;const o=i("HeadPage"),s=i("Table"),O=i("Pagination"),z=i("Spinner");return r(),T("section",X,[R("div",Z,[w(o,{title:"employeesTitle",to:e(q).CREATE_EMPLOYEES.path,onOnSearch:a[0]||(a[0]=D=>e(h)(D))},null,8,["to"]),e(m)&&((f=e(l))!=null&&f.count)?(r(),k(s,{key:0,headers:B.value,table:(E=e(l))==null?void 0:E.users,to:e(q).UPDATE_EMPLOYEES.name,options:{page:e(c),limit:e(u)},onOnActionDelete:M},null,8,["headers","table","to","options"])):p("",!0),w(O,{count:(v=e(l))==null?void 0:v.count,isSucces:e(m)},null,8,["count","isSucces"]),e(C)?(r(),k(z,{key:1})):p("",!0),e(m)&&!((N=e(l))!=null&&N.count)||e(x)?(r(),T("div",ee,Y(t.$t("emptyTableTitle")),1)):p("",!0)])])}}},re=I(te,[["__scopeId","data-v-5ac9f85c"]]);export{re as default};
//# sourceMappingURL=index-OoXxvebz.js.map
