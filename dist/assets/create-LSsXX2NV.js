import{u as D,a as G,b as j,s as J,c as R,r as S,x as W,d as V,e as b,k as X,h as a,w as Y,F as Z,B as ee,y as m,i as c,C,l as oe,m as n,o as r,z as k,f as w,t as E,E as ae}from"./index-YWoyi3P5.js";import{u as se,r as L}from"./i18n-validators-MvbEOnD3.js";import{a as te,u as re}from"./generic.services-k4FTnzsm.js";import{u as le}from"./useQuery-cUByw4Jp.js";import{c as ne}from"./crud.services-lAAT8oXP.js";import{c as ue}from"./manual.services-GatovLCD.js";const me={key:0,class:"manage section-height shadowed"},ce={class:"manage__inner section-padding"},Ne={__name:"create",async setup(de){let u,i;const p=te(),B=oe();D(),G();const K=j(),{user:d}=J(K),_=R(()=>{var o,l;return!!((l=(o=d==null?void 0:d.value.user)==null?void 0:o.modules)!=null&&l.includes(ae.ROLE.CREATE))}),s=S({shortName:"",fullName:"",roleModules:[]}),q=R(()=>({shortName:{required:L},fullName:{required:L}})),t=se(q,s),{data:F,isLoading:x,isSuccess:f}=([u,i]=W(()=>le({queryKey:["modules"],queryFn:()=>ue(),enabled:_})),u=await u,i(),u),T=S([{id:1,model:"fullName",label:"fullNameRoleLabel",placeholder:"fullNameRolePlaceholder",icon:"role",errorKey:"fullName"},{id:2,model:"shortName",label:"shortNameRoleLabel",placeholder:"shortNameRolePlaceholder",icon:"role",errorKey:"shortName"}]),{mutate:A}=re({mutationFn:o=>ne("Role",o),onSuccess:()=>{p.invalidateQueries({queryKey:["roles"]}),p.invalidateQueries({queryKey:["rolesList"]}),B.push(k.ROLES.path)}}),Q=()=>{t.value.$validate(),!t.value.$errors.length&&(A(s.value),t.value.$reset())};return(o,l)=>{var h,y;const U=n("ManageHead"),H=n("FormInput"),I=n("ActionsModules"),O=n("CustomButton"),P=n("Spinner");return _.value?(r(),V("section",me,[b("div",ce,[X(U,{title:"addNewRolesTitle",to:a(k).ROLES.path},null,8,["to"]),b("form",{class:"manage__form form-manage",onSubmit:Y(Q,["prevent"])},[(r(!0),V(Z,null,ee(T.value,e=>{var N,v,g,M,$;return r(),m(H,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":z=>s.value[e.model]=z,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(v=(N=a(t))==null?void 0:N[e.errorKey])==null?void 0:v.$error,textError:($=(M=(g=a(t))==null?void 0:g[e.errorKey])==null?void 0:M.$errors[0])==null?void 0:$.$message},{default:C(()=>[w(E(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),a(f)?(r(),m(I,{key:0,modelValue:s.value.roleModules,"onUpdate:modelValue":l[0]||(l[0]=e=>s.value.roleModules=e),actions:a(F)},null,8,["modelValue","actions"])):c("",!0),a(f)?(r(),m(O,{key:1,className:`form__submit manage__submit ${(y=(h=a(t))==null?void 0:h.fullName.$errors[0])!=null&&y.$message?"centered":""}`},{default:C(()=>[w(E(o.$t("formButton")),1)]),_:1},8,["className"])):c("",!0)],32),a(x)?(r(),m(P,{key:0})):c("",!0)])])):c("",!0)}}};export{Ne as default};
//# sourceMappingURL=create-LSsXX2NV.js.map
