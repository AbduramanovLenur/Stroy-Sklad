import{s as W,x as K,b as $,c as J,r as A,y as X,d as O,e as Y,k as q,h as e,z as P,i as n,t as Z,m as i,o as l,A as I,G as c}from"./index-sKMtYVf1.js";import{a as ee,u as se}from"./generic.services-Y9l1kbCB.js";import{u as oe}from"./useQuery-oNoZrsai.js";import{g as te,d as ae}from"./crud.services-OfzCCZDD.js";import{r as ne}from"./index-P9w-NFZG.js";const ie={key:0,class:"blocks"},le={class:"blocks__inner section-padding"},ce={key:2,class:"empty-table shadowed"},pe={__name:"index",async setup(re){let t,_;const r=ee(),Q=W(),{page:u,limit:d,search:R}=K(Q),U=$(),{user:o}=K(U),p=J(()=>{var s,m;return!!((m=(s=o==null?void 0:o.value.user)==null?void 0:s.modules)!=null&&m.includes(c.BLOCK.READ))}),k=A(""),h=ne(R,500),N=A([{id:1,label:"blockName",width:225},{id:2,label:"blockObject",width:250},{id:4,label:"blockFloors",width:200},{id:5,label:"blockRooms",width:200},{id:6,label:"blockAddress",width:250}]),{data:a,isLoading:x,isSuccess:b,isError:z}=([t,_]=X(()=>oe({queryKey:["blocks",{page:u,limit:d,debouncedSearch:h,organizationId:o.value.user.organizationId}],queryFn:()=>te("building_block",u.value,d.value,h.value),enabled:p})),t=await t,_(),t),{mutate:F}=se({mutationFn:s=>ae("building_block",s),onSuccess:()=>{r.invalidateQueries({queryKey:["blocks"]}),r.invalidateQueries({queryKey:["blocksById",k]}),r.invalidateQueries({queryKey:["blocksList"]})}}),H=async s=>{k.value=s,F(s)};return(s,m)=>{var y,S,g,w,C,v,B,E,L,T,f,D;const V=i("HeadPage"),M=i("Table"),j=i("Pagination"),G=i("Spinner");return p.value?(l(),O("section",ie,[Y("div",le,[q(V,{title:"blockTitle",to:e(I).CREATE_BLOCK.path,isShowCreate:(g=(S=(y=e(o))==null?void 0:y.user)==null?void 0:S.modules)==null?void 0:g.includes(e(c).BLOCK.CREATE)},null,8,["to","isShowCreate"]),e(b)&&((w=e(a))!=null&&w.count)?(l(),P(M,{key:0,headers:N.value,table:(C=e(a))==null?void 0:C.blocks,to:e(I).UPDATE_BLOCK.name,options:{page:e(u),limit:e(d)},isShowUpdate:(E=(B=(v=e(o))==null?void 0:v.user)==null?void 0:B.modules)==null?void 0:E.includes(e(c).BLOCK.UPDATE),isShowDelete:(f=(T=(L=e(o))==null?void 0:L.user)==null?void 0:T.modules)==null?void 0:f.includes(e(c).BLOCK.DELETE),onOnActionDelete:H},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):n("",!0),q(j,{count:(D=e(a))==null?void 0:D.count,isSucces:e(b)},null,8,["count","isSucces"]),e(x)?(l(),P(G,{key:1})):n("",!0),e(b)&&!e(a).count||e(z)?(l(),O("div",ce,Z(s.$t("emptyTableTitle")),1)):n("",!0)])])):n("",!0)}}};export{pe as default};
//# sourceMappingURL=index-z6pOhdfh.js.map
