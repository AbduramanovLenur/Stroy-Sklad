import{_ as Q,n as V,s as F,r as d,q as H,x as K,y as L,b as w,d as M,j as P,g as e,z as I,h as p,t as G,l as r,o as i,A as R}from"./index-LIAghTzt.js";import{a as j,u as W}from"./generic.services-g7-190gM.js";import{u as $}from"./useQuery-lbUIVZoa.js";import{g as J,d as X}from"./crud.services-v10L7FpB.js";import{r as Y}from"./index-YHyICAjd.js";const Z={class:"employees"},ee={class:"employees__inner section-padding"},te={key:2,class:"empty-table shadowed"},oe={__name:"index",async setup(se){let a,y;const _=j(),g=V(),{setSearchValue:h,setPagePagination:k}=g,{page:c,limit:u,search:b}=F(g),q=d(localStorage.getItem("organizationId"));H(()=>{h("")}),K(b,()=>{k(1)});const S=d(""),f=Y(b,500),z=d([{id:1,label:"employeesFullName",width:300},{id:2,label:"employeesOrganization",width:320},{id:3,label:"employeesPhone",width:255},{id:4,label:"employeesRole",width:195},{id:5,label:"employeesState"},{id:8,label:"employeesAction"}]),{data:l,isLoading:A,isSuccess:m,isError:C}=([a,y]=L(()=>$({queryKey:["orgUsers",{page:c,limit:u,debouncedSearch:f,organizationId:q}],queryFn:()=>J("user",c.value,u.value,f.value),select:t=>{let n={...t};return n.users=t==null?void 0:t.users.map(o=>{const s={...o,phone:o.phoneNumber,company:o.organizationName,name:o.fullName};return delete s.fullName,delete s.phoneNumber,delete s.organizationName,s}),n}})),a=await a,y(),a),{mutate:U}=W({mutationFn:t=>X("user",t),onSuccess:()=>{_.invalidateQueries({queryKey:["orgUsers"]}),_.invalidateQueries({queryKey:["orgUserById",S]})}}),x=t=>{S.value=t,U(t)};return(t,n)=>{var v,N,E,T;const o=r("HeadPage"),s=r("Table"),B=r("Pagination"),O=r("Spinner");return i(),w("section",Z,[M("div",ee,[P(o,{title:"employeesTitle",to:e(R).CREATE_ORG_USER.path,onOnSearch:n[0]||(n[0]=D=>e(h)(D))},null,8,["to"]),e(m)&&((v=e(l))!=null&&v.count)?(i(),I(s,{key:0,headers:z.value,table:(N=e(l))==null?void 0:N.users,to:e(R).UPDATE_ORG_USER.name,options:{page:e(c),limit:e(u)},onOnActionDelete:x},null,8,["headers","table","to","options"])):p("",!0),P(B,{count:(E=e(l))==null?void 0:E.count,isSucces:e(m)},null,8,["count","isSucces"]),e(A)?(i(),I(O,{key:1})):p("",!0),e(m)&&!((T=e(l))!=null&&T.count)||e(C)?(i(),w("div",te,G(t.$t("emptyTableTitle")),1)):p("",!0)])])}}},ce=Q(oe,[["__scopeId","data-v-1e684e99"]]);export{ce as default};
//# sourceMappingURL=index-SOFqsPG3.js.map
