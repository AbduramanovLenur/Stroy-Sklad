import{u as J,a as X,b as Y,y as Z,c as w,r as y,z as ee,d as f,e as C,k as I,h as t,w as ae,F as M,C as b,D as g,i as oe,l as re,m as h,o as d,s as F,A as K,f as v,t as $,H as te,E as se}from"./index-duUvqP-c.js";import{c as ne}from"./crud.services-W2EdIOzx.js";import{j as ue}from"./manual.services-UeOdc-dP.js";import{u as le,r as U}from"./i18n-validators-vfJMHImW.js";import{a as ie,u as de}from"./generic.services-9zWUdppN.js";import{u as me}from"./useQuery-nCo--xAY.js";const ce={key:0,class:"manage section-height shadowed"},he={class:"manage__inner section-padding"},Ee={__name:"create",async setup(pe){let m,E;const k=ie(),B=re(),H=J(),{t:N}=X(),T=Y(),{user:c}=Z(T),S=w(()=>{var a,p;return!!((p=(a=c==null?void 0:c.value.user)==null?void 0:a.modules)!=null&&p.includes(te.WAREHOUSE.CREATE))}),o=y({materialId:[],quantity:""}),W=w(()=>({materialId:{required:U},quantity:{required:U}})),r=le(W,o),{data:A,isSuccess:L,isLoading:R}=([m,E]=ee(()=>me({queryKey:["materialsList",{organizationId:c.value.user.organizationId}],queryFn:()=>ue(),enabled:S})),m=await m,E(),m),x=y([{id:1,model:"quantity",label:"quantityWarehouseLabel",placeholder:"quantityWarehousePlaceholder",icon:"list",errorKey:"quantity"}]),z=y([{id:1,model:"materialId",label:"materialsWarehouseLabel",placeholder:"materialsWarehousePlaceholder",errorKey:"materialId",options:A,success:L,loading:R}]),{mutate:D}=de({onMutate:a=>{a.materialId=a.materialId[0]},mutationFn:a=>ne("warehouse",a),onSuccess:a=>{a!=null&&a.success&&(o.value=se(o.value),k.invalidateQueries({queryKey:["warehouse"]}),B.push(F.WAREHOUSE.path),setTimeout(()=>H.success(N("createToast")),150))}}),O=()=>{if(r.value.$validate(),r.value.$errors.length)return;const a={...o.value};D(a),r.value.$reset()};return(a,p)=>{var V,q;const P=h("ManageHead"),Q=h("FormSelect"),j=h("FormInput"),G=h("CustomButton");return S.value?(d(),f("section",ce,[C("div",he,[I(P,{title:"addNewProductTitle",to:t(F).WAREHOUSE.path},null,8,["to"]),C("form",{class:"manage__form form-manage",onSubmit:ae(O,["prevent"])},[(d(!0),f(M,null,b(z.value,e=>{var s,n,u,l,i;return d(),K(Q,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":_=>o.value[e.model]=_,modelModifiers:{trim:!0},width:500,options:e.options,error:(n=(s=t(r))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(i=(l=(u=t(r))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:i.$message,success:e.success,loading:e.loading},{default:g(()=>[v($(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),(d(!0),f(M,null,b(x.value,e=>{var s,n,u,l,i;return d(),K(j,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":_=>o.value[e.model]=_,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(n=(s=t(r))==null?void 0:s[e.errorKey])==null?void 0:n.$error,textError:(i=(l=(u=t(r))==null?void 0:u[e.errorKey])==null?void 0:l.$errors[0])==null?void 0:i.$message},{default:g(()=>[v($(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),I(G,{className:`form__submit ${(q=(V=t(r))==null?void 0:V.quantity.$errors[0])!=null&&q.$message?"centered":""}`},{default:g(()=>[v($(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])):oe("",!0)}}};export{Ee as default};
