import{u as ee,a as oe,q as ae,r as y,z as h,c as re,y as se,d as v,e as E,k as P,h as n,w as le,F as q,C as F,D as N,l as te,E as ne,m as g,o as p,B as b,A as V,f as S,t as w}from"./index-8f2nY-tA.js";import{u as de,r as t}from"./i18n-validators-fCwa1ZSs.js";import{a as ue,u as ie}from"./generic.services-2-3LJT-B.js";import{u as I}from"./useQuery-eGcy0OjN.js";import{a as me,u as ce}from"./crud.services-swolhUoO.js";import{c as pe,d as ye,b as he}from"./manual.services-mSBZeXJB.js";const ge={class:"manage section-height shadowed"},Ie={class:"manage__inner section-padding"},$e={__name:"update",async setup(_e){let a,s;const L=ue(),$=te(),B=ne();ee(),oe(),ae();const _=y(B.params.id),{data:M,isSuccess:C,isLoading:O}=([a,s]=h(()=>I({queryKey:["organizations"],queryFn:()=>pe()})),a=await a,s(),a),{data:R,isSuccess:k,isLoading:x}=([a,s]=h(()=>I({queryKey:["roles"],queryFn:()=>ye()})),a=await a,s(),a),{data:H,isSuccess:Q,isLoading:T}=([a,s]=h(()=>I({queryKey:["states"],queryFn:()=>he()})),a=await a,s(),a),r=y({id:"",fullName:"",userName:"",password:"",phoneNumber:"",organizationId:[],roleId:[],stateId:[]}),U=re(()=>({id:{required:t},fullName:{required:t},userName:{required:t},phoneNumber:{required:t},organizationId:{required:t},roleId:{required:t},stateId:{required:t}})),l=de(U,r),G=y([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),A=y([{id:1,model:"organizationId",label:"employeesOrganizationLabel",placeholder:"employeesOrganizationPlaceholder",errorKey:"organizationId",options:M,success:C,loading:O},{id:2,model:"roleId",label:"employeesRoleLabel",placeholder:"employeesRolePlaceholder",errorKey:"roleId",options:R,success:k,loading:x},{id:3,model:"stateId",label:"employeesStatePlaceholder",placeholder:"employeesStatePlaceholder",errorKey:"stateId",options:H,success:Q,loading:T}]),{isError:D}=([a,s]=h(()=>I({queryKey:["employeesById",_],queryFn:()=>me("user",_.value),select:o=>{r.value.id=o.id,r.value.fullName=o.fullName,r.value.userName=o.userName,r.value.phoneNumber=o.phoneNumber,r.value.organizationId=[o.organizationId],r.value.roleId=[o.roleId],r.value.stateId=[o.stateId]}})),a=await a,s(),a);se(D,o=>{o&&$.push(b.HOME.path)});const{mutate:Y}=ie({onMutate:o=>{o.organizationId=o.organizationId[0],o.roleId=o.roleId[0],o.stateId=o.stateId[0]},mutationFn:o=>ce("user",o),onSuccess:()=>{L.invalidateQueries({queryKey:["employees"]}),L.invalidateQueries({queryKey:["employeesById",_]}),$.push(b.EMPLOYEES.path)}}),W=async()=>{l.value.$validate(),!l.value.$errors.length&&(Y(r.value),l.value.$reset())};return(o,fe)=>{var z,K;const j=g("ManageHead"),J=g("FormInput"),X=g("FormSelect"),Z=g("CustomButton");return p(),v("section",ge,[E("div",Ie,[P(j,{title:"editEmployeesTitle",to:n(b).EMPLOYEES.path},null,8,["to"]),E("form",{class:"manage__form form-manage",onSubmit:le(W,["prevent"])},[(p(!0),v(q,null,F(G.value,e=>{var d,u,i,m,c;return p(),V(J,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":f=>r.value[e.model]=f,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(u=(d=n(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(c=(m=(i=n(l))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:c.$message},{default:N(()=>[S(w(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),v(q,null,F(A.value,e=>{var d,u,i,m,c;return p(),V(X,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":f=>r.value[e.model]=f,width:500,options:e.options,error:(u=(d=n(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:u.$error,placeholder:e==null?void 0:e.placeholder,textError:(c=(m=(i=n(l))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:N(()=>[S(w(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),P(Z,{className:`form__submit ${(K=(z=n(l))==null?void 0:z.stateId.$errors[0])!=null&&K.$message?"centered":""}`},{default:N(()=>[S(w(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{$e as default};
//# sourceMappingURL=update-x6cPlroZ.js.map
