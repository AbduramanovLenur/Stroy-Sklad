import{u as ae,a as te,r as y,y as h,c as oe,x as re,b as f,d as F,f as L,k as n,w as se,F as W,e as b,B as w,g as ne,C as ue,h as I,o as p,A as S,z as M,i as T,t as $}from"./index-xEhNh2bJ.js";import{u as ie,r as u}from"./i18n-validators-6dxtFobU.js";import{a as le,u as de}from"./generic.services-cTEduup6.js";import{u as g}from"./useQuery-9UwmWmpU.js";import{a as me,u as ce}from"./crud.services-QxvbF8R1.js";import{f as ye,g as pe,b as he}from"./manual.services-qdVUyuV6.js";const Ie={class:"manage section-height shadowed"},ge={class:"manage__inner section-padding"},Ke={__name:"update",async setup(qe){let t,r;const K=le(),V=ne(),C=ue();ae(),te();const q=y(C.params.id),_=y(localStorage.getItem("organizationId")),{data:z,isSuccess:Q,isLoading:k}=([t,r]=h(()=>g({queryKey:["types"],queryFn:()=>ye()})),t=await t,r(),t),{data:x,isSuccess:H,isLoading:U}=([t,r]=h(()=>g({queryKey:["materials",{organizationId:_}],queryFn:()=>pe(_.value)})),t=await t,r(),t),{data:N,isSuccess:P,isLoading:A}=([t,r]=h(()=>g({queryKey:["states"],queryFn:()=>he()})),t=await t,r(),t),o=y({id:"",materialId:[],quantity:"",quantityTypeId:[],organizationId:"",stateId:[]}),R=oe(()=>({id:{required:u},materialId:{required:u},quantity:{required:u},quantityTypeId:{required:u},organizationId:{required:u},stateId:{required:u}})),s=ie(R,o),O=y([{id:1,model:"quantity",label:"quantityWarehouseLabel",placeholder:"quantityWarehousePlaceholder",icon:"list",errorKey:"quantity"}]),D=y([{id:1,model:"materialId",label:"materialsWarehouseLabel",placeholder:"materialsWarehousePlaceholder",errorKey:"materialId",options:x,success:H,loading:U},{id:2,model:"quantityTypeId",label:"qunatityTypesWarehouseLabel",placeholder:"qunatityTypesWarehousePlaceholder",errorKey:"quantityTypeId",options:z,success:Q,loading:k},{id:3,model:"stateId",label:"stateWarehouseLabel",placeholder:"stateWarehousePlaceholder",errorKey:"stateId",options:N,success:P,loading:A}]),{isError:G}=([t,r]=h(()=>g({queryKey:["warehouseById",q],queryFn:()=>me("warehouse",q.value),select:a=>{o.value.id=a.id,o.value.materialId=[a.materialId],o.value.quantity=a.quantity,o.value.quantityTypeId=[a.quantityTypeId],o.value.organizationId=a.organizationId,o.value.stateId=[a.stateId]}})),t=await t,r(),t);re(G,a=>{a&&V.push(S.HOME.path)});const{mutate:j}=de({onMutate:a=>{a.materialId=a.materialId[0],a.quantityTypeId=a.quantityTypeId[0],a.stateId=a.stateId[0]},mutationFn:a=>ce("warehouse",a),onSuccess:()=>{K.invalidateQueries({queryKey:["warehouse"]}),K.invalidateQueries({queryKey:["warehouseById",q]}),V.push(S.WAREHOUSE.path)}}),J=async()=>{o.value.organizationId=_.value,s.value.$validate(),!s.value.$errors.length&&(j(o.value),s.value.$reset())};return(a,_e)=>{var B,E;const X=I("ManageHead"),Y=I("FormInput"),Z=I("FormSelect"),ee=I("CustomButton");return p(),f("section",Ie,[F("div",ge,[L(X,{title:"editProductTitle",to:n(S).WAREHOUSE.path},null,8,["to"]),F("form",{class:"manage__form form-manage",onSubmit:se(J,["prevent"])},[(p(!0),f(W,null,b(O.value,e=>{var i,l,d,m,c;return p(),M(Y,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":v=>o.value[e.model]=v,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(l=(i=n(s))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:l.$error,textError:(c=(m=(d=n(s))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:c.$message},{default:w(()=>[T($(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),f(W,null,b(D.value,e=>{var i,l,d,m,c;return p(),M(Z,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":v=>o.value[e.model]=v,width:500,options:e.options,error:(l=(i=n(s))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:l.$error,placeholder:e==null?void 0:e.placeholder,textError:(c=(m=(d=n(s))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:w(()=>[T($(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),L(ee,{className:`form__submit ${(E=(B=n(s))==null?void 0:B.stateId.$errors[0])!=null&&E.$message?"centered":""}`},{default:w(()=>[T($(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Ke as default};
//# sourceMappingURL=update-vKES1xU1.js.map
