import{n as V,s as x,r as p,q as F,x as H,y as K,b as v,d as M,f as I,k as e,z as P,l as r,t as R,h as o,o as n,A as T}from"./index-lJf7jXP7.js";import{a as U,u as j}from"./generic.services-Aa1SKJf_.js";import{u as W}from"./useQuery-aSnCbYw0.js";import{g as $,d as G}from"./crud.services-puo1KH10.js";import{r as J}from"./index-X2DhGbTM.js";const X={class:"applications"},Y={class:"applications__inner"},Z={key:2,class:"empty-table shadowed"},se={__name:"index",async setup(ee){let a,d;const u=U(),m=V(),{setSearchValue:_,setPagePagination:C}=m,{page:s,limit:l,search:h}=x(m),b=p(localStorage.getItem("organizationId"));F(()=>{_("")}),H(h,()=>{C(1)});const y=p(""),g=J(h,500),k=p([{id:1,label:"applicationUserName",width:150},{id:2,label:"applicationOrganization",width:220},{id:3,label:"applicationDedline",width:265},{id:4,label:"applicationConstructionMaterial",width:175},{id:5,label:"applicationObject",width:115},{id:6,label:"applicationBlock",width:105},{id:7,label:"applicationFloor",width:100},{id:8,label:"applicationCost",width:165},{id:9,label:"applicationState",width:130},{id:9,label:"applicationAction",width:110}]),{data:i,isLoading:q,isSuccess:c,isError:B}=([a,d]=K(()=>W({queryKey:["applications",{page:s,limit:l,debouncedSearch:g,organizationId:b}],queryFn:()=>$("api",s.value,l.value,g.value,{organizationId:b.value})})),a=await a,d(),a),{mutate:D}=j({mutationFn:t=>G("api",t),onSuccess:()=>{u.invalidateQueries({queryKey:["applications"]}),u.invalidateQueries({queryKey:["applicationsById",y]})}}),N=async t=>{y.value=t,D(t)};return(t,S)=>{var w,f,A;const O=o("HeadPage"),z=o("Table"),E=o("Pagination"),L=o("Spinner");return n(),v("section",X,[M("div",Y,[I(O,{title:"applicationTitle",to:e(T).CREATE_APPLICATIONS.path,onOnSearch:S[0]||(S[0]=Q=>e(_)(Q))},null,8,["to"]),e(c)&&((w=e(i))!=null&&w.count)?(n(),P(z,{key:0,headers:k.value,table:(f=e(i))==null?void 0:f.applications,to:e(T).UPDATE_APPLICATIONS.name,options:{page:e(s),limit:e(l)},onOnActionDelete:N},null,8,["headers","table","to","options"])):r("",!0),I(E,{count:(A=e(i))==null?void 0:A.count,isSucces:e(c)},null,8,["count","isSucces"]),e(q)?(n(),P(L,{key:1})):r("",!0),e(c)&&!e(i).count||e(B)?(n(),v("div",Z,R(t.$t("emptyTableTitle")),1)):r("",!0)])])}}};export{se as default};
//# sourceMappingURL=index-UCHUUbpC.js.map
