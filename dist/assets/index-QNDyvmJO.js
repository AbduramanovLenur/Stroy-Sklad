import{q as V,s as x,x as H,y as K,r as C,z as L,d as P,e as R,k as A,h as e,A as T,i as m,t as F,m as r,o as c,B as N}from"./index-8f2nY-tA.js";import{a as U,u as W}from"./generic.services-2-3LJT-B.js";import{u as $}from"./useQuery-eGcy0OjN.js";import{g as j,d as G}from"./crud.services-swolhUoO.js";import{r as J}from"./index-N_tz-29j.js";const X={class:"company section-height"},Y={class:"company__inner section-padding"},Z={key:2,class:"empty-table shadowed"},se={__name:"index",async setup(ee){let o,p;const g=U(),y=V(),{setSearchValue:_,setPagePagination:k}=y,{page:l,limit:u,search:h}=x(y);H(()=>{_("")}),K(h,()=>{k(1)});const b=C(""),z=J(h,500),D=C([{id:1,label:"organizationName",width:220},{id:2,label:"organizationInn",width:115},{id:3,label:"organizationRegion",width:200},{id:4,label:"organizationDistrict",width:155},{id:5,label:"organizationAddress",width:200},{id:6,label:"organizationPhone",width:170},{id:7,label:"organizationDirector",width:230},{id:7,label:"organizationState"},{id:8,label:"organizationAction"}]),{data:n,isLoading:E,isSuccess:d,isError:q}=([o,p]=L(()=>$({queryKey:["companies",{page:l,limit:u,debouncedSearch:z}],queryFn:()=>j("organization",l.value,u.value,z.value),select:t=>{let a={...t};return a.organizations=t==null?void 0:t.organizations.map(i=>{const s={...i,company:i.organizationName};return delete s.organizationName,s}),a}})),o=await o,p(),o),{mutate:B}=W({mutationFn:t=>G("organization",t),onSuccess:async()=>{await g.invalidateQueries({queryKey:["companies"]}),await g.invalidateQueries({queryKey:["companiesById",b]})}}),I=t=>{b.value=t,B(t)};return(t,a)=>{var S,w,f,v;const i=r("HeadPage"),s=r("Table"),M=r("Pagination"),O=r("Spinner");return c(),P("section",X,[R("div",Y,[A(i,{title:"comapnyTitle",to:e(N).CREATE_COMPANIES.path,onOnSearch:a[0]||(a[0]=Q=>e(_)(Q))},null,8,["to"]),e(d)&&((S=e(n))!=null&&S.count)?(c(),T(s,{key:0,headers:D.value,table:(w=e(n))==null?void 0:w.organizations,to:e(N).UPDATE_COMPANIES.name,options:{page:e(l),limit:e(u)},onOnActionDelete:I},null,8,["headers","table","to","options"])):m("",!0),A(M,{count:(f=e(n))==null?void 0:f.count,isSucces:e(d)},null,8,["count","isSucces"]),e(E)?(c(),T(O,{key:1})):m("",!0),e(d)&&!((v=e(n))!=null&&v.count)||e(q)?(c(),P("div",Z,F(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{se as default};
//# sourceMappingURL=index-QNDyvmJO.js.map
