import{u as ae,a as se,n as te,r as p,y as h,c as ie,x as ne,b as K,d as L,f as w,B as y,w as le,F as q,e as P,k as m,g as de,C as ue,h as I,o as g,i as f,t as _,z as V,A as B}from"./index-83KN3zvu.js";import{u as ce,r as s}from"./i18n-validators-_d1FbLxZ.js";import{a as me,u as ge}from"./generic.services-Nv3JxhQ5.js";import{u as v}from"./useQuery-08AU-ufr.js";import{a as pe,u as he}from"./crud.services-VbQaEYyd.js";import{m as ye,a as Ie,b as fe}from"./manual.services-sGtPegzs.js";const _e={class:"manage section-height shadowed"},ve={class:"manage__inner section-padding"},we={__name:"update",async setup(be){let o,t;const N=me(),O=de(),F=ue();ae(),se();const C=te(),{setPagePagination:E,setLimitPagination:k}=C,b=p(F.params.id),{data:M,isSuccess:T,isLoading:x}=([o,t]=h(()=>v({queryKey:["regions"],queryFn:()=>ye()})),o=await o,t(),o),{data:R,isSuccess:D,isLoading:Q}=([o,t]=h(()=>v({queryKey:["districts"],queryFn:()=>Ie()})),o=await o,t(),o),{data:U,isSuccess:A,isLoading:G}=([o,t]=h(()=>v({queryKey:["states"],queryFn:()=>fe()})),o=await o,t(),o),a=p({id:"",fullName:"",inn:"",address:"",phoneNumber:"",director:"",regionId:[],districtId:[],stateId:[]}),H=ie(()=>({id:{required:s},fullName:{required:s},inn:{required:s},address:{required:s},phoneNumber:{required:s},director:{required:s},regionId:{required:s},districtId:{required:s},stateId:{required:s}})),i=ce(H,a),W=p([{id:1,model:"fullName",label:"nameOrganizationLabel",placeholder:"nameOrganizationPlaceholder",icon:"input-company",errorKey:"fullName"},{id:2,model:"inn",label:"innOrganizationLabel",placeholder:"innOrganizationPlaceholder",icon:"tin",errorKey:"inn"},{id:3,model:"address",label:"addressOrganizationLabel",placeholder:"addressOrganizationPlaceholder",icon:"address",errorKey:"address"},{id:4,model:"phoneNumber",label:"phoneOrganizationLabel",placeholder:"phoneOrganizationPlaceholder",icon:"phone",errorKey:"phoneNumber"},{id:5,model:"director",label:"directorOrganizationLabel",placeholder:"directorOrganizationPlaceholder",icon:"person",errorKey:"director"}]),j=p([{id:1,model:"regionId",label:"regionOrganizationLabel",placeholder:"regionOrganizationPlaceholder",errorKey:"regionId",options:M,success:T,loading:x},{id:2,model:"districtId",label:"districtOrganizationLabel",placeholder:"districtOrganizationPlaceholder",errorKey:"districtId",options:R,success:D,loading:Q},{id:3,model:"stateId",label:"stateOrganizationLabel",placeholder:"stateOrganizationPlaceholder",errorKey:"stateId",options:U,success:A,loading:G}]),{isError:J}=([o,t]=h(()=>v({queryKey:["companiesById",b],queryFn:()=>pe("organization",b.value),select:e=>{a.value.id=e.id,a.value.fullName=e.fullName,a.value.inn=e.inn,a.value.address=e.address,a.value.phoneNumber=e.phoneNumber,a.value.director=e.director,a.value.regionId=[e==null?void 0:e.regionId],a.value.districtId=[e==null?void 0:e.districtId],a.value.stateId=[e==null?void 0:e.stateId]}})),o=await o,t(),o);ne(J,e=>{e&&O.push(B.HOME.path)});const{mutate:X}=ge({onMutate:e=>{e.regionId=e.regionId[0],e.districtId=e.districtId[0],e.stateId=e.stateId[0]},mutationFn:e=>he("organization",e),onSuccess:async()=>{await N.invalidateQueries({queryKey:["companies"]}),await N.invalidateQueries({queryKey:["companiesById",b]}),E(1),k(10),O.push(B.COMPANIES.path)}}),Y=async()=>{i.value.$validate(),!i.value.$errors.length&&(X(a.value),i.value.$reset())};return(e,ze)=>{var $,S;const Z=I("Title"),ee=I("FormInput"),re=I("FormSelect"),oe=I("CustomButton");return g(),K("section",_e,[L("div",ve,[w(Z,null,{default:y(()=>[f(`\r
                `+_(e.$t("editCompanyTitle"))+`\r
            `,1)]),_:1}),L("form",{class:"manage__form form-manage",onSubmit:le(Y,["prevent"])},[(g(!0),K(q,null,P(W.value,r=>{var n,l,d,u,c;return g(),V(ee,{key:r.id,modelValue:a.value[r.model],"onUpdate:modelValue":z=>a.value[r.model]=z,width:500,placeholder:e.$t(r.placeholder),name:r.icon,error:(l=(n=m(i))==null?void 0:n[r==null?void 0:r.errorKey])==null?void 0:l.$error,textError:(c=(u=(d=m(i))==null?void 0:d[r==null?void 0:r.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message},{default:y(()=>[f(_(e.$t(r.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(g(!0),K(q,null,P(j.value,r=>{var n,l,d,u,c;return g(),V(re,{key:r.id,modelValue:a.value[r.model],"onUpdate:modelValue":z=>a.value[r.model]=z,width:500,options:r.options,error:(l=(n=m(i))==null?void 0:n[r==null?void 0:r.errorKey])==null?void 0:l.$error,placeholder:r==null?void 0:r.placeholder,textError:(c=(u=(d=m(i))==null?void 0:d[r==null?void 0:r.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message,success:r.success,loading:r.loading},{default:y(()=>[f(_(e.$t(r.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),w(oe,{className:`form__submit ${(S=($=m(i))==null?void 0:$.stateId.$errors[0])!=null&&S.$message?"centered":""}`},{default:y(()=>[f(_(e.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{we as default};
//# sourceMappingURL=update-YCH5sWj-.js.map
