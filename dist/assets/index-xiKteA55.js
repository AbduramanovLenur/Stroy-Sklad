import{_ as J,s as X,x as O,r as y,b as Y,c as Z,y as ee,d as P,e as se,k as q,h as e,z as x,i,t as oe,m as u,o as c,A as B,G as d}from"./index-FhX-5zgX.js";import{a as te,u as ne}from"./generic.services-shCmd6Kx.js";import{u as ae}from"./useQuery-F-m0HCTz.js";import{g as re,d as le}from"./crud.services--J3Fp5qL.js";import{r as ie}from"./index-9C7Kyu0e.js";const ue={key:0,class:"employees"},ce={class:"employees__inner section-padding"},de={key:2,class:"empty-table shadowed"},me={__name:"index",async setup(pe){let r,h;const S=te(),L=X(),{page:m,limit:p,search:Q}=O(L),z=y(localStorage.getItem("organizationId")),F=Y(),{user:o}=O(F),E=Z(()=>{var s,t;return!!((t=(s=o==null?void 0:o.value.user)==null?void 0:s.modules)!=null&&t.includes(d.ORG_USER.READ))}),g=y(""),b=ie(Q,500),H=y([{id:1,label:"employeesFullName",width:510},{id:3,label:"employeesPhone",width:290},{id:4,label:"employeesRole",width:210}]),{data:l,isLoading:K,isSuccess:_,isError:M}=([r,h]=ee(()=>ae({queryKey:["orgUsers",{page:m,limit:p,debouncedSearch:b,organizationId:z}],queryFn:()=>re("user",m.value,p.value,b.value),select:s=>{let t={...s};return t.users=s==null?void 0:s.users.map(n=>{const a={...n,phone:n.phoneNumber,name:n.fullName};return delete a.fullName,delete a.phoneNumber,a}),t},enabled:E})),r=await r,h(),r),{mutate:V}=ne({mutationFn:s=>le("user",s),onSuccess:()=>{S.invalidateQueries({queryKey:["orgUsers"]}),S.invalidateQueries({queryKey:["orgUserById",g]})}}),W=s=>{g.value=s,V(s)};return(s,t)=>{var R,f,U,v,w,T,C,D,k,A,N,G,I;const n=u("HeadPage"),a=u("Table"),$=u("Pagination"),j=u("Spinner");return E.value?(c(),P("section",ue,[se("div",ce,[q(n,{title:"employeesTitle",to:e(B).CREATE_ORG_USER.path,isShowCreate:(U=(f=(R=e(o))==null?void 0:R.user)==null?void 0:f.modules)==null?void 0:U.includes(e(d).ORG_USER.CREATE)},null,8,["to","isShowCreate"]),e(_)&&((v=e(l))!=null&&v.count)?(c(),x(a,{key:0,headers:H.value,table:(w=e(l))==null?void 0:w.users,to:e(B).UPDATE_ORG_USER.name,options:{page:e(m),limit:e(p)},isShowUpdate:(D=(C=(T=e(o))==null?void 0:T.user)==null?void 0:C.modules)==null?void 0:D.includes(e(d).ORG_USER.UPDATE),isShowDelete:(N=(A=(k=e(o))==null?void 0:k.user)==null?void 0:A.modules)==null?void 0:N.includes(e(d).ORG_USER.DELETE),onOnActionDelete:W},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):i("",!0),q($,{count:(G=e(l))==null?void 0:G.count,isSucces:e(_)},null,8,["count","isSucces"]),e(K)?(c(),x(j,{key:1})):i("",!0),e(_)&&!((I=e(l))!=null&&I.count)||e(M)?(c(),P("div",de,oe(s.$t("emptyTableTitle")),1)):i("",!0)])])):i("",!0)}}},ge=J(me,[["__scopeId","data-v-3bf28cef"]]);export{ge as default};
//# sourceMappingURL=index-xiKteA55.js.map
