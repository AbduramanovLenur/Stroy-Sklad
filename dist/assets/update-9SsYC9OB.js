import{u as ee,a as oe,n as ae,r as h,y as _,c as re,x as se,b as f,d as F,f as V,k as n,w as le,F as B,e as R,B as v,g as te,C as ne,h as g,o as p,A as N,z as q,i as b,t as S}from"./index-x0me4eeV.js";import{u as de,r as l}from"./i18n-validators-N3krClQx.js";import{a as ue,u as me}from"./generic.services-3OPQu4nG.js";import{u as $}from"./useQuery-xv1pFEHU.js";import{a as ie,u as ce}from"./crud.services-2_QkeFR9.js";import{d as pe,b as he}from"./manual.services-gWBYdErO.js";const ge={class:"manage section-height shadowed"},ye={class:"manage__inner section-padding"},we={__name:"update",async setup(Ie){let r,t;const w=ue(),P=te(),E=ne();ee(),oe();const U=ae(),{setPagePagination:z,setLimitPagination:C}=U,y=h(E.params.id),{data:M,isSuccess:k,isLoading:x}=([r,t]=_(()=>$({queryKey:["roles"],queryFn:()=>pe()})),r=await r,t(),r),{data:G,isSuccess:H,isLoading:Q}=([r,t]=_(()=>$({queryKey:["states"],queryFn:()=>he()})),r=await r,t(),r),a=h({id:"",fullName:"",userName:"",password:"",phoneNumber:"",organizationId:"",roleId:[],stateId:[]}),T=re(()=>({id:{required:l},fullName:{required:l},userName:{required:l},phoneNumber:{required:l},organizationId:{required:l},roleId:{required:l},stateId:{required:l}})),s=de(T,a),O=h([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),A=h([{id:1,model:"roleId",label:"employeesRoleLabel",placeholder:"employeesRolePlaceholder",errorKey:"roleId",options:M,success:k,loading:x},{id:2,model:"stateId",label:"employeesStatePlaceholder",placeholder:"employeesStatePlaceholder",options:G,success:H,loading:Q}]),{isError:D}=([r,t]=_(()=>$({queryKey:["orgUserById",y],queryFn:()=>ie("user",y.value),select:o=>{a.value.id=o.id,a.value.fullName=o.fullName,a.value.userName=o.userName,a.value.phoneNumber=o.phoneNumber,a.value.organizationId=o.organizationId,a.value.roleId=[o.roleId],a.value.stateId=[o.stateId]}})),r=await r,t(),r);se(D,o=>{o&&P.push(N.HOME.path)});const{mutate:W}=me({onMutate:o=>{o.roleId=o.roleId[0],o.stateId=o.stateId[0]},mutationFn:o=>ce("user",o),onSuccess:()=>{w.invalidateQueries({queryKey:["orgUser"]}),w.invalidateQueries({queryKey:["orgUserById",y]}),z(1),C(10),P.push(N.ORG_USER.path)}}),j=async()=>{const o=localStorage.getItem("organizationId");a.value.organizationId=o,s.value.$validate(),!s.value.$errors.length&&(W(a.value),s.value.$reset())};return(o,_e)=>{var K,L;const J=g("ManageHead"),X=g("FormInput"),Y=g("FormSelect"),Z=g("CustomButton");return p(),f("section",ge,[F("div",ye,[V(J,{title:"editEmployeesTitle",to:n(N).ORG_USER.path},null,8,["to"]),F("form",{class:"manage__form form-manage",onSubmit:le(j,["prevent"])},[(p(!0),f(B,null,R(O.value,e=>{var d,u,m,i,c;return p(),q(X,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":I=>a.value[e.model]=I,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(u=(d=n(s))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(c=(i=(m=n(s))==null?void 0:m[e==null?void 0:e.errorKey])==null?void 0:i.$errors[0])==null?void 0:c.$message},{default:v(()=>[b(S(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),f(B,null,R(A.value,e=>{var d,u,m,i,c;return p(),q(Y,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":I=>a.value[e.model]=I,width:500,options:e.options,error:(u=(d=n(s))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:u.$error,placeholder:e==null?void 0:e.placeholder,textError:(c=(i=(m=n(s))==null?void 0:m[e==null?void 0:e.errorKey])==null?void 0:i.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:v(()=>[b(S(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),V(Z,{className:`form__submit ${(L=(K=n(s))==null?void 0:K.stateId.$errors[0])!=null&&L.$message?"centered":""}`},{default:v(()=>[b(S(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{we as default};
//# sourceMappingURL=update-9SsYC9OB.js.map
