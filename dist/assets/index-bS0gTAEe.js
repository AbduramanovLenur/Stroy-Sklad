import{n as R,s as V,r as p,q as x,x as H,y as K,b as w,d as U,f as D,k as e,z as I,l as m,t as F,h as r,o as c,A as q}from"./index-83KN3zvu.js";import{a as W,u as $}from"./generic.services-Nv3JxhQ5.js";import{u as j}from"./useQuery-08AU-ufr.js";import{g as G,d as J}from"./crud.services-VbQaEYyd.js";import{r as X}from"./index-21n7PQ3x.js";const Y={class:"products"},Z={class:"products__inner section-padding"},ee={key:2,class:"empty-table shadowed"},ce={__name:"index",async setup(te){let s,_;const y=W(),g=R(),{setSearchValue:h,setPagePagination:A}=g,{page:i,limit:u,search:S}=V(g),b=p(localStorage.getItem("organizationId"));x(()=>{h("")}),H(S,()=>{A(1)});const f=p(""),v=X(S,500),z=p([{id:1,label:"productsName",width:725},{id:4,label:"productsState",width:365},{id:5,label:"productsAction",width:440}]),{data:n,isLoading:B,isSuccess:l,isError:E}=([s,_]=K(()=>j({queryKey:["products",{page:i,limit:u,debouncedSearch:v,organizationId:b}],queryFn:()=>G("construction_material",i.value,u.value,v.value,{organizationId:b.value}),select:t=>{let o=[...t==null?void 0:t.constructionMaterial];return o=o.map(d=>{const a={...d};return delete a.organizationName,a}),{constructionMaterial:o,count:t==null?void 0:t.count}}})),s=await s,_(),s),{mutate:M}=$({mutationFn:t=>J("construction_material",t),onSuccess:()=>{y.invalidateQueries({queryKey:["products"]}),y.invalidateQueries({queryKey:["productsById",f]})}}),N=async t=>{f.value=t,M(t)};return(t,o)=>{var P,T,C,k;const d=r("HeadPage"),a=r("Table"),L=r("Pagination"),O=r("Spinner");return c(),w("section",Y,[U("div",Z,[D(d,{title:"productsTitle",to:e(q).CREATE_PRODUCTS.path,onOnSearch:o[0]||(o[0]=Q=>e(h)(Q))},null,8,["to"]),e(l)&&((P=e(n))!=null&&P.count)?(c(),I(a,{key:0,headers:z.value,table:(T=e(n))==null?void 0:T.constructionMaterial,to:e(q).UPDATE_PRODUCTS.name,options:{page:e(i),limit:e(u)},onOnActionDelete:N},null,8,["headers","table","to","options"])):m("",!0),D(L,{count:(C=e(n))==null?void 0:C.count,isSucces:e(l)},null,8,["count","isSucces"]),e(B)?(c(),I(O,{key:1})):m("",!0),e(l)&&!((k=e(n))!=null&&k.count)||e(E)?(c(),w("div",ee,F(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{ce as default};
//# sourceMappingURL=index-bS0gTAEe.js.map
