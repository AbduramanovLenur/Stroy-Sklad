import{u as W,a as j,r as p,z as C,c as J,y as X,d as g,e as b,k as q,h as s,w as Y,F,C as P,D as v,l as Z,E as ee,m as _,o as i,B as I,A as E,f as $,t as S}from"./index-8f2nY-tA.js";import{u as ae,r as V}from"./i18n-validators-fCwa1ZSs.js";import{a as oe,u as te}from"./generic.services-2-3LJT-B.js";import{u as M}from"./useQuery-eGcy0OjN.js";import{a as re,u as se}from"./crud.services-swolhUoO.js";import{b as le}from"./manual.services-mSBZeXJB.js";const ue={class:"manage section-height shadowed"},ne={class:"manage__inner section-padding"},fe={__name:"update",async setup(de){let t,c;const h=oe(),B=Z(),k=ee();W(),j();const y=p(k.params.id),{data:U,isSuccess:x,isLoading:L}=([t,c]=C(()=>M({queryKey:["states"],queryFn:()=>le()})),t=await t,c(),t),o=p({id:"",fullname:"",stateId:[]}),N=J(()=>({id:{required:V},fullname:{required:V},stateId:{required:V}})),r=ae(N,o),Q=p([{id:1,model:"fullname",label:"nameProductsLabel",placeholder:"nameProductsPlaceholder",icon:"pen",errorKey:"fullname"}]),T=p([{id:1,model:"stateId",label:"stateProductsLabel",placeholder:"stateProductsPlaceholder",errorKey:"stateId",options:U,success:x,loading:L}]),{isError:D}=([t,c]=C(()=>M({queryKey:["productsById",y],queryFn:()=>re("construction_material",y.value),select:a=>{o.value.id=a.id,o.value.fullname=a.fullname,o.value.stateId=[a.stateId]}})),t=await t,c(),t);X(D,a=>{a&&B.push(I.HOME.path)});const{mutate:H}=te({onMutate:a=>{a.stateId=a.stateId[0]},mutationFn:a=>se("construction_material",a),onSuccess:()=>{h.invalidateQueries({queryKey:["products"]}),h.invalidateQueries({queryKey:["productsById",y]}),h.invalidateQueries({queryKey:["materials"]}),B.push(I.PRODUCTS.path)}}),R=async()=>{r.value.$validate(),!r.value.$errors.length&&(H(o.value),r.value.$reset())};return(a,me)=>{var K,w;const O=_("ManageHead"),A=_("FormInput"),z=_("FormSelect"),G=_("CustomButton");return i(),g("section",ue,[b("div",ne,[q(O,{title:"editProductTitle",to:s(I).PRODUCTS.path},null,8,["to"]),b("form",{class:"manage__form form-manage",onSubmit:Y(R,["prevent"])},[(i(!0),g(F,null,P(Q.value,e=>{var l,u,n,d,m;return i(),E(A,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":f=>o.value[e.model]=f,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(u=(l=s(r))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(m=(d=(n=s(r))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:m.$message},{default:v(()=>[$(S(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(i(!0),g(F,null,P(T.value,e=>{var l,u,n,d,m;return i(),E(z,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":f=>o.value[e.model]=f,width:500,options:e.options,error:(u=(l=s(r))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$error,placeholder:e==null?void 0:e.placeholder,textError:(m=(d=(n=s(r))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:m.$message,success:e.success,loading:e.loading},{default:v(()=>[$(S(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),q(G,{className:`form__submit ${(w=(K=s(r))==null?void 0:K.stateId.$errors[0])!=null&&w.$message?"centered":""}`},{default:v(()=>[$(S(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{fe as default};
//# sourceMappingURL=update-dh75LULW.js.map
