import{u as H,a as K,x as L,y as M,r as f,z as O,d as w,e as R,k as T,h as t,A as v,i as m,t as V,m as s,o as c,s as C}from"./index-Su5VrTfH.js";import{a as F,u as U}from"./generic.services-Bjs5T0kb.js";import{u as W}from"./useQuery-TVdyHrTE.js";import{g as $,d as j}from"./crud.services-Tdi7grz4.js";import{r as G}from"./index-VWVnq_Gp.js";const J={class:"company section-height"},X={class:"company__inner section-padding"},Y={key:2,class:"empty-table shadowed"},ie={__name:"index",async setup(Z){let a,p;const _=F(),A=H(),{t:N}=K(),P=L(),{page:r,limit:l,search:k}=M(P),g=f(""),y=G(k,500),D=f([{id:1,label:"organizationName",width:20},{id:2,label:"organizationInn",width:10},{id:3,label:"organizationRegion",width:15},{id:4,label:"organizationDistrict",width:15},{id:5,label:"organizationAddress",width:15},{id:6,label:"organizationPhone",width:15},{id:7,label:"organizationDirector",width:20}]),{data:o,isLoading:E,isSuccess:u,isError:I}=([a,p]=O(()=>W({queryKey:["companies",{page:r,limit:l,debouncedSearch:y}],queryFn:()=>$("organization",r.value,l.value,y.value),select:e=>{let d={...e};return d.organizations=e==null?void 0:e.organizations.map(n=>{const i={...n,company:n.organizationName};return delete i.organizationName,i}),d}})),a=await a,p(),a),{mutate:q}=U({mutationFn:e=>j("organization",e),onSuccess:async e=>{e!=null&&e.success&&(await _.invalidateQueries({queryKey:["companies"]}),await _.invalidateQueries({queryKey:["companyById",g]}),setTimeout(()=>A.success(N("deleteToast")),150))}}),B=e=>{g.value=e,q(e)};return(e,d)=>{var h,b,z,S;const n=s("HeadPage"),i=s("Table"),Q=s("Pagination"),x=s("Spinner");return c(),w("section",J,[R("div",X,[T(n,{title:"comapnyTitle",to:t(C).CREATE_COMPANIES.path},null,8,["to"]),t(u)&&((h=t(o))!=null&&h.count)?(c(),v(i,{key:0,headers:D.value,table:(b=t(o))==null?void 0:b.organizations,to:t(C).UPDATE_COMPANIES.name,options:{page:t(r),limit:t(l)},onOnActionDelete:B},null,8,["headers","table","to","options"])):m("",!0),T(Q,{count:(z=t(o))==null?void 0:z.count,isSucces:t(u)},null,8,["count","isSucces"]),t(E)?(c(),v(x,{key:1})):m("",!0),t(u)&&!((S=t(o))!=null&&S.count)||t(I)?(c(),w("div",Y,V(e.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{ie as default};
