import{u as W,a as X,r as p,y as b,c as j,x as J,b as $,d as B,f as N,B as g,w as Y,F as w,e as F,k as i,g as Z,C as ee,h as f,o as m,i as y,t as _,z as K,A as q}from"./index-Lv7ic83i.js";import{u as ae,r as h}from"./i18n-validators-8szgixBa.js";import{a as oe,u as se}from"./generic.services-CPrETf56.js";import{u as z}from"./useQuery-lDv7UXdT.js";import{a as te,u as re}from"./crud.services-33u2viHl.js";import{b as ne}from"./manual.services-myeRcQdP.js";const le={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},_e={__name:"update",async setup(de){let s,c;const E=oe(),S=Z(),C=ee();W(),X();const v=p(C.params.id),{data:k,isSuccess:L,isLoading:T}=([s,c]=b(()=>z({queryKey:["states"],queryFn:()=>ne()})),s=await s,c(),s),o=p({id:"",fullName:"",organizationId:"",stateId:""}),M=j(()=>({id:{required:h},fullName:{required:h},organizationId:{required:h},stateId:{required:h}})),t=ae(M,o),Q=p([{id:1,model:"fullName",label:"nameExpensesLabel",placeholder:"nameExpensesPlaceholder",icon:"input-company",errorKey:"fullName"}]),U=p([{id:1,model:"stateId",label:"stateExpensesLabel",options:k,success:L,loading:T}]),{isError:A}=([s,c]=b(()=>z({queryKey:["expensesById",v],queryFn:()=>te("cost",v.value),select:a=>{o.value.id=a.id,o.value.fullName=a.fullname,o.value.organizationId=a.organizationId,o.value.stateId=a.stateId}})),s=await s,c(),s);J(A,a=>{a&&S.push(q.HOME.path)});const{mutate:H}=se({mutationFn:a=>re("cost",a),onSuccess:()=>{E.invalidateQueries({queryKey:["expenses"]}),E.invalidateQueries({queryKey:["expensesById",v]}),S.push(q.EXPENSES.path)}}),P=async()=>{const a=localStorage.getItem("organizationId");o.value.organizationId=a,t.value.$validate(),!t.value.$errors.length&&(H(o.value),t.value.$reset())};return(a,ie)=>{var x,V;const R=f("Title"),D=f("FormInput"),G=f("FormSelect"),O=f("CustomButton");return m(),$("section",le,[B("div",ue,[N(R,null,{default:g(()=>[y(`\r
                `+_(a.$t("editExpensesTitle"))+`\r
            `,1)]),_:1}),B("form",{class:"manage__form form-manage",onSubmit:Y(P,["prevent"])},[(m(!0),$(w,null,F(Q.value,e=>{var r,n,l,u,d;return m(),K(D,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":I=>o.value[e.model]=I,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(n=(r=i(t))==null?void 0:r[e==null?void 0:e.errorKey])==null?void 0:n.$error,textError:(d=(u=(l=i(t))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:d.$message},{default:g(()=>[y(_(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(m(!0),$(w,null,F(U.value,e=>{var r,n,l,u,d;return m(),K(G,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":I=>o.value[e.model]=I,width:500,options:e.options,error:(n=(r=i(t))==null?void 0:r[e==null?void 0:e.errorKey])==null?void 0:n.$error,textError:(d=(u=(l=i(t))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:d.$message,success:e.success,loading:e.loading},{default:g(()=>[y(_(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),N(O,{className:`form__submit ${(V=(x=i(t))==null?void 0:x.stateId.$errors[0])!=null&&V.$message?"centered":""}`},{default:g(()=>[y(_(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{_e as default};
//# sourceMappingURL=update--Tvi8a06.js.map
