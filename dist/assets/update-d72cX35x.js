import{u as W,a as j,r as p,y as b,c as J,x as X,b as S,d as w,f as q,B as _,w as Y,F as C,e as F,k as i,g as Z,C as ee,h as g,o as m,i as y,t as f,z,A as P}from"./index-8-F5s4j3.js";import{u as ae,r as h}from"./i18n-validators-72j1n4q8.js";import{a as oe,u as re}from"./generic.services-CQjHStj7.js";import{u as E}from"./useQuery-KERFi8ks.js";import{a as te,u as se}from"./crud.services-Xs683v05.js";import{b as ne}from"./manual.services-4pjALTqx.js";const le={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},fe={__name:"update",async setup(de){let r,c;const I=oe(),V=Z(),k=ee();W(),j();const v=p(k.params.id),{data:T,isSuccess:x,isLoading:L}=([r,c]=b(()=>E({queryKey:["states"],queryFn:()=>ne()})),r=await r,c(),r),o=p({id:"",fullname:"",organizationId:"",stateId:[]}),M=J(()=>({id:{required:h},fullname:{required:h},organizationId:{required:h},stateId:{required:h}})),t=ae(M,o),N=p([{id:1,model:"fullname",label:"nameProductsLabel",placeholder:"nameProductsPlaceholder",icon:"pen",errorKey:"fullname"}]),Q=p([{id:1,model:"stateId",label:"stateProductsLabel",placeholder:"stateProductsPlaceholder",errorKey:"stateId",options:T,success:x,loading:L}]),{isError:U}=([r,c]=b(()=>E({queryKey:["productsById",v],queryFn:()=>te("construction_material",v.value),select:a=>{o.value.id=a.id,o.value.fullname=a.fullname,o.value.organizationId=a.organizationId,o.value.stateId=[a.stateId]}})),r=await r,c(),r);X(U,a=>{a&&V.push(P.HOME.path)});const{mutate:R}=re({onMutate:a=>{a.stateId=a.stateId[0]},mutationFn:a=>se("construction_material",a),onSuccess:()=>{I.invalidateQueries({queryKey:["products"]}),I.invalidateQueries({queryKey:["productsById",v]}),I.invalidateQueries({queryKey:["materials"]}),V.push(P.PRODUCTS.path)}}),A=async()=>{const a=localStorage.getItem("organizationId");o.value.organizationId=a,t.value.$validate(),!t.value.$errors.length&&(R(o.value),t.value.$reset())};return(a,ie)=>{var B,K;const D=g("Title"),H=g("FormInput"),O=g("FormSelect"),G=g("CustomButton");return m(),S("section",le,[w("div",ue,[q(D,null,{default:_(()=>[y(`\r
                `+f(a.$t("editProductTitle"))+`\r
            `,1)]),_:1}),w("form",{class:"manage__form form-manage",onSubmit:Y(A,["prevent"])},[(m(!0),S(C,null,F(N.value,e=>{var s,n,l,u,d;return m(),z(H,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":$=>o.value[e.model]=$,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(n=(s=i(t))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,textError:(d=(u=(l=i(t))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:d.$message},{default:_(()=>[y(f(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(m(!0),S(C,null,F(Q.value,e=>{var s,n,l,u,d;return m(),z(O,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":$=>o.value[e.model]=$,width:500,options:e.options,error:(n=(s=i(t))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(d=(u=(l=i(t))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:d.$message,success:e.success,loading:e.loading},{default:_(()=>[y(f(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),q(G,{className:`form__submit ${(K=(B=i(t))==null?void 0:B.stateId.$errors[0])!=null&&K.$message?"centered":""}`},{default:_(()=>[y(f(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{fe as default};
//# sourceMappingURL=update-d72cX35x.js.map
