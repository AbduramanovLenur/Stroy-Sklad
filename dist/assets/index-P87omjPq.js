import{q as V,s as x,r,x as z,y as F,z as H,d as v,e as R,k as B,h as e,A as w,i as d,t as M,m as a,o as n,B as T}from"./index-8f2nY-tA.js";import{a as j,u as U}from"./generic.services-2-3LJT-B.js";import{u as W}from"./useQuery-eGcy0OjN.js";import{g as $,d as G}from"./crud.services-swolhUoO.js";import{r as J}from"./index-N_tz-29j.js";const X={class:"blocks"},Y={class:"blocks__inner section-padding"},Z={key:2,class:"empty-table shadowed"},ce={__name:"index",async setup(ee){let o,u;const b=j(),m=V(),{setSearchValue:_,setPagePagination:C}=m,{page:c,limit:l,search:k}=x(m),A=r(localStorage.getItem("organizationId"));z(()=>{_("")}),F(k,()=>{C(1)});const p=r(""),y=J(k,500),P=r([{id:1,label:"blockName",width:225},{id:2,label:"blockObject",width:250},{id:4,label:"blockFloors",width:275},{id:5,label:"blockRooms",width:285},{id:6,label:"blockAddress",width:190},{id:7,label:"blockState"},{id:8,label:"blockAction"}]),{data:s,isLoading:q,isSuccess:i,isError:I}=([o,u]=H(()=>W({queryKey:["blocks",{page:c,limit:l,debouncedSearch:y,organizationId:A}],queryFn:()=>$("building_block",c.value,l.value,y.value)})),o=await o,u(),o),{mutate:D}=U({mutationFn:t=>G("building_block",t),onSuccess:()=>{b.invalidateQueries({queryKey:["blocks"]}),b.invalidateQueries({queryKey:["blocksById",p]})}}),E=async t=>{p.value=t,D(t)};return(t,g)=>{var h,S,f;const K=a("HeadPage"),L=a("Table"),O=a("Pagination"),N=a("Spinner");return n(),v("section",X,[R("div",Y,[B(K,{title:"blockTitle",to:e(T).CREATE_BLOCKS.path,onOnSearch:g[0]||(g[0]=Q=>e(_)(Q))},null,8,["to"]),e(i)&&((h=e(s))!=null&&h.count)?(n(),w(L,{key:0,headers:P.value,table:(S=e(s))==null?void 0:S.blocks,to:e(T).UPDATE_BLOCKS.name,options:{page:e(c),limit:e(l)},onOnActionDelete:E},null,8,["headers","table","to","options"])):d("",!0),B(O,{count:(f=e(s))==null?void 0:f.count,isSucces:e(i)},null,8,["count","isSucces"]),e(q)?(n(),w(N,{key:1})):d("",!0),e(i)&&!e(s).count||e(I)?(n(),v("div",Z,M(t.$t("emptyTableTitle")),1)):d("",!0)])])}}};export{ce as default};
//# sourceMappingURL=index-P87omjPq.js.map
