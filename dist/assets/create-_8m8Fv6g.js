import{u as G,a as J,y as K,r as _,c as W,b as y,d as S,f as V,k as s,w as X,F as O,e as w,B as b,g as Y,h as p,o as u,A as B,z as L,i as I,t as f}from"./index-lJf7jXP7.js";import{u as Z,r as m}from"./i18n-validators-uxPccHio.js";import{a as ee,u as re}from"./generic.services-Aa1SKJf_.js";import{u as C}from"./useQuery-aSnCbYw0.js";import{c as oe}from"./crud.services-puo1KH10.js";import{m as ae,a as te}from"./manual.services-vTvsoS9S.js";const se={class:"manage section-height shadowed"},ne={class:"manage__inner section-padding"},he={__name:"create",async setup(ie){let o,g;const v=ee(),F=Y();G(),J();const{data:q,isSuccess:E,isLoading:k}=([o,g]=K(()=>C({queryKey:["regions"],queryFn:()=>ae()})),o=await o,g(),o),{data:z,isSuccess:M,isLoading:N}=([o,g]=K(()=>C({queryKey:["districts"],queryFn:()=>te()})),o=await o,g(),o),t=_({name:"",address:"",organizationId:"",regionId:[],districtId:[]}),x=W(()=>({name:{required:m},address:{required:m},organizationId:{required:m},regionId:{required:m},districtId:{required:m}})),a=Z(x,t),T=_([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),D=_([{id:1,model:"regionId",label:"regionObjectLabel",placeholder:"regionObjectPlaceholder",errorKey:"regionId",options:q,success:E,loading:k},{id:2,model:"districtId",label:"districtObjectLabel",placeholder:"districtObjectPlaceholder",errorKey:"districtId",options:z,success:M,loading:N}]),{mutate:P}=re({onMutate:r=>{r.regionId=r.regionId[0],r.districtId=r.districtId[0]},mutationFn:r=>oe("building_object",r),onSuccess:()=>{v.invalidateQueries({queryKey:["objects"]}),v.invalidateQueries({queryKey:["objectsList"]}),F.push(B.OBJECTS.path)}}),Q=()=>{const r=localStorage.getItem("organizationId");t.value.organizationId=r,a.value.$validate(),!a.value.$errors.length&&(P(t.value),a.value.$reset())};return(r,de)=>{var $,j;const R=p("ManageHead"),U=p("FormInput"),H=p("FormSelect"),A=p("CustomButton");return u(),y("section",se,[S("div",ne,[V(R,{title:"addNewObjectTitle",to:s(B).OBJECTS.path},null,8,["to"]),S("form",{class:"manage__form form-manage",onSubmit:X(Q,["prevent"])},[(u(!0),y(O,null,w(T.value,e=>{var n,i,d,l,c;return u(),L(U,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":h=>t.value[e.model]=h,width:500,placeholder:r.$t(e.placeholder),name:e.icon,error:(i=(n=s(a))==null?void 0:n[e.errorKey])==null?void 0:i.$error,textError:(c=(l=(d=s(a))==null?void 0:d[e.errorKey])==null?void 0:l.$errors[0])==null?void 0:c.$message},{default:b(()=>[I(f(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(u(!0),y(O,null,w(D.value,e=>{var n,i,d,l,c;return u(),L(H,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":h=>t.value[e.model]=h,width:500,options:e.options,error:(i=(n=s(a))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:i.$error,placeholder:e==null?void 0:e.placeholder,textError:(c=(l=(d=s(a))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:b(()=>[I(f(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),V(A,{className:`form__submit ${(j=($=s(a))==null?void 0:$.districtId.$errors[0])!=null&&j.$message?"centered":""}`},{default:b(()=>[I(f(r.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{he as default};
//# sourceMappingURL=create-_8m8Fv6g.js.map
