import{n as V,s as x,r,q as F,x as H,y as R,b as B,d as M,f as T,k as e,z as C,l as d,t as j,h as a,o as n,A}from"./index-8-F5s4j3.js";import{a as U,u as W}from"./generic.services-CQjHStj7.js";import{u as $}from"./useQuery-KERFi8ks.js";import{g as G,d as J}from"./crud.services-Xs683v05.js";import{r as X}from"./index-stR_uWnS.js";const Y={class:"blocks"},Z={class:"blocks__inner section-padding"},ee={key:2,class:"empty-table shadowed"},le={__name:"index",async setup(te){let s,u;const b=U(),m=V(),{setSearchValue:p,setPagePagination:E}=m,{page:i,limit:l,search:_}=x(m),k=r(localStorage.getItem("organizationId"));F(()=>{p("")}),H(_,()=>{E(1)});const h=r(""),y=X(_,500),I=r([{id:1,label:"blockName",width:185},{id:2,label:"blockObject",width:205},{id:3,label:"blockOrganization",width:260},{id:4,label:"blockFloors",width:230},{id:5,label:"blockRooms",width:235},{id:6,label:"blockAddress",width:150},{id:7,label:"blockState",width:140},{id:8,label:"blockAction",width:125}]),{data:o,isLoading:P,isSuccess:c,isError:q}=([s,u]=R(()=>$({queryKey:["blocks",{page:i,limit:l,debouncedSearch:y,organizationId:k}],queryFn:()=>G("building_block",i.value,l.value,y.value,{organizationId:k.value})})),s=await s,u(),s),{mutate:O}=W({mutationFn:t=>J("building_block",t),onSuccess:()=>{b.invalidateQueries({queryKey:["blocks"]}),b.invalidateQueries({queryKey:["blocksById",h]})}}),z=async t=>{h.value=t,O(t)};return(t,g)=>{var S,f,w,v;const D=a("HeadPage"),K=a("Table"),L=a("Pagination"),N=a("Spinner");return n(),B("section",Y,[M("div",Z,[T(D,{title:"blockTitle",to:e(A).CREATE_BLOCKS.path,onOnSearch:g[0]||(g[0]=Q=>e(p)(Q))},null,8,["to"]),e(c)&&((S=e(o))!=null&&S.count)?(n(),C(K,{key:0,headers:I.value,table:(f=e(o))==null?void 0:f.blocks,to:e(A).UPDATE_BLOCKS.name,options:{page:e(i),limit:e(l)},onOnActionDelete:z},null,8,["headers","table","to","options"])):d("",!0),T(L,{count:(w=e(o))==null?void 0:w.count,isSucces:e(c),isEmpty:!!((v=e(o))!=null&&v.count)},null,8,["count","isSucces","isEmpty"]),e(P)?(n(),C(N,{key:1})):d("",!0),e(c)&&!e(o).count||e(q)?(n(),B("div",ee,j(t.$t("emptyTableTitle")),1)):d("",!0)])])}}};export{le as default};
//# sourceMappingURL=index-ZjZaMoEA.js.map
