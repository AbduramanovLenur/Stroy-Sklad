import{n as R,s as V,r as l,q as x,x as H,y as K,b as w,d as U,f as D,k as t,z as I,l as d,t as F,h as r,o as c,A as q}from"./index-VQIUi_yG.js";import{a as W,u as $}from"./generic.services-qeqkLGxM.js";import{u as j}from"./useQuery-p6XK-aiu.js";import{g as G,d as J}from"./crud.services-xidt0Eez.js";import{r as X}from"./index-3HKo3yQn.js";const Y={class:"products"},Z={class:"products__inner section-padding"},ee={key:2,class:"empty-table shadowed"},ce={__name:"index",async setup(te){let s,p;const m=W(),_=R(),{setSearchValue:y,setPagePagination:A}=_,{page:g,limit:h,search:S}=V(_),b=l(localStorage.getItem("organizationId"));x(()=>{y("")}),H(S,()=>{A(1)});const f=l(""),v=X(S,500),z=l([{id:1,label:"productsName",width:725},{id:4,label:"productsState",width:365},{id:5,label:"productsAction",width:440}]),{data:n,isLoading:B,isSuccess:i,isError:E}=([s,p]=K(()=>j({queryKey:["products",{page:g,limit:h,debouncedSearch:v,organizationId:b}],queryFn:()=>G("construction_material",g.value,h.value,v.value,{organizationId:b.value}),select:e=>{let o=[...e==null?void 0:e.constructionMaterial];return o=o.map(u=>{const a={...u};return delete a.organizationName,a}),{constructionMaterial:o,count:e==null?void 0:e.count}}})),s=await s,p(),s),{mutate:M}=$({mutationFn:e=>J("construction_material",e),onSuccess:()=>{m.invalidateQueries({queryKey:["products"]}),m.invalidateQueries({queryKey:["productsById",f]})}}),N=async e=>{f.value=e,M(e)};return(e,o)=>{var P,T,C,k;const u=r("HeadPage"),a=r("Table"),L=r("Pagination"),O=r("Spinner");return c(),w("section",Y,[U("div",Z,[D(u,{title:"productsTitle",to:t(q).CREATE_PRODUCTS.path,onOnSearch:o[0]||(o[0]=Q=>t(y)(Q))},null,8,["to"]),t(i)&&((P=t(n))!=null&&P.count)?(c(),I(a,{key:0,headers:z.value,table:(T=t(n))==null?void 0:T.constructionMaterial,to:t(q).UPDATE_PRODUCTS.name,onOnActionDelete:N},null,8,["headers","table","to"])):d("",!0),D(L,{count:(C=t(n))==null?void 0:C.count,isSucces:t(i)},null,8,["count","isSucces"]),t(B)?(c(),I(O,{key:1})):d("",!0),t(i)&&!((k=t(n))!=null&&k.count)||t(E)?(c(),w("div",ee,F(e.$t("emptyTableTitle")),1)):d("",!0)])])}}};export{ce as default};
//# sourceMappingURL=index-cdTIs_OU.js.map
