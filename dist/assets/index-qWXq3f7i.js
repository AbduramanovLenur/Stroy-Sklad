import{s as W,x as k,b as $,c as j,r as A,y as J,d as q,e as Y,k as L,h as e,z as X,i as a,t as Z,m as i,o as c,A as B,G as r}from"./index-sKMtYVf1.js";import{a as ee,u as se}from"./generic.services-Y9l1kbCB.js";import{u as te}from"./useQuery-oNoZrsai.js";import{g as oe,d as ne}from"./crud.services-OfzCCZDD.js";import{r as ae}from"./index-P9w-NFZG.js";const ie={key:0,class:"expenses"},ce={class:"expenses__inner section-padding"},re={key:2,class:"empty-table shadowed"},Ee={__name:"index",async setup(ue){let o,_;const u=ee(),I=W(),{page:l,limit:d,search:Q}=k(I),U=$(),{user:t}=k(U),E=j(()=>{var s,m;return!!((m=(s=t==null?void 0:t.value.user)==null?void 0:s.modules)!=null&&m.includes(r.EXPENS.READ))}),S=A(""),y=ae(Q,500),K=A([{id:1,label:"expensesName",width:635}]),{data:n,isLoading:R,isSuccess:p,isError:z}=([o,_]=J(()=>te({queryKey:["expenses",{page:l,limit:d,debouncedSearch:y,organizationId:t.value.user.organizationId}],queryFn:()=>oe("cost",l.value,d.value,y.value),enabled:E})),o=await o,_(),o),{mutate:H}=se({mutationFn:s=>ne("cost",s),onSuccess:()=>{u.invalidateQueries({queryKey:["expenses"]}),u.invalidateQueries({queryKey:["expensesById",S]}),u.invalidateQueries({queryKey:["costsList"]})}}),V=async s=>{S.value=s,H(s)};return(s,m)=>{var h,g,v,x,b,P,T,f,w,D,N,C;const F=i("HeadPage"),M=i("Table"),G=i("Pagination"),O=i("Spinner");return E.value?(c(),q("section",ie,[Y("div",ce,[L(F,{title:"expensesTitle",to:e(B).CREATE_EXPENS.path,isShowCreate:(v=(g=(h=e(t))==null?void 0:h.user)==null?void 0:g.modules)==null?void 0:v.includes(e(r).EXPENS.CREATE)},null,8,["to","isShowCreate"]),e(p)&&((x=e(n))!=null&&x.count)?(c(),X(M,{key:0,headers:K.value,table:(b=e(n))==null?void 0:b.cost,to:e(B).UPDATE_EXPENS.name,options:{page:e(l),limit:e(d)},isShowUpdate:(f=(T=(P=e(t))==null?void 0:P.user)==null?void 0:T.modules)==null?void 0:f.includes(e(r).EXPENS.UPDATE),isShowDelete:(N=(D=(w=e(t))==null?void 0:w.user)==null?void 0:D.modules)==null?void 0:N.includes(e(r).EXPENS.DELETE),onOnActionDelete:V},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):a("",!0),L(G,{count:(C=e(n))==null?void 0:C.count,isSucces:e(p)},null,8,["count","isSucces"]),e(R)?(c(),X(O,{key:1})):a("",!0),e(p)&&!e(n).count||e(z)?(c(),q("div",re,Z(s.$t("emptyTableTitle")),1)):a("",!0)])])):a("",!0)}}};export{Ee as default};
//# sourceMappingURL=index-qWXq3f7i.js.map
