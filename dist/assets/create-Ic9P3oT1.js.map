{"version":3,"file":"create-Ic9P3oT1.js","sources":["../../src/views/cost/create.vue"],"sourcesContent":["<template>\r\n    <section class=\"manage section-height shadowed\" v-if=\"isShow\">\r\n        <div class=\"manage__inner section-padding\">\r\n            <ManageHead \r\n                title=\"addNewExpensesTitle\" \r\n                :to=\"routes.EXPENS.path\"\r\n            />\r\n            <form class=\"manage__form form-manage\" @submit.prevent=\"submitHandler\">\r\n                <FormInput \r\n                    v-for=\"input in inputs\"\r\n                    :key=\"input.id\"\r\n                    v-model=\"state[input.model]\"\r\n                    :width=\"500\" \r\n                    :placeholder=\"$t(input.placeholder)\"\r\n                    :name=\"input.icon\"\r\n                    :error=\"v$?.[input.errorKey]?.$error\" \r\n                    :textError=\"v$?.[input.errorKey]?.$errors[0]?.$message\"\r\n                >\r\n                    {{ $t(input.label) }}\r\n                </FormInput>\r\n                <CustomButton \r\n                    :className=\"`form__submit ${v$?.fullName.$errors[0]?.$message ? 'centered' : ''}`\"\r\n                >\r\n                    {{ $t(\"formButton\") }}\r\n                </CustomButton>\r\n            </form>\r\n        </div>\r\n    </section>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { storeToRefs } from \"pinia\";\r\nimport { useUserStore } from \"@/store/userStore\";\r\nimport { useVuelidate } from \"@vuelidate/core\";\r\nimport { useToast } from \"vue-toastification\";\r\nimport { useI18n } from \"vue-i18n\";\r\nimport { required } from \"@/utils/i18n-validators.js\";\r\nimport { useQueryClient, useMutation } from \"@tanstack/vue-query\";\r\nimport { create } from \"@/services/crud.services.js\";\r\nimport { routes } from \"@/utils/routes.js\";\r\nimport { actionModules } from \"@/utils/action-modules.js\";\r\n\r\nconst queryClient = useQueryClient();\r\nconst router = useRouter();\r\nconst toast = useToast();\r\nconst { t } = useI18n();\r\n\r\nconst userStore = useUserStore();\r\nconst { user } = storeToRefs(userStore);\r\n\r\nconst isShow = computed(() => !!user?.value.user?.modules?.includes(actionModules.EXPENS.CREATE));\r\n\r\nconst state = ref({\r\n    fullName: \"\",\r\n});\r\n\r\nconst rules = computed(() => ({\r\n    fullName: { required },\r\n}));\r\n\r\nconst v$ = useVuelidate(rules, state);\r\n\r\nconst inputs = ref([\r\n    { \r\n        id: 1, \r\n        model: \"fullName\", \r\n        label: \"nameExpensesLabel\", \r\n        placeholder: \"nameExpensesPlaceholder\", \r\n        icon: \"input-company\",\r\n        errorKey: \"fullName\",\r\n    }\r\n]);\r\n\r\nconst { mutate: createMutate } = useMutation({\r\n    mutationFn: (body) => create(\"cost\", body),\r\n    onSuccess: () => {\r\n        queryClient.invalidateQueries({ queryKey: [\"expenses\"] });\r\n        queryClient.invalidateQueries({ queryKey: [\"costsList\"] });\r\n        \r\n        router.push(routes.EXPENS.path);\r\n    }\r\n});\r\n\r\nconst submitHandler = () => {\r\n    v$.value.$validate();\r\n\r\n    if (v$.value.$errors.length) {\r\n        return;\r\n    }\r\n\r\n    createMutate(state.value);\r\n    v$.value.$reset();\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>"],"names":["queryClient","useQueryClient","router","useRouter","useToast","useI18n","userStore","useUserStore","user","storeToRefs","isShow","computed","_b","_a","actionModules","state","ref","rules","required","v$","useVuelidate","inputs","createMutate","useMutation","body","create","routes","submitHandler"],"mappings":"2dA4CA,MAAMA,EAAcC,EAAc,EAC5BC,EAASC,EAAS,EACVC,EAAW,EACXC,EAAU,EAExB,MAAMC,EAAYC,EAAY,EACxB,CAAE,KAAAC,CAAM,EAAGC,EAAYH,CAAS,EAEhCI,EAASC,EAAS,IAAA,SAAM,OAAC,GAACC,GAAAC,EAAAL,GAAA,YAAAA,EAAM,MAAM,OAAZ,YAAAK,EAAkB,UAAlB,MAAAD,EAA2B,SAASE,EAAc,OAAO,SAAO,EAE1FC,EAAQC,EAAI,CACd,SAAU,EACd,CAAC,EAEKC,EAAQN,EAAS,KAAO,CAC1B,SAAU,CAAE,SAAAO,CAAU,CAC1B,EAAE,EAEIC,EAAKC,EAAaH,EAAOF,CAAK,EAE9BM,EAASL,EAAI,CACf,CACI,GAAI,EACJ,MAAO,WACP,MAAO,oBACP,YAAa,0BACb,KAAM,gBACN,SAAU,UACb,CACL,CAAC,EAEK,CAAE,OAAQM,CAAc,EAAGC,EAAY,CACzC,WAAaC,GAASC,EAAO,OAAQD,CAAI,EACzC,UAAW,IAAM,CACbxB,EAAY,kBAAkB,CAAE,SAAU,CAAC,UAAU,CAAG,CAAA,EACxDA,EAAY,kBAAkB,CAAE,SAAU,CAAC,WAAW,CAAG,CAAA,EAEzDE,EAAO,KAAKwB,EAAO,OAAO,IAAI,CACjC,CACL,CAAC,EAEKC,EAAgB,IAAM,CACxBR,EAAG,MAAM,YAEL,CAAAA,EAAG,MAAM,QAAQ,SAIrBG,EAAaP,EAAM,KAAK,EACxBI,EAAG,MAAM,SACb"}