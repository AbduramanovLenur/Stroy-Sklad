import{u as ee,a as oe,r as g,x as y,c as se,B as re,b as k,d as L,f as S,A as p,w as ae,F as q,e as V,k as m,g as le,C as te,h as f,o as b,i as I,t as _,y as w,z as C}from"./index-_BFdtwee.js";import{u as de,r as t}from"./i18n-validators-l5daMbf8.js";import{a as ne,u as ie}from"./generic.services-_wmr52k_.js";import{u as h}from"./useQuery-pyMv0qYl.js";import{a as ue,u as ce}from"./crud.services-oazsYCL2.js";import{m as me,a as be,b as ge}from"./manual.services-vAJaRngc.js";const ye={class:"manage section-height"},pe={class:"manage__inner section-padding"},Oe={__name:"update",async setup(fe){let s,a;const K=ne(),O=le(),N=te();ee(),oe();const v=g(N.params.id),{data:E,isSuccess:R,isLoading:j}=([s,a]=y(()=>h({queryKey:["regions"],queryFn:()=>me()})),s=await s,a(),s),{data:x,isSuccess:T,isLoading:A}=([s,a]=y(()=>h({queryKey:["districts"],queryFn:()=>be()})),s=await s,a(),s),{data:D,isSuccess:M,isLoading:P}=([s,a]=y(()=>h({queryKey:["states"],queryFn:()=>ge()})),s=await s,a(),s),r=g({id:"",fullname:"",numberOfFloors:"",roomsOnFloor:"",address:"",buildingObjectId:1,regionId:"",districtId:"",stateId:""}),Q=se(()=>({id:{required:t},fullname:{required:t},numberOfFloors:{required:t},roomsOnFloor:{required:t},address:{required:t},regionId:{required:t},districtId:{required:t},stateId:{required:t}})),l=de(Q,r),U=g([{id:1,model:"fullname",label:"blocksFullNameLabel",placeholder:"blocksFullNamePlaceholder",icon:"input-company",errorKey:"fullname"},{id:2,model:"numberOfFloors",label:"blocksNumberLabel",placeholder:"blocksNumberPlaceholder",icon:"signature",errorKey:"numberOfFloors"},{id:3,model:"roomsOnFloor",label:"blocksRoomsLabel",placeholder:"blocksRoomsPlaceholder",icon:"door",errorKey:"roomsOnFloor"},{id:4,model:"address",label:"blocksAddressLabel",placeholder:"blocksAddressPlaceholder",icon:"address",errorKey:"address"}]),G=g([{id:1,model:"buildingObjectId",label:"buildIdBlocksLabel",options:[],errorKey:"buildingObjectId",success:!0,loading:!1},{id:2,model:"regionId",label:"regionBlocksLabel",options:E,errorKey:"regionId",success:R,loading:j},{id:3,model:"districtId",label:"districtBlocksLabel",options:x,errorKey:"districtId",success:T,loading:A},{id:4,model:"stateId",label:"stateBlocksLabel",options:D,success:M,loading:P,errorKey:"stateId"}]),{isError:H}=([s,a]=y(()=>h({queryKey:["blocksById",v],queryFn:()=>ue("building_block",v.value),select:o=>{r.value.id=o.id,r.value.fullname=o.fullname,r.value.numberOfFloors=o.numberOfFloors,r.value.roomsOnFloor=o.roomsOnFloor,r.value.address=o.address,r.value.buildingObjectId=o.buildingObjectId,r.value.regionId=o.regionId,r.value.districtId=o.districtId,r.value.stateId=o.stateId}})),s=await s,a(),s);re(H,o=>{o&&O.push(C.HOME.path)});const{mutate:z}=ie({mutationFn:o=>ce("building_block",o),onSuccess:()=>{K.invalidateQueries({queryKey:["blocks"]}),K.invalidateQueries({queryKey:["blocksById",v]}),O.push(C.BLOCKS.path)}}),W=async()=>{l.value.$validate(),!l.value.$errors.length&&(z(r.value),l.value.$reset())};return(o,Ie)=>{var $,B;const J=f("Title"),X=f("FormInput"),Y=f("FormSelect"),Z=f("CustomButton");return b(),k("section",ye,[L("div",pe,[S(J,null,{default:p(()=>[I(`\r
                `+_(o.$t("editCompanyTitle"))+`\r
            `,1)]),_:1}),L("form",{class:"manage__form form-manage",onSubmit:ae(W,["prevent"])},[(b(!0),k(q,null,V(U.value,e=>{var d,n,i,u,c;return b(),w(X,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":F=>r.value[e.model]=F,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(n=(d=m(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:n.$error,textError:(c=(u=(i=m(l))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message},{default:p(()=>[I(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(b(!0),k(q,null,V(G.value,e=>{var d,n,i,u,c;return b(),w(Y,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":F=>r.value[e.model]=F,width:500,options:e.options,error:(n=(d=m(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:n.$error,textError:(c=(u=(i=m(l))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:p(()=>[I(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),S(Z,{className:`form__submit ${(B=($=m(l))==null?void 0:$.stateId.$errors[0])!=null&&B.$message?"centered":""}`},{default:p(()=>[I(_(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Oe as default};
//# sourceMappingURL=update-d_YYlWpL.js.map
