import{u as ee,a as ae,r as y,n as b,c as se,y as oe,b as S,d as V,f as w,x as p,w as re,F as B,e as F,k as m,g as te,z as ne,h as I,o as g,i as _,t as v,q as O,s as z}from"./index-uEOOChHm.js";import{u as ie,r as n}from"./i18n-validators-Zycmru6O.js";import{a as de,u as le}from"./generic.services-zAUdS-UM.js";import{u as h,a as ue,b as ce}from"./crud.services-AVFHJS4I.js";import{m as me,a as ge,b as ye}from"./manual.services-OPim9ts4.js";const be={class:"manage section-height"},pe={class:"manage__inner section-padding"},Ke={__name:"update",async setup(Ie){let s,r;const K=de(),j=te(),C=ne();ee(),ae();const f=y(C.params.id),{data:E,isSuccess:k,isLoading:T}=([s,r]=b(()=>h({queryKey:["regions"],queryFn:()=>me()})),s=await s,r(),s),{data:x,isSuccess:N,isLoading:R}=([s,r]=b(()=>h({queryKey:["districts"],queryFn:()=>ge()})),s=await s,r(),s),{data:D,isSuccess:M,isLoading:Q}=([s,r]=b(()=>h({queryKey:["states"],queryFn:()=>ye()})),s=await s,r(),s),o=y({id:"",name:"",address:"",organizationId:"",regionId:"",districtId:"",stateId:""}),U=se(()=>({id:{required:n},name:{required:n},address:{required:n},organizationId:{required:n},regionId:{required:n},districtId:{required:n},stateId:{required:n}})),t=ie(U,o),G=y([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),H=y([{id:1,model:"regionId",label:"regionObjectLabel",options:E,errorKey:"regionId",success:k,loading:T},{id:2,model:"districtId",label:"districtObjectLabel",options:x,errorKey:"districtId",success:N,loading:R},{id:3,model:"stateId",label:"stateObjectLabel",options:D,success:M,loading:Q}]),{isError:P}=([s,r]=b(()=>h({queryKey:["objectById",f],queryFn:()=>ue("building_object",f.value),select:a=>{o.value.id=a.id,o.value.name=a.fullname,o.value.organizationId=a.organizationId,o.value.regionId=a.regionId,o.value.districtId=a.districtId,o.value.address=a.address,o.value.stateId=a.stateId}})),s=await s,r(),s);oe(P,a=>{a&&j.push(z.HOME.path)});const{mutate:A}=le({mutationFn:a=>ce("building_object",a),onSuccess:()=>{K.invalidateQueries({queryKey:["objects"]}),K.invalidateQueries({queryKey:["objectById",f]}),j.push(z.OBJECTS.path)}}),J=async()=>{o.value.organizationId=1,t.value.$validate(),!t.value.$errors.length&&(A(o.value),t.value.$reset())};return(a,_e)=>{var q,L;const W=I("Title"),X=I("FormInput"),Y=I("FormSelect"),Z=I("CustomButton");return g(),S("section",be,[V("div",pe,[w(W,null,{default:p(()=>[_(`\r
                `+v(a.$t("editObjectTitle"))+`\r
            `,1)]),_:1}),V("form",{class:"manage__form form-manage",onSubmit:re(J,["prevent"])},[(g(!0),S(B,null,F(G.value,e=>{var i,d,l,u,c;return g(),O(X,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":$=>o.value[e.model]=$,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(d=(i=m(t))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(t))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message},{default:p(()=>[_(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(g(!0),S(B,null,F(H.value,e=>{var i,d,l,u,c;return g(),O(Y,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":$=>o.value[e.model]=$,width:500,options:e.options,error:(d=(i=m(t))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(t))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:p(()=>[_(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),w(Z,{className:`form__submit ${(L=(q=m(t))==null?void 0:q.stateId.$errors[0])!=null&&L.$message?"centered":""}`},{default:p(()=>[_(v(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Ke as default};
//# sourceMappingURL=update-TgDbbgpz.js.map
