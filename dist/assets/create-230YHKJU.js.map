{"version":3,"file":"create-230YHKJU.js","sources":["../../src/views/employees/create.vue"],"sourcesContent":["<template>\r\n    <section class=\"manage section-height\">\r\n        <div class=\"manage__inner section-padding\">\r\n            <Title>\r\n                {{ $t(\"addNewEmployeesTitle\") }}\r\n            </Title>\r\n            <form class=\"manage__form form-manage\" @submit.prevent=\"submitHandler\">\r\n                <FormInput \r\n                    v-for=\"input in inputs\"\r\n                    :key=\"input.id\"\r\n                    v-model=\"state[input.model]\"\r\n                    :width=\"500\" \r\n                    :placeholder=\"$t(input.placeholder)\"\r\n                    :name=\"input.icon\"\r\n                    :error=\"v$?.[input.errorKey]?.$error\" \r\n                    :textError=\"v$?.[input.errorKey]?.$errors[0]?.$message\"\r\n                >\r\n                    {{ $t(input.label) }}\r\n                </FormInput>\r\n                <FormSelect \r\n                    v-for=\"select in selects\"\r\n                    :key=\"select.id\"\r\n                    v-model=\"state[select.model]\" \r\n                    :width=\"500\" \r\n                    :options=\"select.options\"\r\n                    :error=\"v$?.[select?.errorKey]?.$error\" \r\n                    :textError=\"v$?.[select?.errorKey]?.$errors[0]?.$message\"\r\n                    :success=\"select.success\"\r\n                    :loading=\"select.loading\"\r\n                >\r\n                    {{ $t(select.label) }}\r\n                </FormSelect>\r\n                <CustomButton \r\n                    :className=\"`form__submit ${v$?.roleId.$errors[0]?.$message ? 'centered' : ''}`\"\r\n                >\r\n                    {{ $t(\"formButton\") }}\r\n                </CustomButton>\r\n            </form>\r\n        </div>\r\n    </section>\r\n</template>\r\n\r\n<script setup>\r\nimport { ref, computed } from \"vue\";\r\nimport { useRouter } from \"vue-router\";\r\nimport { useVuelidate } from \"@vuelidate/core\";\r\nimport { useToast } from \"vue-toastification\";\r\nimport { useI18n } from \"vue-i18n\";\r\nimport { required, minLength } from \"@/utils/i18n-validators.js\";\r\nimport { useQueryClient, useQuery, useMutation } from \"@tanstack/vue-query\";\r\nimport { create } from \"@/services/crud.services.js\";\r\nimport { manualGetOrganizations, manualGetRoles } from \"@/services/manual.services.js\";\r\nimport { routes } from \"@/utils/routes.js\";\r\n\r\nconst queryClient = useQueryClient();\r\nconst router = useRouter();\r\nconst toast = useToast();\r\nconst { t } = useI18n();\r\n\r\nconst {\r\n    data: organizations,\r\n    isSuccess: isSuccessOrganizations,\r\n    isLoading: isLoadingOrganizations\r\n} = await useQuery({\r\n    queryKey: [\"organizations\"],\r\n    queryFn: () => manualGetOrganizations()\r\n});\r\n\r\nconst {\r\n    data: roles,\r\n    isSuccess: isSuccessRoles,\r\n    isLoading: isLoadingRoles\r\n} = await useQuery({\r\n    queryKey: [\"roles\"],\r\n    queryFn: () => manualGetRoles()\r\n});\r\n\r\nconst state = ref({\r\n    fullName: \"\",\r\n    userName: \"\",\r\n    password: \"\",\r\n    phoneNumber: \"\",\r\n    organizationId: \"\",\r\n    roleId: \"\",\r\n});\r\n\r\nconst rules = computed(() => ({\r\n    fullName: { required },\r\n    userName: { required },\r\n    password: { required, minLength },\r\n    phoneNumber: { required },\r\n    organizationId: { required },\r\n    roleId: { required },\r\n}));\r\n\r\nconst v$ = useVuelidate(rules, state);\r\n\r\nconst inputs = ref([\r\n    { \r\n        id: 1, \r\n        model: \"fullName\", \r\n        label: \"employeesFullNameLabel\", \r\n        placeholder: \"employeesFullNamePlaceholder\", \r\n        icon: \"person\", \r\n        errorKey: \"fullName\",\r\n    },\r\n    { \r\n        id: 2, \r\n        model: \"userName\", \r\n        label: \"employeesLoginLabel\", \r\n        placeholder: \"employeesLoginPlaceholder\", \r\n        icon: \"login\", \r\n        errorKey: \"userName\",\r\n    },\r\n    { \r\n        id: 3, \r\n        model: \"password\", \r\n        label: \"employeesPasswordLabel\", \r\n        placeholder: \"employeesPasswordPlaceholder\", \r\n        icon: \"password\", \r\n        errorKey: \"password\",\r\n    },\r\n    { \r\n        id: 4, \r\n        model: \"phoneNumber\", \r\n        label: \"employeesPhoneLabel\",\r\n        placeholder: \"employeesPhonePlaceholder\", \r\n        icon: \"phone\", \r\n        errorKey: \"phoneNumber\",\r\n    }\r\n]);\r\n\r\nconst selects = ref([\r\n    { \r\n        id: 1, \r\n        model: \"organizationId\", \r\n        label: \"employeesOrganizationLabel\", \r\n        options: organizations, \r\n        errorKey: \"organizationId\",\r\n        success: isSuccessOrganizations,\r\n        loading: isLoadingOrganizations\r\n    },\r\n    { \r\n        id: 2, \r\n        model: \"roleId\", \r\n        label: \"employeesRoleLabel\", \r\n        options: roles, \r\n        errorKey: \"roleId\", \r\n        success: isSuccessRoles,\r\n        loading: isLoadingRoles\r\n    },\r\n]);\r\n\r\nconst { mutate: createMutate } = useMutation({\r\n    mutationFn: (body) => create(\"user\", body),\r\n    onSuccess: () => {\r\n        queryClient.invalidateQueries({ queryKey: [\"employees\"] });\r\n        router.push(routes.EMPLOYEES.path);\r\n    }\r\n});\r\n\r\nconst submitHandler = () => {\r\n    v$.value.$validate();\r\n\r\n    if (v$.value.$errors.length) {\r\n        return;\r\n    }\r\n\r\n    createMutate(state.value);\r\n    v$.value.$reset();\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped></style>"],"names":["queryClient","useQueryClient","router","useRouter","useToast","useI18n","organizations","isSuccessOrganizations","isLoadingOrganizations","__temp","__restore","_withAsyncContext","useQuery","manualGetOrganizations","roles","isSuccessRoles","isLoadingRoles","manualGetRoles","state","ref","rules","computed","required","minLength","v$","useVuelidate","inputs","selects","createMutate","useMutation","body","create","routes","submitHandler"],"mappings":"6hBAsDA,MAAMA,EAAcC,GAAc,EAC5BC,EAASC,EAAS,EACVC,EAAW,EACXC,EAAU,EAExB,KAAM,CACF,KAAMC,EACN,UAAWC,EACX,UAAWC,CACf,GAAU,CAAAC,EAAAC,CAAA,EAAAC,EAAA,IAAAC,EAAS,CACf,SAAU,CAAC,eAAe,EAC1B,QAAS,IAAMC,GAAwB,CAC3C,CAAC,CAAA,mBAEK,CACF,KAAMC,EACN,UAAWC,EACX,UAAWC,CACf,GAAU,CAAAP,EAAAC,CAAA,EAAAC,EAAA,IAAAC,EAAS,CACf,SAAU,CAAC,OAAO,EAClB,QAAS,IAAMK,GAAgB,CACnC,CAAC,CAAA,mBAEKC,EAAQC,EAAI,CACd,SAAU,GACV,SAAU,GACV,SAAU,GACV,YAAa,GACb,eAAgB,GAChB,OAAQ,EACZ,CAAC,EAEKC,EAAQC,EAAS,KAAO,CAC1B,SAAU,CAAE,SAAAC,CAAU,EACtB,SAAU,CAAE,SAAAA,CAAU,EACtB,SAAU,CAAE,SAAAA,EAAU,UAAAC,EAAW,EACjC,YAAa,CAAE,SAAAD,CAAU,EACzB,eAAgB,CAAE,SAAAA,CAAU,EAC5B,OAAQ,CAAE,SAAAA,CAAU,CACxB,EAAE,EAEIE,EAAKC,EAAaL,EAAOF,CAAK,EAE9BQ,EAASP,EAAI,CACf,CACI,GAAI,EACJ,MAAO,WACP,MAAO,yBACP,YAAa,+BACb,KAAM,SACN,SAAU,UACb,EACD,CACI,GAAI,EACJ,MAAO,WACP,MAAO,sBACP,YAAa,4BACb,KAAM,QACN,SAAU,UACb,EACD,CACI,GAAI,EACJ,MAAO,WACP,MAAO,yBACP,YAAa,+BACb,KAAM,WACN,SAAU,UACb,EACD,CACI,GAAI,EACJ,MAAO,cACP,MAAO,sBACP,YAAa,4BACb,KAAM,QACN,SAAU,aACb,CACL,CAAC,EAEKQ,EAAUR,EAAI,CAChB,CACI,GAAI,EACJ,MAAO,iBACP,MAAO,6BACP,QAASb,EACT,SAAU,iBACV,QAASC,EACT,QAASC,CACZ,EACD,CACI,GAAI,EACJ,MAAO,SACP,MAAO,qBACP,QAASM,EACT,SAAU,SACV,QAASC,EACT,QAASC,CACZ,CACL,CAAC,EAEK,CAAE,OAAQY,CAAc,EAAGC,GAAY,CACzC,WAAaC,GAASC,GAAO,OAAQD,CAAI,EACzC,UAAW,IAAM,CACb9B,EAAY,kBAAkB,CAAE,SAAU,CAAC,WAAW,CAAG,CAAA,EACzDE,EAAO,KAAK8B,EAAO,UAAU,IAAI,CACpC,CACL,CAAC,EAEKC,EAAgB,IAAM,CACxBT,EAAG,MAAM,YAEL,CAAAA,EAAG,MAAM,QAAQ,SAIrBI,EAAaV,EAAM,KAAK,EACxBM,EAAG,MAAM,SACb;;"}