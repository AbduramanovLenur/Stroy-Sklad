import{u as Y,a as Z,x as ee,y as q,b as te,c as se,r as B,z as ae,d as O,e as oe,k as I,A as ne,h as e,B as N,i,t as P,m as c,o as l,f as ue,s as L,H as d}from"./index-KYHZIXyW.js";import{u as re}from"./generic.services-YA4lnf9v.js";import{u as ie}from"./useQuery-lv7mhtLD.js";import{u as ce}from"./useMutation-7roH085H.js";import{g as le,d as de}from"./crud.services-K83EyEdH.js";import{r as he}from"./index-8AE77Je2.js";const me={key:0,class:"warehouse"},pe={class:"warehouse__inner section-padding"},ye={key:2,class:"empty-table shadowed"},ge={__name:"index",async setup(_e){let n,y;const _=re(),Q=Y(),{t:V}=Z(),x=ee(),{page:h,limit:m,search:z}=q(x),K=te(),{user:s}=q(K),w=se(()=>{var t,a;return!!((a=(t=s==null?void 0:s.value.user)==null?void 0:t.modules)!=null&&a.includes(d.WAREHOUSE.READ))}),S=B(""),E=he(z,500),F=B([{id:1,label:"warehouseName",width:35},{id:2,label:"warehouseQuantity",width:20}]),{data:u,isLoading:M,isSuccess:p,isError:$}=([n,y]=ae(()=>ie({queryKey:["warehouse",{page:h,limit:m,debouncedSearch:E,organizationId:s.value.user.organizationId,name:s.value.user.fullName}],queryFn:()=>le("warehouse",h.value,m.value,E.value),select:t=>{const a={...t};return a.warehouse=a.warehouse.map(o=>{const r={...o,quantityTypeValue:o==null?void 0:o.quantityType};return delete r.quantityType,r}),a},enabled:w})),n=await n,y(),n),{mutate:j}=ce({mutationFn:t=>de("warehouse",t),onSuccess:t=>{t!=null&&t.success&&(_.invalidateQueries({queryKey:["warehouse"]}),_.invalidateQueries({queryKey:["warehouseById",S.value.toString()]}),setTimeout(()=>Q.success(V("deleteToast")),150))}}),G=async t=>{S.value=t,j(t)};return(t,a)=>{var T,f,b,g,v,A,U,C,D,H,R,W,k;const o=c("HeadPage"),r=c("Table"),J=c("Pagination"),X=c("Spinner");return w.value?(l(),O("section",me,[oe("div",pe,[I(o,{title:"warehouseTitle",to:e(L).CREATE_WAREHOUSE.path,isShowCreate:(b=(f=(T=e(s))==null?void 0:T.user)==null?void 0:f.modules)==null?void 0:b.includes(e(d).WAREHOUSE.CREATE)},{default:ne(()=>[ue(P(t.$t("addButton")),1)]),_:1},8,["to","isShowCreate"]),e(p)&&((g=e(u))!=null&&g.count)?(l(),N(r,{key:0,headers:F.value,table:(v=e(u))==null?void 0:v.warehouse,to:e(L).UPDATE_WAREHOUSE.name,options:{page:e(h),limit:e(m)},isShowUpdate:(C=(U=(A=e(s))==null?void 0:A.user)==null?void 0:U.modules)==null?void 0:C.includes(e(d).WAREHOUSE.UPDATE),isShowDelete:(R=(H=(D=e(s))==null?void 0:D.user)==null?void 0:H.modules)==null?void 0:R.includes(e(d).WAREHOUSE.DELETE),onOnActionDelete:G},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):i("",!0),I(J,{count:(W=e(u))==null?void 0:W.count,isSucces:e(p)},null,8,["count","isSucces"]),e(M)?(l(),N(X,{key:1})):i("",!0),e(p)&&!((k=e(u))!=null&&k.count)||e($)?(l(),O("div",ye,P(t.$t("emptyTableTitle")),1)):i("",!0)])])):i("",!0)}}};export{ge as default};
