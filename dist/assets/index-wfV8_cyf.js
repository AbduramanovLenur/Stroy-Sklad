import{_ as V,q as z,s as F,r as p,x as H,y as K,z as L,d as P,e as M,k,h as e,A as w,i as d,t as G,m as l,o as i,B as I}from"./index-qZ69CyC7.js";import{a as W,u as $}from"./generic.services-34GP1Yc8.js";import{u as j}from"./useQuery-IZNqF3Xo.js";import{g as J,d as X}from"./crud.services-qYEmjzHd.js";import{r as Y}from"./index-hYdXxYyx.js";const Z={class:"employees"},ee={class:"employees__inner section-padding"},te={key:2,class:"empty-table shadowed"},se={__name:"index",async setup(oe){let a,y;const _=W(),h=z(),{setSearchValue:g,setPagePagination:R}=h,{page:c,limit:u,search:b}=F(h),q=p(localStorage.getItem("organizationId"));H(()=>{g("")}),K(b,()=>{R(1)});const S=p(""),f=Y(b,500),A=p([{id:1,label:"employeesFullName",width:510},{id:3,label:"employeesPhone",width:290},{id:4,label:"employeesRole",width:210},{id:5,label:"employeesState"},{id:8,label:"employeesAction"}]),{data:r,isLoading:B,isSuccess:m,isError:C}=([a,y]=L(()=>j({queryKey:["orgUsers",{page:c,limit:u,debouncedSearch:f,organizationId:q}],queryFn:()=>J("user",c.value,u.value,f.value),select:t=>{let s={...t};return s.users=t==null?void 0:t.users.map(o=>{const n={...o,phone:o.phoneNumber,name:o.fullName};return delete n.fullName,delete n.phoneNumber,n}),s}})),a=await a,y(),a),{mutate:U}=$({mutationFn:t=>X("user",t),onSuccess:()=>{_.invalidateQueries({queryKey:["orgUsers"]}),_.invalidateQueries({queryKey:["orgUserById",S]})}}),x=t=>{S.value=t,U(t)};return(t,s)=>{var v,E,T,N;const o=l("HeadPage"),n=l("Table"),D=l("Pagination"),O=l("Spinner");return i(),P("section",Z,[M("div",ee,[k(o,{title:"employeesTitle",to:e(I).CREATE_ORG_USER.path,onOnSearch:s[0]||(s[0]=Q=>e(g)(Q))},null,8,["to"]),e(m)&&((v=e(r))!=null&&v.count)?(i(),w(n,{key:0,headers:A.value,table:(E=e(r))==null?void 0:E.users,to:e(I).UPDATE_ORG_USER.name,options:{page:e(c),limit:e(u)},onOnActionDelete:x},null,8,["headers","table","to","options"])):d("",!0),k(D,{count:(T=e(r))==null?void 0:T.count,isSucces:e(m)},null,8,["count","isSucces"]),e(B)?(i(),w(O,{key:1})):d("",!0),e(m)&&!((N=e(r))!=null&&N.count)||e(C)?(i(),P("div",te,G(t.$t("emptyTableTitle")),1)):d("",!0)])])}}},ce=V(se,[["__scopeId","data-v-890b4098"]]);export{ce as default};
//# sourceMappingURL=index-wfV8_cyf.js.map
