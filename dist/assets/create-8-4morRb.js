import{u as H,a as j,y as v,r as y,c as J,b as f,d as z,f as N,B as p,w as W,F as O,e as K,k as l,g as X,h as g,o as c,i as h,t as _,z as L,A as Y}from"./index-8-F5s4j3.js";import{u as Z,r as n}from"./i18n-validators-72j1n4q8.js";import{a as ee,u as re}from"./generic.services-CQjHStj7.js";import{u as V}from"./useQuery-KERFi8ks.js";import{c as oe}from"./crud.services-Xs683v05.js";import{m as ae,a as ne}from"./manual.services-4pjALTqx.js";const te={class:"manage section-height shadowed"},ie={class:"manage__inner section-padding"},he={__name:"create",async setup(se){let o,u;const w=ee(),S=X();H(),j();const{data:C,isSuccess:F,isLoading:B}=([o,u]=v(()=>V({queryKey:["regions"],queryFn:()=>ae()})),o=await o,u(),o),{data:P,isSuccess:q,isLoading:k}=([o,u]=v(()=>V({queryKey:["districts"],queryFn:()=>ne()})),o=await o,u(),o),t=y({fullName:"",inn:"",address:"",phoneNumber:"",director:"",regionId:[],districtId:[]}),E=J(()=>({fullName:{required:n},inn:{required:n},address:{required:n},phoneNumber:{required:n},director:{required:n},regionId:{required:n},districtId:{required:n}})),a=Z(E,t),M=y([{id:1,model:"fullName",label:"nameOrganizationLabel",placeholder:"nameOrganizationPlaceholder",icon:"input-company",errorKey:"fullName"},{id:2,model:"inn",label:"innOrganizationLabel",placeholder:"innOrganizationPlaceholder",icon:"tin",errorKey:"inn"},{id:3,model:"address",label:"addressOrganizationLabel",placeholder:"addressOrganizationPlaceholder",icon:"address",errorKey:"address"},{id:4,model:"phoneNumber",label:"phoneOrganizationLabel",placeholder:"phoneOrganizationPlaceholder",icon:"phone",errorKey:"phoneNumber"},{id:5,model:"director",label:"directorOrganizationLabel",placeholder:"directorOrganizationPlaceholder",icon:"person",errorKey:"director"}]),T=y([{id:1,model:"regionId",label:"regionOrganizationLabel",placeholder:"regionOrganizationPlaceholder",errorKey:"regionId",options:C,success:F,loading:B},{id:2,model:"districtId",label:"districtOrganizationLabel",placeholder:"districtOrganizationPlaceholder",errorKey:"districtId",options:P,success:q,loading:k}]),{mutate:x}=re({onMutate:r=>{r.regionId=r.regionId[0],r.districtId=r.districtId[0]},mutationFn:r=>oe("organization",r),onSuccess:()=>{w.invalidateQueries({queryKey:["companies"]}),S.push(Y.COMPANIES.path)}}),D=()=>{a.value.$validate(),!a.value.$errors.length&&(x(t.value),a.value.$reset())};return(r,de)=>{var b,$;const R=g("Title"),U=g("FormInput"),A=g("FormSelect"),Q=g("CustomButton");return c(),f("section",te,[z("div",ie,[N(R,null,{default:p(()=>[h(`\r
                `+_(r.$t("addNewCompanyTitle"))+`\r
            `,1)]),_:1}),z("form",{class:"manage__form form-manage",onSubmit:W(D,["prevent"])},[(c(!0),f(O,null,K(M.value,e=>{var i,s,d;return c(),L(U,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":m=>t.value[e.model]=m,width:500,placeholder:r.$t(e.placeholder),name:e.icon,error:(i=l(a))==null?void 0:i[e.errorKey].$error,textError:(d=(s=l(a))==null?void 0:s[e.errorKey].$errors[0])==null?void 0:d.$message},{default:p(()=>[h(_(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(c(!0),f(O,null,K(T.value,e=>{var i,s,d,m,I;return c(),L(A,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":G=>t.value[e.model]=G,width:500,options:e.options,error:(s=(i=l(a))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:s.$error,placeholder:e==null?void 0:e.placeholder,textError:(I=(m=(d=l(a))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:I.$message,success:e.success,loading:e.loading},{default:p(()=>[h(_(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),N(Q,{className:`form__submit ${($=(b=l(a))==null?void 0:b.districtId.$errors[0])!=null&&$.$message?"centered":""}`},{default:p(()=>[h(_(r.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{he as default};
//# sourceMappingURL=create-8-4morRb.js.map
