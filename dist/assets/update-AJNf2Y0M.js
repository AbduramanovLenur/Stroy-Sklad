import{u as ee,a as re,r as p,n as y,c as ae,y as oe,b as N,d as S,f as q,x as h,w as se,F as V,e as w,k as m,g as te,z as ne,h as b,o as g,i as _,t as f,q as F,s as B}from"./index-uEOOChHm.js";import{u as ie,r as s}from"./i18n-validators-Zycmru6O.js";import{a as de,u as le}from"./generic.services-zAUdS-UM.js";import{u as I,a as ue,b as ce}from"./crud.services-AVFHJS4I.js";import{m as me,a as ge,b as pe}from"./manual.services-OPim9ts4.js";const ye={class:"manage section-height"},he={class:"manage__inner section-padding"},$e={__name:"update",async setup(be){let a,t;const $=de(),z=te(),C=ne();ee(),re();const v=p(C.params.id),{data:E,isSuccess:k,isLoading:P}=([a,t]=y(()=>I({queryKey:["regions"],queryFn:()=>me()})),a=await a,t(),a),{data:x,isSuccess:M,isLoading:R}=([a,t]=y(()=>I({queryKey:["districts"],queryFn:()=>ge()})),a=await a,t(),a),{data:T,isSuccess:D,isLoading:Q}=([a,t]=y(()=>I({queryKey:["states"],queryFn:()=>pe()})),a=await a,t(),a),o=p({id:"",fullName:"",inn:"",address:"",phoneNumber:"",director:"",regionId:"",districtId:"",stateId:""}),U=ae(()=>({id:{required:s},fullName:{required:s},inn:{required:s},address:{required:s},phoneNumber:{required:s},director:{required:s},regionId:{required:s},districtId:{required:s},stateId:{required:s}})),n=ie(U,o),G=p([{id:1,model:"fullName",label:"nameOrganizationLabel",placeholder:"nameOrganizationPlaceholder",icon:"input-company",errorKey:"fullName"},{id:2,model:"inn",label:"innOrganizationLabel",placeholder:"innOrganizationPlaceholder",icon:"tin",errorKey:"inn"},{id:3,model:"address",label:"addressOrganizationLabel",placeholder:"addressOrganizationPlaceholder",icon:"address",errorKey:"address"},{id:4,model:"phoneNumber",label:"phoneOrganizationLabel",placeholder:"phoneOrganizationPlaceholder",icon:"phone",errorKey:"phoneNumber"},{id:5,model:"director",label:"directorOrganizationLabel",placeholder:"directorOrganizationPlaceholder",icon:"person",errorKey:"director"}]),A=p([{id:1,model:"regionId",label:"regionOrganizationLabel",options:E,success:k,loading:P,errorKey:"regionId"},{id:2,model:"districtId",label:"districtOrganizationLabel",options:x,success:M,loading:R,errorKey:"districtId"},{id:3,model:"stateId",label:"stateOrganizationLabel",options:T,success:D,loading:Q,errorKey:"stateId"}]),{isError:H}=([a,t]=y(()=>I({queryKey:["companiesById",v],queryFn:()=>ue("organization",v.value),select:r=>{o.value.id=r.id,o.value.fullName=r.fullName,o.value.inn=r.inn,o.value.address=r.address,o.value.phoneNumber=r.phoneNumber,o.value.director=r.director,o.value.regionId=r.regionId,o.value.districtId=r.districtId,o.value.stateId=r.stateId}})),a=await a,t(),a);oe(H,r=>{r&&z.push(B.HOME.path)});const{mutate:W}=le({mutationFn:r=>ce("organization",r),onSuccess:()=>{$.invalidateQueries({queryKey:["companies"]}),$.invalidateQueries({queryKey:["companiesById",v]}),z.push(B.COMPANIES.path)}}),j=async()=>{n.value.$validate(),!n.value.$errors.length&&(W(o.value),n.value.$reset())};return(r,_e)=>{var L,O;const J=b("Title"),X=b("FormInput"),Y=b("FormSelect"),Z=b("CustomButton");return g(),N("section",ye,[S("div",he,[q(J,null,{default:h(()=>[_(`\r
                `+f(r.$t("editCompanyTitle"))+`\r
            `,1)]),_:1}),S("form",{class:"manage__form form-manage",onSubmit:se(j,["prevent"])},[(g(!0),N(V,null,w(G.value,e=>{var i,d,l,u,c;return g(),F(X,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":K=>o.value[e.model]=K,width:500,placeholder:r.$t(e.placeholder),name:e.icon,error:(d=(i=m(n))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(n))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message},{default:h(()=>[_(f(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(g(!0),N(V,null,w(A.value,e=>{var i,d,l,u,c;return g(),F(Y,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":K=>o.value[e.model]=K,width:500,options:e.options,error:(d=(i=m(n))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(n))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:h(()=>[_(f(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),q(Z,{className:`form__submit ${(O=(L=m(n))==null?void 0:L.stateId.$errors[0])!=null&&O.$message?"centered":""}`},{default:h(()=>[_(f(r.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{$e as default};
//# sourceMappingURL=update-AJNf2Y0M.js.map
