import{u as G,a as H,y as K,r as f,c as J,b as I,d as V,f as S,B as p,w as W,F as w,e as L,k as c,g as X,h as _,o as u,i as h,t as y,z as O,A as Y}from"./index-8-F5s4j3.js";import{u as Z,r as m}from"./i18n-validators-72j1n4q8.js";import{a as ee,u as re}from"./generic.services-CQjHStj7.js";import{u as B}from"./useQuery-KERFi8ks.js";import{c as oe}from"./crud.services-Xs683v05.js";import{m as ae,a as te}from"./manual.services-4pjALTqx.js";const se={class:"manage section-height shadowed"},ne={class:"manage__inner section-padding"},_e={__name:"create",async setup(ie){let o,g;const v=ee(),F=X();G(),H();const{data:q,isSuccess:C,isLoading:k}=([o,g]=K(()=>B({queryKey:["regions"],queryFn:()=>ae()})),o=await o,g(),o),{data:z,isSuccess:E,isLoading:N}=([o,g]=K(()=>B({queryKey:["districts"],queryFn:()=>te()})),o=await o,g(),o),t=f({name:"",address:"",organizationId:"",regionId:[],districtId:[]}),T=J(()=>({name:{required:m},address:{required:m},organizationId:{required:m},regionId:{required:m},districtId:{required:m}})),a=Z(T,t),x=f([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),D=f([{id:1,model:"regionId",label:"regionObjectLabel",placeholder:"regionObjectPlaceholder",errorKey:"regionId",options:q,success:C,loading:k},{id:2,model:"districtId",label:"districtObjectLabel",placeholder:"districtObjectPlaceholder",errorKey:"districtId",options:z,success:E,loading:N}]),{mutate:M}=re({onMutate:r=>{r.regionId=r.regionId[0],r.districtId=r.districtId[0]},mutationFn:r=>oe("building_object",r),onSuccess:()=>{v.invalidateQueries({queryKey:["objects"]}),v.invalidateQueries({queryKey:["objectsList"]}),F.push(Y.OBJECTS.path)}}),P=()=>{const r=localStorage.getItem("organizationId");t.value.organizationId=r,a.value.$validate(),!a.value.$errors.length&&(M(t.value),a.value.$reset())};return(r,de)=>{var $,j;const Q=_("Title"),R=_("FormInput"),U=_("FormSelect"),A=_("CustomButton");return u(),I("section",se,[V("div",ne,[S(Q,null,{default:p(()=>[h(`\r
                `+y(r.$t("addNewObjectTitle"))+`\r
            `,1)]),_:1}),V("form",{class:"manage__form form-manage",onSubmit:W(P,["prevent"])},[(u(!0),I(w,null,L(x.value,e=>{var s,n,i,d,l;return u(),O(R,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":b=>t.value[e.model]=b,width:500,placeholder:r.$t(e.placeholder),name:e.icon,error:(n=(s=c(a))==null?void 0:s[e.errorKey])==null?void 0:n.$error,textError:(l=(d=(i=c(a))==null?void 0:i[e.errorKey])==null?void 0:d.$errors[0])==null?void 0:l.$message},{default:p(()=>[h(y(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(u(!0),I(w,null,L(D.value,e=>{var s,n,i,d,l;return u(),O(U,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":b=>t.value[e.model]=b,width:500,options:e.options,error:(n=(s=c(a))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(l=(d=(i=c(a))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:l.$message,success:e.success,loading:e.loading},{default:p(()=>[h(y(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),S(A,{className:`form__submit ${(j=($=c(a))==null?void 0:$.districtId.$errors[0])!=null&&j.$message?"centered":""}`},{default:p(()=>[h(y(r.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{_e as default};
//# sourceMappingURL=create-snlp5Vhl.js.map
