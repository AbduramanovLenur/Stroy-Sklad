import{u as j,a as J,y as v,r as g,c as W,b as h,d as z,f as N,k as i,w as X,F as O,e as K,B as _,g as Y,h as p,o as c,A as L,z as V,i as y,t as f}from"./index-TSEQ-eOA.js";import{u as Z,r as n}from"./i18n-validators-JwSzG1r2.js";import{a as ee,u as re}from"./generic.services-DL6v4nvc.js";import{u as S}from"./useQuery-LbR7akY7.js";import{c as oe}from"./crud.services-TcfslZre.js";import{m as ae,a as ne}from"./manual.services-teOujj0Q.js";const te={class:"manage section-height shadowed"},ie={class:"manage__inner section-padding"},he={__name:"create",async setup(se){let o,u;const w=ee(),C=Y();j(),J();const{data:F,isSuccess:P,isLoading:B}=([o,u]=v(()=>S({queryKey:["regions"],queryFn:()=>ae()})),o=await o,u(),o),{data:M,isSuccess:q,isLoading:E}=([o,u]=v(()=>S({queryKey:["districts"],queryFn:()=>ne()})),o=await o,u(),o),t=g({fullName:"",inn:"",address:"",phoneNumber:"",director:"",regionId:[],districtId:[]}),k=W(()=>({fullName:{required:n},inn:{required:n},address:{required:n},phoneNumber:{required:n},director:{required:n},regionId:{required:n},districtId:{required:n}})),a=Z(k,t),x=g([{id:1,model:"fullName",label:"nameOrganizationLabel",placeholder:"nameOrganizationPlaceholder",icon:"input-company",errorKey:"fullName"},{id:2,model:"inn",label:"innOrganizationLabel",placeholder:"innOrganizationPlaceholder",icon:"tin",errorKey:"inn"},{id:3,model:"address",label:"addressOrganizationLabel",placeholder:"addressOrganizationPlaceholder",icon:"address",errorKey:"address"},{id:4,model:"phoneNumber",label:"phoneOrganizationLabel",placeholder:"phoneOrganizationPlaceholder",icon:"phone",errorKey:"phoneNumber"},{id:5,model:"director",label:"directorOrganizationLabel",placeholder:"directorOrganizationPlaceholder",icon:"person",errorKey:"director"}]),A=g([{id:1,model:"regionId",label:"regionOrganizationLabel",placeholder:"regionOrganizationPlaceholder",errorKey:"regionId",options:F,success:P,loading:B},{id:2,model:"districtId",label:"districtOrganizationLabel",placeholder:"districtOrganizationPlaceholder",errorKey:"districtId",options:M,success:q,loading:E}]),{mutate:D}=re({onMutate:r=>{r.regionId=r.regionId[0],r.districtId=r.districtId[0]},mutationFn:r=>oe("organization",r),onSuccess:()=>{w.invalidateQueries({queryKey:["companies"]}),C.push(L.COMPANIES.path)}}),R=()=>{a.value.$validate(),!a.value.$errors.length&&(D(t.value),a.value.$reset())};return(r,de)=>{var b,I;const U=p("ManageHead"),H=p("FormInput"),Q=p("FormSelect"),T=p("CustomButton");return c(),h("section",te,[z("div",ie,[N(U,{title:"addNewCompanyTitle",to:i(L).COMPANIES.path},null,8,["to"]),z("form",{class:"manage__form form-manage",onSubmit:X(R,["prevent"])},[(c(!0),h(O,null,K(x.value,e=>{var s,d,l;return c(),V(H,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":m=>t.value[e.model]=m,width:500,placeholder:r.$t(e.placeholder),name:e.icon,error:(s=i(a))==null?void 0:s[e.errorKey].$error,textError:(l=(d=i(a))==null?void 0:d[e.errorKey].$errors[0])==null?void 0:l.$message},{default:_(()=>[y(f(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(c(!0),h(O,null,K(A.value,e=>{var s,d,l,m,$;return c(),V(Q,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":G=>t.value[e.model]=G,width:500,options:e.options,error:(d=(s=i(a))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:d.$error,placeholder:e==null?void 0:e.placeholder,textError:($=(m=(l=i(a))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:$.$message,success:e.success,loading:e.loading},{default:_(()=>[y(f(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),N(T,{className:`form__submit ${(I=(b=i(a))==null?void 0:b.districtId.$errors[0])!=null&&I.$message?"centered":""}`},{default:_(()=>[y(f(r.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{he as default};
//# sourceMappingURL=create-Po2Whq3i.js.map
