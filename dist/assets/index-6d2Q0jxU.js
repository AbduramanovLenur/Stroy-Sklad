import{q as G,s as A,b as J,c as X,r as O,x as Y,d as P,e as Z,k as B,h as e,y as I,i as n,t as ee,m as r,o as i,z as Q,E as l}from"./index-YWoyi3P5.js";import{a as se,u as te}from"./generic.services-k4FTnzsm.js";import{u as oe}from"./useQuery-cUByw4Jp.js";import{g as ae,d as ne}from"./crud.services-lAAT8oXP.js";import{r as re}from"./index-SwZqc-vw.js";const ie={key:0,class:"roles"},le={class:"roles__inner section-padding"},ce={key:2,class:"empty-table shadowed"},he={__name:"index",async setup(ue){let o,_;const c=se(),U=G(),{page:u,limit:d,search:K}=A(U),N=J(),{user:t}=A(N),y=X(()=>{var s,p;return!!((p=(s=t==null?void 0:t.value.user)==null?void 0:s.modules)!=null&&p.includes(l.ROLE.READ))}),h=O(""),S=re(K,500),x=O([{id:1,label:"rolesName",width:550}]),{data:a,isLoading:z,isSuccess:m,isError:H}=([o,_]=Y(()=>oe({queryKey:["roles",{page:u,limit:d,debouncedSearch:S,organizationId:t.value.user.organizationId}],queryFn:()=>ae("Role",u.value,d.value,S.value),enabled:y})),o=await o,_(),o),{mutate:V}=te({mutationFn:s=>ne("Role",s),onSuccess:()=>{c.invalidateQueries({queryKey:["roles"]}),c.invalidateQueries({queryKey:["rolesById",h]}),c.invalidateQueries({queryKey:["rolesList"]})}}),F=async s=>{h.value=s,V(s)};return(s,p)=>{var E,g,v,R,b,L,T,f,w,D,C,k,q;const M=r("HeadPage"),W=r("Table"),$=r("Pagination"),j=r("Spinner");return y.value?(i(),P("section",ie,[Z("div",le,[B(M,{title:"rolesTitle",to:e(Q).CREATE_ROLES.path,isShowCreate:(v=(g=(E=e(t))==null?void 0:E.user)==null?void 0:g.modules)==null?void 0:v.includes(e(l).ROLE.CREATE)},null,8,["to","isShowCreate"]),e(m)&&((R=e(a))!=null&&R.count)?(i(),I(W,{key:0,headers:x.value,table:(b=e(a))==null?void 0:b.roles,to:e(Q).UPDATE_ROLES.name,options:{page:e(u),limit:e(d)},isShowUpdate:(f=(T=(L=e(t))==null?void 0:L.user)==null?void 0:T.modules)==null?void 0:f.includes(e(l).ROLE.UPDATE),isShowDelete:(C=(D=(w=e(t))==null?void 0:w.user)==null?void 0:D.modules)==null?void 0:C.includes(e(l).ROLE.DELETE),onOnActionDelete:F},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):n("",!0),B($,{count:(k=e(a))==null?void 0:k.count,isSucces:e(m)},null,8,["count","isSucces"]),e(z)?(i(),I(j,{key:1})):n("",!0),e(m)&&!((q=e(a))!=null&&q.count)||e(H)?(i(),P("div",ce,ee(s.$t("emptyTableTitle")),1)):n("",!0)])])):n("",!0)}}};export{he as default};
//# sourceMappingURL=index-6d2Q0jxU.js.map
