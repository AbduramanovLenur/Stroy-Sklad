import{_ as D,q as I,s as M,r as S,x as O,d as v,e as Q,k as N,h as e,y as T,i as p,t as F,m as l,o as r,z as P}from"./index-YWoyi3P5.js";import{a as H,u as K}from"./generic.services-k4FTnzsm.js";import{u as R}from"./useQuery-cUByw4Jp.js";import{g as V,d as Y}from"./crud.services-lAAT8oXP.js";import{r as U}from"./index-SwZqc-vw.js";const W={class:"employees"},$={class:"employees__inner section-padding"},j={key:2,class:"empty-table shadowed"},G={__name:"index",async setup(J){let n,d;const y=H(),k=I(),{page:i,limit:c,search:w}=M(k),_=S(""),h=U(w,500),q=S([{id:1,label:"employeesFullName",width:300},{id:2,label:"employeesOrganization",width:320},{id:3,label:"employeesPhone",width:255},{id:4,label:"employeesRole",width:195}]),{data:a,isLoading:C,isSuccess:u,isError:x}=([n,d]=O(()=>R({queryKey:["employees",{page:i,limit:c,debouncedSearch:h}],queryFn:()=>V("user",i.value,c.value,h.value),select:t=>{let m={...t};return m.users=t==null?void 0:t.users.map(s=>{const o={...s,phone:s.phoneNumber,company:s.organizationName,name:s.fullName};return delete o.fullName,delete o.phoneNumber,delete o.organizationName,o}),m}})),n=await n,d(),n),{mutate:B}=K({mutationFn:t=>Y("user",t),onSuccess:()=>{y.invalidateQueries({queryKey:["employees"]}),y.invalidateQueries({queryKey:["employeesById",_]})}}),L=t=>{_.value=t,B(t)};return(t,m)=>{var b,f,g,E;const s=l("HeadPage"),o=l("Table"),z=l("Pagination"),A=l("Spinner");return r(),v("section",W,[Q("div",$,[N(s,{title:"employeesTitle",to:e(P).CREATE_EMPLOYEES.path},null,8,["to"]),e(u)&&((b=e(a))!=null&&b.count)?(r(),T(o,{key:0,headers:q.value,table:(f=e(a))==null?void 0:f.users,to:e(P).UPDATE_EMPLOYEES.name,options:{page:e(i),limit:e(c)},onOnActionDelete:L},null,8,["headers","table","to","options"])):p("",!0),N(z,{count:(g=e(a))==null?void 0:g.count,isSucces:e(u)},null,8,["count","isSucces"]),e(C)?(r(),T(A,{key:1})):p("",!0),e(u)&&!((E=e(a))!=null&&E.count)||e(x)?(r(),v("div",j,F(t.$t("emptyTableTitle")),1)):p("",!0)])])}}},oe=D(G,[["__scopeId","data-v-ab77f41a"]]);export{oe as default};
//# sourceMappingURL=index-Yjf5GAcM.js.map
