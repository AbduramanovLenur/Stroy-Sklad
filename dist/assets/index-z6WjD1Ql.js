import{_ as I,n as Q,s as V,q as F,x as H,r as P,y as K,b as T,d as R,f as w,k as e,z as A,l as p,t as Y,h as i,o as r,A as k}from"./index-xEhNh2bJ.js";import{a as U,u as W}from"./generic.services-cTEduup6.js";import{u as $}from"./useQuery-9UwmWmpU.js";import{g as j,d as G}from"./crud.services-QxvbF8R1.js";import{r as J}from"./index-TAQZG_9n.js";const X={class:"employees"},Z={class:"employees__inner section-padding"},ee={key:2,class:"empty-table shadowed"},te={__name:"index",async setup(se){let a,d;const y=U(),_=Q(),{setSearchValue:h,setPagePagination:q}=_,{page:c,limit:u,search:b}=V(_);F(()=>{h("")}),H(b,()=>{q(1)});const g=P(""),S=J(b,500),C=P([{id:1,label:"employeesFullName",width:300},{id:2,label:"employeesOrganization",width:320},{id:3,label:"employeesPhone",width:255},{id:4,label:"employeesRole",width:195},{id:5,label:"employeesState"},{id:8,label:"employeesAction"}]),{data:l,isLoading:x,isSuccess:m,isError:B}=([a,d]=K(()=>$({queryKey:["employees",{page:c,limit:u,debouncedSearch:S,isAdmin:!0}],queryFn:()=>j("user",c.value,u.value,S.value,{isAdmin:!0}),select:t=>{let n={...t};return n.users=t==null?void 0:t.users.map(s=>{const o={...s,phone:s.phoneNumber,company:s.organizationName,name:s.fullName};return delete o.fullName,delete o.phoneNumber,delete o.organizationName,o}),n}})),a=await a,d(),a),{mutate:L}=W({mutationFn:t=>G("user",t),onSuccess:()=>{y.invalidateQueries({queryKey:["employees"]}),y.invalidateQueries({queryKey:["employeesById",g]})}}),M=t=>{g.value=t,L(t)};return(t,n)=>{var f,E,v,N;const s=i("HeadPage"),o=i("Table"),O=i("Pagination"),z=i("Spinner");return r(),T("section",X,[R("div",Z,[w(s,{title:"employeesTitle",to:e(k).CREATE_EMPLOYEES.path,onOnSearch:n[0]||(n[0]=D=>e(h)(D))},null,8,["to"]),e(m)&&((f=e(l))!=null&&f.count)?(r(),A(o,{key:0,headers:C.value,table:(E=e(l))==null?void 0:E.users,to:e(k).UPDATE_EMPLOYEES.name,options:{page:e(c),limit:e(u)},onOnActionDelete:M},null,8,["headers","table","to","options"])):p("",!0),w(O,{count:(v=e(l))==null?void 0:v.count,isSucces:e(m)},null,8,["count","isSucces"]),e(x)?(r(),A(z,{key:1})):p("",!0),e(m)&&!((N=e(l))!=null&&N.count)||e(B)?(r(),T("div",ee,Y(t.$t("emptyTableTitle")),1)):p("",!0)])])}}},re=I(te,[["__scopeId","data-v-421bd650"]]);export{re as default};
//# sourceMappingURL=index-z6WjD1Ql.js.map
