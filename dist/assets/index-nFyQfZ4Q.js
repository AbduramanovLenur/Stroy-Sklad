import{u as H,a as K,x as L,y as M,r as S,z as O,d as w,e as R,k as T,h as t,A as v,i as d,t as V,m as s,o as c,s as C}from"./index-6Y00dUwo.js";import{u as F}from"./generic.services-DBqHHnAA.js";import{u as U}from"./useQuery-4Ev4vRio.js";import{u as W}from"./useMutation-ixZ1w3o_.js";import{g as $,d as j}from"./crud.services-n7kB94wy.js";import{r as G}from"./index-C_FfflJ0.js";const J={class:"company section-height"},X={class:"company__inner section-padding"},Y={key:2,class:"empty-table shadowed"},se={__name:"index",async setup(Z){let o,p;const _=F(),A=H(),{t:N}=K(),P=L(),{page:r,limit:l,search:k}=M(P),g=S(""),y=G(k,500),D=S([{id:1,label:"organizationName",width:20},{id:2,label:"organizationInn",width:10},{id:3,label:"organizationRegion",width:15},{id:4,label:"organizationDistrict",width:15},{id:5,label:"organizationAddress",width:15},{id:6,label:"organizationPhone",width:15},{id:7,label:"organizationDirector",width:20}]),{data:a,isLoading:E,isSuccess:u,isError:I}=([o,p]=O(()=>U({queryKey:["companies",{page:r,limit:l,debouncedSearch:y}],queryFn:()=>$("organization",r.value,l.value,y.value),select:e=>{let m={...e};return m.organizations=e==null?void 0:e.organizations.map(n=>{const i={...n,company:n.organizationName};return delete i.organizationName,i}),m}})),o=await o,p(),o),{mutate:q}=W({mutationFn:e=>j("organization",e),onSuccess:async e=>{e!=null&&e.success&&(await _.invalidateQueries({queryKey:["companies"]}),await _.invalidateQueries({queryKey:["companyById",g]}),setTimeout(()=>A.success(N("deleteToast")),150))}}),B=e=>{g.value=e,q(e)};return(e,m)=>{var h,b,z,f;const n=s("HeadPage"),i=s("Table"),Q=s("Pagination"),x=s("Spinner");return c(),w("section",J,[R("div",X,[T(n,{title:"comapnyTitle",to:t(C).CREATE_COMPANIES.path},null,8,["to"]),t(u)&&((h=t(a))!=null&&h.count)?(c(),v(i,{key:0,headers:D.value,table:(b=t(a))==null?void 0:b.organizations,to:t(C).UPDATE_COMPANIES.name,options:{page:t(r),limit:t(l)},onOnActionDelete:B},null,8,["headers","table","to","options"])):d("",!0),T(Q,{count:(z=t(a))==null?void 0:z.count,isSucces:t(u)},null,8,["count","isSucces"]),t(E)?(c(),v(x,{key:1})):d("",!0),t(u)&&!((f=t(a))!=null&&f.count)||t(I)?(c(),w("div",Y,V(e.$t("emptyTableTitle")),1)):d("",!0)])])}}};export{se as default};
