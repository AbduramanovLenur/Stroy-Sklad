import{q as V,s as x,r as p,x as z,y as H,z as K,d as k,e as U,k as D,h as e,A as q,i as m,t as F,m as c,o as i,B as A}from"./index-8f2nY-tA.js";import{a as W,u as $}from"./generic.services-2-3LJT-B.js";import{u as j}from"./useQuery-eGcy0OjN.js";import{g as G,d as J}from"./crud.services-swolhUoO.js";import{r as X}from"./index-N_tz-29j.js";const Y={class:"products"},Z={class:"products__inner section-padding"},ee={key:2,class:"empty-table shadowed"},ce={__name:"index",async setup(te){let s,_;const y=W(),g=V(),{setSearchValue:S,setPagePagination:B}=g,{page:u,limit:l,search:h}=x(g),I=p(localStorage.getItem("organizationId"));z(()=>{S("")}),H(h,()=>{B(1)});const b=p(""),f=X(h,500),N=p([{id:1,label:"productsName",width:725},{id:4,label:"productsState"},{id:5,label:"productsAction"}]),{data:n,isLoading:w,isSuccess:d,isError:E}=([s,_]=K(()=>j({queryKey:["products",{page:u,limit:l,debouncedSearch:f,organizationId:I}],queryFn:()=>G("construction_material",u.value,l.value,f.value),select:t=>{let o=[...t==null?void 0:t.constructionMaterial];return o=o.map(a=>{const r={...a,material:a.fullName};return delete r.fullName,r}),{constructionMaterial:o,count:t==null?void 0:t.count}}})),s=await s,_(),s),{mutate:M}=$({mutationFn:t=>J("construction_material",t),onSuccess:()=>{y.invalidateQueries({queryKey:["products"]}),y.invalidateQueries({queryKey:["productsById",b]})}}),L=async t=>{b.value=t,M(t)};return(t,o)=>{var P,T,v,C;const a=c("HeadPage"),r=c("Table"),O=c("Pagination"),Q=c("Spinner");return i(),k("section",Y,[U("div",Z,[D(a,{title:"productsTitle",to:e(A).CREATE_PRODUCTS.path,onOnSearch:o[0]||(o[0]=R=>e(S)(R))},null,8,["to"]),e(d)&&((P=e(n))!=null&&P.count)?(i(),q(r,{key:0,headers:N.value,table:(T=e(n))==null?void 0:T.constructionMaterial,to:e(A).UPDATE_PRODUCTS.name,options:{page:e(u),limit:e(l)},onOnActionDelete:L},null,8,["headers","table","to","options"])):m("",!0),D(O,{count:(v=e(n))==null?void 0:v.count,isSucces:e(d)},null,8,["count","isSucces"]),e(w)?(i(),q(Q,{key:1})):m("",!0),e(d)&&!((C=e(n))!=null&&C.count)||e(E)?(i(),k("div",ee,F(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{ce as default};
//# sourceMappingURL=index-Ap2QOAo2.js.map
