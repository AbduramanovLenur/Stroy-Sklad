import{u as Y,a as Z,x as ee,y as W,b as te,c as se,r as k,z as ae,d as B,e as oe,k as O,A as ne,h as e,B as I,i as n,t as N,m as u,o as r,f as ue,s as P,H as i}from"./index-O2h3gL13.js";import{u as re}from"./generic.services-QvSdyUz0.js";import{u as ie}from"./useQuery-kkjrNxK8.js";import{u as ce}from"./useMutation-05dLsYlb.js";import{g as le,d as de}from"./crud.services-EgXNei1C.js";import{r as he}from"./index-ouQ1Yvgt.js";const me={key:0,class:"warehouse"},_e={class:"warehouse__inner section-padding"},pe={key:2,class:"empty-table shadowed"},ge={__name:"index",async setup(we){let a,m;const _=re(),Q=Y(),{t:q}=Z(),L=ee(),{page:c,limit:l,search:x}=W(L),V=te(),{user:s}=W(V),p=se(()=>{var t,h;return!!((h=(t=s==null?void 0:s.value.user)==null?void 0:t.modules)!=null&&h.includes(i.WAREHOUSE.READ))}),w=k(""),S=he(x,500),z=k([{id:1,label:"warehouseName",width:35},{id:2,label:"warehouseQuantity",width:20},{id:3,label:"warehouseQuantityType",width:20}]),{data:o,isLoading:K,isSuccess:d,isError:F}=([a,m]=ae(()=>ie({queryKey:["warehouse",{page:c,limit:l,debouncedSearch:S,organizationId:s.value.user.organizationId,name:s.value.user.fullName}],queryFn:()=>le("warehouse",c.value,l.value,S.value),enabled:p})),a=await a,m(),a),{mutate:M}=ce({mutationFn:t=>de("warehouse",t),onSuccess:t=>{t!=null&&t.success&&(_.invalidateQueries({queryKey:["warehouse"]}),_.invalidateQueries({queryKey:["warehouseById",w]}),setTimeout(()=>Q.success(q("deleteToast")),150))}}),$=async t=>{w.value=t,M(t)};return(t,h)=>{var y,E,T,f,b,g,v,A,U,C,D,H,R;const j=u("HeadPage"),G=u("Table"),J=u("Pagination"),X=u("Spinner");return p.value?(r(),B("section",me,[oe("div",_e,[O(j,{title:"warehouseTitle",to:e(P).CREATE_WAREHOUSE.path,isShowCreate:(T=(E=(y=e(s))==null?void 0:y.user)==null?void 0:E.modules)==null?void 0:T.includes(e(i).WAREHOUSE.CREATE)},{default:ne(()=>[ue(N(t.$t("addButton")),1)]),_:1},8,["to","isShowCreate"]),e(d)&&((f=e(o))!=null&&f.count)?(r(),I(G,{key:0,headers:z.value,table:(b=e(o))==null?void 0:b.warehouse,to:e(P).UPDATE_WAREHOUSE.name,options:{page:e(c),limit:e(l)},isShowUpdate:(A=(v=(g=e(s))==null?void 0:g.user)==null?void 0:v.modules)==null?void 0:A.includes(e(i).WAREHOUSE.UPDATE),isShowDelete:(D=(C=(U=e(s))==null?void 0:U.user)==null?void 0:C.modules)==null?void 0:D.includes(e(i).WAREHOUSE.DELETE),onOnActionDelete:$},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):n("",!0),O(J,{count:(H=e(o))==null?void 0:H.count,isSucces:e(d)},null,8,["count","isSucces"]),e(K)?(r(),I(X,{key:1})):n("",!0),e(d)&&!((R=e(o))!=null&&R.count)||e(F)?(r(),B("div",pe,N(t.$t("emptyTableTitle")),1)):n("",!0)])])):n("",!0)}}};export{ge as default};
