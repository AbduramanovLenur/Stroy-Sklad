import{q as $,s as k,b as j,c as G,r as q,x as J,d as A,e as Y,k as L,h as e,y as X,i as a,t as Z,m as i,o as c,z as B,E as r}from"./index--8tqH1cI.js";import{a as ee,u as se}from"./generic.services-lNDsx7jF.js";import{u as te}from"./useQuery-_ggqNrTF.js";import{g as oe,d as ne}from"./crud.services-U-Ys9NO0.js";import{r as ae}from"./index-Wjsu-XE2.js";const ie={key:0,class:"expenses"},ce={class:"expenses__inner section-padding"},re={key:2,class:"empty-table shadowed"},_e={__name:"index",async setup(ue){let o,E;const u=ee(),I=$(),{page:l,limit:d,search:Q}=k(I),U=j(),{user:t}=k(U),_=G(()=>{var s,m;return!!((m=(s=t==null?void 0:t.value.user)==null?void 0:s.modules)!=null&&m.includes(r.EXPENS.READ))}),S=q(""),y=ae(Q,500),K=q([{id:1,label:"expensesName",width:635}]),{data:n,isLoading:R,isSuccess:p,isError:z}=([o,E]=J(()=>te({queryKey:["expenses",{page:l,limit:d,debouncedSearch:y,organizationId:t.value.user.organizationId}],queryFn:()=>oe("cost",l.value,d.value,y.value),enabled:_})),o=await o,E(),o),{mutate:H}=se({mutationFn:s=>ne("cost",s),onSuccess:()=>{u.invalidateQueries({queryKey:["expenses"]}),u.invalidateQueries({queryKey:["expensesById",S]}),u.invalidateQueries({queryKey:["costsList"]})}}),V=async s=>{S.value=s,H(s)};return(s,m)=>{var h,g,v,x,b,P,T,f,w,D,N,C;const F=i("HeadPage"),M=i("Table"),O=i("Pagination"),W=i("Spinner");return _.value?(c(),A("section",ie,[Y("div",ce,[L(F,{title:"expensesTitle",to:e(B).CREATE_EXPENSES.path,isShowCreate:(v=(g=(h=e(t))==null?void 0:h.user)==null?void 0:g.modules)==null?void 0:v.includes(e(r).EXPENS.CREATE)},null,8,["to","isShowCreate"]),e(p)&&((x=e(n))!=null&&x.count)?(c(),X(M,{key:0,headers:K.value,table:(b=e(n))==null?void 0:b.cost,to:e(B).UPDATE_EXPENSES.name,options:{page:e(l),limit:e(d)},isShowUpdate:(f=(T=(P=e(t))==null?void 0:P.user)==null?void 0:T.modules)==null?void 0:f.includes(e(r).EXPENS.UPDATE),isShowDelete:(N=(D=(w=e(t))==null?void 0:w.user)==null?void 0:D.modules)==null?void 0:N.includes(e(r).EXPENS.DELETE),onOnActionDelete:V},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):a("",!0),L(O,{count:(C=e(n))==null?void 0:C.count,isSucces:e(p)},null,8,["count","isSucces"]),e(R)?(c(),X(W,{key:1})):a("",!0),e(p)&&!e(n).count||e(z)?(c(),A("div",re,Z(s.$t("emptyTableTitle")),1)):a("",!0)])])):a("",!0)}}};export{_e as default};
//# sourceMappingURL=index-VO4uufu3.js.map
