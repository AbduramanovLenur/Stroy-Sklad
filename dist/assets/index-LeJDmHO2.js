import{n as V,s as x,r as u,q as H,x as K,y as F,b as P,d as M,f as T,k as e,z as N,l as m,t as R,h as l,o as c,A as C}from"./index-TSEQ-eOA.js";import{a as U,u as j}from"./generic.services-DL6v4nvc.js";import{u as W}from"./useQuery-LbR7akY7.js";import{g as $,d as G}from"./crud.services-TcfslZre.js";import{r as J}from"./index-iqNYHYNl.js";const X={class:"applications"},Y={class:"applications__inner"},Z={key:2,class:"empty-table shadowed"},se={__name:"index",async setup(ee){let n,_;const h=U(),y=V(),{setSearchValue:b,setPagePagination:k}=y,{page:p,limit:r,search:g}=x(y),S=u(localStorage.getItem("organizationId"));H(()=>{b("")}),K(g,()=>{k(1)});const f=u(""),A=J(g,500),D=u([{id:1,label:"applicationUserName",width:130},{id:2,label:"applicationOrganization",width:185},{id:3,label:"applicationDocDate",width:210},{id:4,label:"applicationDedline",width:240},{id:5,label:"applicationObject",width:100},{id:6,label:"applicationBlock",width:95},{id:7,label:"applicationCost",width:330},{id:8,label:"applicationState"},{id:9,label:"applicationAction"}]),{data:s,isLoading:z,isSuccess:d,isError:q}=([n,_]=F(()=>W({queryKey:["applications",{page:p,limit:r,debouncedSearch:A,organizationId:S}],queryFn:()=>$("application",p.value,r.value,A.value,{organizationId:S.value}),select:t=>{let a={...t};return a.applications=a==null?void 0:a.applications.map(i=>{const o={...i,name:i.userName,company:i.organizationName};return delete o.userName,delete o.organizationName,delete o.state,delete o.stateId,o}),a}})),n=await n,_(),n),{mutate:B}=j({mutationFn:t=>G("application",t),onSuccess:()=>{h.invalidateQueries({queryKey:["applications"]}),h.invalidateQueries({queryKey:["applicationsById",f]})}}),O=async t=>{f.value=t,B(t)};return(t,a)=>{var I,v,w;const i=l("HeadPage"),o=l("Table"),E=l("Pagination"),L=l("Spinner");return c(),P("section",X,[M("div",Y,[T(i,{title:"applicationTitle",to:e(C).CREATE_APPLICATIONS.path,onOnSearch:a[0]||(a[0]=Q=>e(b)(Q))},null,8,["to"]),e(d)&&((I=e(s))!=null&&I.count)?(c(),N(o,{key:0,headers:D.value,table:(v=e(s))==null?void 0:v.applications,to:e(C).UPDATE_APPLICATIONS.name,options:{page:e(p),limit:e(r)},onOnActionDelete:O},null,8,["headers","table","to","options"])):m("",!0),T(E,{count:(w=e(s))==null?void 0:w.count,isSucces:e(d)},null,8,["count","isSucces"]),e(z)?(c(),N(L,{key:1})):m("",!0),e(d)&&!e(s).count||e(q)?(c(),P("div",Z,R(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{se as default};
//# sourceMappingURL=index-LeJDmHO2.js.map
