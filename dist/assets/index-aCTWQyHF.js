import{q as x,s as H,r as l,x as K,y as F,z as M,d as P,e as R,k as T,h as e,A as v,i as m,t as U,m as c,o as r,B as N}from"./index-qZ69CyC7.js";import{a as j,u as W}from"./generic.services-34GP1Yc8.js";import{u as $}from"./useQuery-IZNqF3Xo.js";import{g as G,d as J}from"./crud.services-qYEmjzHd.js";import{r as X}from"./index-hYdXxYyx.js";const Y={class:"applications"},Z={class:"applications__inner"},ee={key:2,class:"empty-table shadowed"},le={__name:"index",async setup(te){let n,_;const h=j(),y=x(),{setSearchValue:g,setPagePagination:C}=y,{page:p,limit:d,search:b}=H(y),k=l(localStorage.getItem("organizationId")),D=l(localStorage.getItem("roleId"));K(()=>{g("")}),F(b,()=>{C(1)});const S=l(""),I=X(b,500),B=l([{id:1,label:"applicationUserName",width:130},{id:3,label:"applicationDocDate",width:210},{id:4,label:"applicationDedline",width:240},{id:5,label:"applicationObject",width:100},{id:6,label:"applicationBlock",width:95},{id:7,label:"applicationCost",width:330},{id:8,label:"applicationState"},{id:9,label:"applicationAction"}]),{data:s,isLoading:q,isSuccess:u,isError:z}=([n,_]=M(()=>$({queryKey:["applications",{page:p,limit:d,debouncedSearch:I,organizationId:k,roleId:D}],queryFn:()=>G("application",p.value,d.value,I.value),select:t=>{let a={...t};return a.applications=a==null?void 0:a.applications.map(i=>{const o={...i,name:i.userName,company:i.organizationName};return delete o.userName,delete o.organizationName,delete o.state,delete o.stateId,o}),a}})),n=await n,_(),n),{mutate:E}=W({mutationFn:t=>J("application",t),onSuccess:()=>{h.invalidateQueries({queryKey:["applications"]}),h.invalidateQueries({queryKey:["applicationsById",S]})}}),L=async t=>{S.value=t,E(t)};return(t,a)=>{var A,f,w;const i=c("HeadPage"),o=c("Table"),O=c("Pagination"),Q=c("Spinner");return r(),P("section",Y,[R("div",Z,[T(i,{title:"applicationTitle",to:e(N).CREATE_APPLICATIONS.path,onOnSearch:a[0]||(a[0]=V=>e(g)(V))},null,8,["to"]),e(u)&&((A=e(s))!=null&&A.count)?(r(),v(o,{key:0,headers:B.value,table:(f=e(s))==null?void 0:f.applications,to:e(N).UPDATE_APPLICATIONS.name,options:{page:e(p),limit:e(d)},isShow:!0,onOnActionDelete:L},null,8,["headers","table","to","options"])):m("",!0),T(O,{count:(w=e(s))==null?void 0:w.count,isSucces:e(u)},null,8,["count","isSucces"]),e(q)?(r(),v(Q,{key:1})):m("",!0),e(u)&&!e(s).count||e(z)?(r(),P("div",ee,U(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{le as default};
//# sourceMappingURL=index-aCTWQyHF.js.map
