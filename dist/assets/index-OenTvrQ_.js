import{u as X,a as Y,x as Z,y as W,b as ee,c as se,r as k,z as te,d as O,e as ae,k as I,h as e,A as P,i as n,t as oe,m as u,o as r,s as Q,H as i}from"./index--ASsptNz.js";import{u as ne}from"./generic.services-OmFX1-7T.js";import{u as ue}from"./useQuery-aJZefqwx.js";import{u as re}from"./useMutation-KDcbY73c.js";import{g as ie,d as ce}from"./crud.services-J6Vd6xLE.js";import{r as le}from"./index-QW6gxCzp.js";const de={key:0,class:"warehouse"},me={class:"warehouse__inner section-padding"},he={key:2,class:"empty-table shadowed"},be={__name:"index",async setup(_e){let a,h;const _=ne(),q=X(),{t:B}=Y(),L=Z(),{page:c,limit:l,search:N}=W(L),x=ee(),{user:t}=W(x),p=se(()=>{var s,m;return!!((m=(s=t==null?void 0:t.value.user)==null?void 0:s.modules)!=null&&m.includes(i.WAREHOUSE.READ))}),w=k(""),S=le(N,500),z=k([{id:1,label:"warehouseName",width:35},{id:2,label:"warehouseQuantity",width:20},{id:3,label:"warehouseQuantityType",width:20}]),{data:o,isLoading:K,isSuccess:d,isError:V}=([a,h]=te(()=>ue({queryKey:["warehouse",{page:c,limit:l,debouncedSearch:S,organizationId:t.value.user.organizationId,name:t.value.user.fullName}],queryFn:()=>ie("warehouse",c.value,l.value,S.value),enabled:p})),a=await a,h(),a),{mutate:F}=re({mutationFn:s=>ce("warehouse",s),onSuccess:s=>{s!=null&&s.success&&(_.invalidateQueries({queryKey:["warehouse"]}),_.invalidateQueries({queryKey:["warehouseById",w]}),setTimeout(()=>q.success(B("deleteToast")),150))}}),M=async s=>{w.value=s,F(s)};return(s,m)=>{var y,E,T,b,f,g,v,A,U,D,H,R,C;const $=u("HeadPage"),j=u("Table"),G=u("Pagination"),J=u("Spinner");return p.value?(r(),O("section",de,[ae("div",me,[I($,{title:"warehouseTitle",to:e(Q).CREATE_WAREHOUSE.path,isShowCreate:(T=(E=(y=e(t))==null?void 0:y.user)==null?void 0:E.modules)==null?void 0:T.includes(e(i).WAREHOUSE.CREATE)},null,8,["to","isShowCreate"]),e(d)&&((b=e(o))!=null&&b.count)?(r(),P(j,{key:0,headers:z.value,table:(f=e(o))==null?void 0:f.warehouse,to:e(Q).UPDATE_WAREHOUSE.name,options:{page:e(c),limit:e(l)},isShowUpdate:(A=(v=(g=e(t))==null?void 0:g.user)==null?void 0:v.modules)==null?void 0:A.includes(e(i).WAREHOUSE.UPDATE),isShowDelete:(H=(D=(U=e(t))==null?void 0:U.user)==null?void 0:D.modules)==null?void 0:H.includes(e(i).WAREHOUSE.DELETE),onOnActionDelete:M},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):n("",!0),I(G,{count:(R=e(o))==null?void 0:R.count,isSucces:e(d)},null,8,["count","isSucces"]),e(K)?(r(),P(J,{key:1})):n("",!0),e(d)&&!((C=e(o))!=null&&C.count)||e(V)?(r(),O("div",he,oe(s.$t("emptyTableTitle")),1)):n("",!0)])])):n("",!0)}}};export{be as default};
