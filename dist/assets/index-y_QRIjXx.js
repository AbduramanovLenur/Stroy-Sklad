import{u as X,a as Y,x as Z,y as O,b as ee,c as se,r as q,z as te,d as I,e as oe,k as P,h as e,A as B,i as n,t as ae,m as i,o as r,s as Q,H as l}from"./index-_XMrp3Vl.js";import{a as ne,u as ie}from"./generic.services-t_drLwo6.js";import{u as re}from"./useQuery-aI4x6Qnk.js";import{g as le,d as ue}from"./crud.services-6WaoEN5X.js";import{r as ce}from"./index-6rrqxCGq.js";const de={key:0,class:"roles"},me={class:"roles__inner section-padding"},_e={key:2,class:"empty-table shadowed"},ge={__name:"index",async setup(pe){let o,p;const u=ne(),U=X(),{t:H}=Y(),K=Z(),{page:c,limit:d,search:N}=O(K),x=ee(),{user:t}=O(x),y=se(()=>{var s,_;return!!((_=(s=t==null?void 0:t.value.user)==null?void 0:s.modules)!=null&&_.includes(l.ROLE.READ))}),h=q(""),S=ce(N,500),z=q([{id:1,label:"rolesName",width:70}]),{data:a,isLoading:V,isSuccess:m,isError:F}=([o,p]=te(()=>re({queryKey:["roles",{page:c,limit:d,debouncedSearch:S,organizationId:t.value.user.organizationId}],queryFn:()=>le("Role",c.value,d.value,S.value),enabled:y})),o=await o,p(),o),{mutate:M}=ie({mutationFn:s=>ue("Role",s),onSuccess:s=>{s!=null&&s.success&&(u.invalidateQueries({queryKey:["roles"]}),u.invalidateQueries({queryKey:["rolesById",h]}),u.invalidateQueries({queryKey:["rolesList"]}),setTimeout(()=>U.success(H("deleteToast")),150))}}),W=async s=>{h.value=s,M(s)};return(s,_)=>{var E,T,g,v,R,b,f,L,w,D,C,k,A;const $=i("HeadPage"),j=i("Table"),G=i("Pagination"),J=i("Spinner");return y.value?(r(),I("section",de,[oe("div",me,[P($,{title:"rolesTitle",to:e(Q).CREATE_ROLE.path,isShowCreate:(g=(T=(E=e(t))==null?void 0:E.user)==null?void 0:T.modules)==null?void 0:g.includes(e(l).ROLE.CREATE)},null,8,["to","isShowCreate"]),e(m)&&((v=e(a))!=null&&v.count)?(r(),B(j,{key:0,headers:z.value,table:(R=e(a))==null?void 0:R.roles,to:e(Q).UPDATE_ROLE.name,options:{page:e(c),limit:e(d)},isShowUpdate:(L=(f=(b=e(t))==null?void 0:b.user)==null?void 0:f.modules)==null?void 0:L.includes(e(l).ROLE.UPDATE),isShowDelete:(C=(D=(w=e(t))==null?void 0:w.user)==null?void 0:D.modules)==null?void 0:C.includes(e(l).ROLE.DELETE),onOnActionDelete:W},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):n("",!0),P(G,{count:(k=e(a))==null?void 0:k.count,isSucces:e(m)},null,8,["count","isSucces"]),e(V)?(r(),B(J,{key:1})):n("",!0),e(m)&&!((A=e(a))!=null&&A.count)||e(F)?(r(),I("div",_e,ae(s.$t("emptyTableTitle")),1)):n("",!0)])])):n("",!0)}}};export{ge as default};
