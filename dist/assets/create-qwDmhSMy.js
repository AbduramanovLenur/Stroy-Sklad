import{u as X,a as Y,r as g,y as I,c as Z,b as k,d as v,f as B,B as p,w as ee,F as K,e as S,k as m,g as oe,h,o as b,i as f,t as _,z as V,A as re}from"./index-8-F5s4j3.js";import{u as se,r as a}from"./i18n-validators-72j1n4q8.js";import{a as ae,u as le}from"./generic.services-CQjHStj7.js";import{u as F}from"./useQuery-KERFi8ks.js";import{c as te}from"./crud.services-Xs683v05.js";import{m as ie,a as de,e as ne}from"./manual.services-4pjALTqx.js";const ce={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},Ie={__name:"create",async setup(me){let r,l;const j=ae(),w=oe();X(),Y();const L=g(localStorage.getItem("organizationId")),{data:N,isSuccess:q,isLoading:C}=([r,l]=I(()=>F({queryKey:["regions"],queryFn:()=>ie()})),r=await r,l(),r),{data:P,isSuccess:R,isLoading:E}=([r,l]=I(()=>F({queryKey:["districts"],queryFn:()=>de()})),r=await r,l(),r),{data:T,isSuccess:x,isLoading:A}=([r,l]=I(()=>F({queryKey:["objectsList",{organizationId:L}],queryFn:()=>ne(L.value)})),r=await r,l(),r),t=g({fullname:"",numberOfFloors:"",roomsOnFloor:"",address:"",buildingObjectId:[],regionId:[],districtId:[]}),D=Z(()=>({fullname:{required:a},numberOfFloors:{required:a},roomsOnFloor:{required:a},address:{required:a},buildingObjectId:{required:a},regionId:{required:a},districtId:{required:a}})),s=se(D,t),M=g([{id:1,model:"fullname",label:"blocksFullNameLabel",placeholder:"blocksFullNamePlaceholder",icon:"input-company",errorKey:"fullname"},{id:2,model:"numberOfFloors",label:"blocksNumberLabel",placeholder:"blocksNumberPlaceholder",icon:"signature",errorKey:"numberOfFloors"},{id:3,model:"roomsOnFloor",label:"blocksRoomsLabel",placeholder:"blocksRoomsPlaceholder",icon:"door",errorKey:"roomsOnFloor"},{id:4,model:"address",label:"blocksAddressLabel",placeholder:"blocksAddressPlaceholder",icon:"address",errorKey:"address"}]),U=g([{id:1,model:"buildingObjectId",label:"buildIdBlocksLabel",placeholder:"buildIdBlocksPlaceholder",errorKey:"buildingObjectId",options:T,success:x,loading:A},{id:2,model:"regionId",label:"regionBlocksLabel",placeholder:"regionBlocksPlaceholder",errorKey:"regionId",options:N,success:q,loading:C},{id:3,model:"districtId",label:"districtBlocksLabel",placeholder:"districtBlocksPlaceholder",errorKey:"districtId",options:P,success:R,loading:E}]),{mutate:z}=le({onMutate:o=>{o.buildingObjectId=o.buildingObjectId[0],o.regionId=o.regionId[0],o.districtId=o.districtId[0]},mutationFn:o=>te("building_block",o),onSuccess:()=>{j.invalidateQueries({queryKey:["blocks"]}),w.push(re.BLOCKS.path)}}),G=()=>{s.value.$validate(),!s.value.$errors.length&&(z(t.value),s.value.$reset())};return(o,be)=>{var O,$;const Q=h("Title"),H=h("FormInput"),J=h("FormSelect"),W=h("CustomButton");return b(),k("section",ce,[v("div",ue,[B(Q,null,{default:p(()=>[f(`\r
                `+_(o.$t("addNewBlocksTitle"))+`\r
            `,1)]),_:1}),v("form",{class:"manage__form form-manage",onSubmit:ee(G,["prevent"])},[(b(!0),k(K,null,S(M.value,e=>{var i,d,n,c,u;return b(),V(H,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":y=>t.value[e.model]=y,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(d=(i=m(s))==null?void 0:i[e.errorKey])==null?void 0:d.$error,textError:(u=(c=(n=m(s))==null?void 0:n[e.errorKey])==null?void 0:c.$errors[0])==null?void 0:u.$message},{default:p(()=>[f(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(b(!0),k(K,null,S(U.value,e=>{var i,d,n,c,u;return b(),V(J,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":y=>t.value[e.model]=y,width:500,options:e.options,error:(d=(i=m(s))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$error,placeholder:e==null?void 0:e.placeholder,textError:(u=(c=(n=m(s))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:c.$errors[0])==null?void 0:u.$message,success:e.success,loading:e.loading},{default:p(()=>[f(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),B(W,{className:`form__submit ${($=(O=m(s))==null?void 0:O.districtId.$errors[0])!=null&&$.$message?"centered":""}`},{default:p(()=>[f(_(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Ie as default};
//# sourceMappingURL=create-qwDmhSMy.js.map
