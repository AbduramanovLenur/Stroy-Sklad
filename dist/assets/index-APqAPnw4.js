import{n as R,s as V,r as p,q as x,x as H,y as K,b as D,d as U,j as k,g as e,z as q,h as m,t as F,l as r,o as c,A}from"./index-LIAghTzt.js";import{a as j,u as W}from"./generic.services-g7-190gM.js";import{u as $}from"./useQuery-lbUIVZoa.js";import{g as G,d as J}from"./crud.services-v10L7FpB.js";import{r as X}from"./index-YHyICAjd.js";const Y={class:"products"},Z={class:"products__inner section-padding"},ee={key:2,class:"empty-table shadowed"},ce={__name:"index",async setup(te){let s,_;const y=j(),g=R(),{setSearchValue:S,setPagePagination:I}=g,{page:i,limit:u,search:h}=V(g),w=p(localStorage.getItem("organizationId"));x(()=>{S("")}),H(h,()=>{I(1)});const b=p(""),f=X(h,500),B=p([{id:1,label:"productsName",width:725},{id:4,label:"productsState"},{id:5,label:"productsAction"}]),{data:n,isLoading:E,isSuccess:l,isError:M}=([s,_]=K(()=>$({queryKey:["products",{page:i,limit:u,debouncedSearch:f,organizationId:w}],queryFn:()=>G("construction_material",i.value,u.value,f.value),select:t=>{let o=[...t==null?void 0:t.constructionMaterial];return o=o.map(d=>{const a={...d};return delete a.organizationName,a}),{constructionMaterial:o,count:t==null?void 0:t.count}}})),s=await s,_(),s),{mutate:N}=W({mutationFn:t=>J("construction_material",t),onSuccess:()=>{y.invalidateQueries({queryKey:["products"]}),y.invalidateQueries({queryKey:["productsById",b]})}}),z=async t=>{b.value=t,N(t)};return(t,o)=>{var P,T,v,C;const d=r("HeadPage"),a=r("Table"),L=r("Pagination"),O=r("Spinner");return c(),D("section",Y,[U("div",Z,[k(d,{title:"productsTitle",to:e(A).CREATE_PRODUCTS.path,onOnSearch:o[0]||(o[0]=Q=>e(S)(Q))},null,8,["to"]),e(l)&&((P=e(n))!=null&&P.count)?(c(),q(a,{key:0,headers:B.value,table:(T=e(n))==null?void 0:T.constructionMaterial,to:e(A).UPDATE_PRODUCTS.name,options:{page:e(i),limit:e(u)},onOnActionDelete:z},null,8,["headers","table","to","options"])):m("",!0),k(L,{count:(v=e(n))==null?void 0:v.count,isSucces:e(l)},null,8,["count","isSucces"]),e(E)?(c(),q(O,{key:1})):m("",!0),e(l)&&!((C=e(n))!=null&&C.count)||e(M)?(c(),D("div",ee,F(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{ce as default};
//# sourceMappingURL=index-APqAPnw4.js.map
