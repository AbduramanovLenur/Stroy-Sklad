import{u as W,a as X,r as p,y as B,c as j,x as J,b as $,d as N,f as b,B as g,w as Y,F as w,e as K,k as i,g as Z,C as ee,h as f,o as m,i as h,t as y,z as F,A as q}from"./index-8-F5s4j3.js";import{u as ae,r as _}from"./i18n-validators-72j1n4q8.js";import{a as oe,u as te}from"./generic.services-CQjHStj7.js";import{u as z}from"./useQuery-KERFi8ks.js";import{a as re,u as se}from"./crud.services-Xs683v05.js";import{b as ne}from"./manual.services-4pjALTqx.js";const le={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},ye={__name:"update",async setup(de){let t,c;const E=oe(),x=Z(),C=ee();W(),X();const I=p(C.params.id),{data:k,isSuccess:L,isLoading:M}=([t,c]=B(()=>z({queryKey:["states"],queryFn:()=>ne()})),t=await t,c(),t),o=p({id:"",fullName:"",organizationId:"",stateId:[]}),T=j(()=>({id:{required:_},fullName:{required:_},organizationId:{required:_},stateId:{required:_}})),r=ae(T,o),Q=p([{id:1,model:"fullName",label:"nameExpensesLabel",placeholder:"nameExpensesPlaceholder",icon:"input-company",errorKey:"fullName"}]),U=p([{id:1,model:"stateId",label:"stateExpensesLabel",placeholder:"stateExpensesPlaceholder",errorKey:"stateId",options:k,success:L,loading:M}]),{isError:P}=([t,c]=B(()=>z({queryKey:["expensesById",I],queryFn:()=>re("cost",I.value),select:a=>{o.value.id=a.id,o.value.fullName=a.fullname,o.value.organizationId=a.organizationId,o.value.stateId=[a.stateId]}})),t=await t,c(),t);J(P,a=>{a&&x.push(q.HOME.path)});const{mutate:A}=te({onMutate:a=>{a.stateId=a.stateId[0]},mutationFn:a=>se("cost",a),onSuccess:()=>{E.invalidateQueries({queryKey:["expenses"]}),E.invalidateQueries({queryKey:["expensesById",I]}),x.push(q.EXPENSES.path)}}),H=async()=>{const a=localStorage.getItem("organizationId");o.value.organizationId=a,r.value.$validate(),!r.value.$errors.length&&(A(o.value),r.value.$reset())};return(a,ie)=>{var S,V;const R=f("Title"),D=f("FormInput"),G=f("FormSelect"),O=f("CustomButton");return m(),$("section",le,[N("div",ue,[b(R,null,{default:g(()=>[h(`\r
                `+y(a.$t("editExpensesTitle"))+`\r
            `,1)]),_:1}),N("form",{class:"manage__form form-manage",onSubmit:Y(H,["prevent"])},[(m(!0),$(w,null,K(Q.value,e=>{var s,n,l,u,d;return m(),F(D,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":v=>o.value[e.model]=v,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(n=(s=i(r))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,textError:(d=(u=(l=i(r))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:d.$message},{default:g(()=>[h(y(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(m(!0),$(w,null,K(U.value,e=>{var s,n,l,u,d;return m(),F(G,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":v=>o.value[e.model]=v,width:500,options:e.options,error:(n=(s=i(r))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(d=(u=(l=i(r))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:d.$message,success:e.success,loading:e.loading},{default:g(()=>[h(y(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),b(O,{className:`form__submit ${(V=(S=i(r))==null?void 0:S.stateId.$errors[0])!=null&&V.$message?"centered":""}`},{default:g(()=>[h(y(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{ye as default};
//# sourceMappingURL=update-K3rybNHA.js.map
