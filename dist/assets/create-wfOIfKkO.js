import{u as Q,a as R,b as U,y as X,c as y,r as E,d as l,e as N,k as g,h as o,w as A,F as $,C as j,D as S,i as C,l as z,m as c,o as r,s as V,A as G,f as b,t as k,H as J,E as O}from"./index-Znn7x0w2.js";import{u as W,r as Y}from"./i18n-validators-IvsyUnkI.js";import{a as Z,u as ee}from"./generic.services-CuHvXiDr.js";import{c as te}from"./crud.services-oovoAPUX.js";const ae={key:0,class:"manage section-height shadowed"},se={class:"manage__inner section-padding"},ce={__name:"create",setup(oe){const m=Z(),w=z(),x=Q(),{t:B}=R(),T=U(),{user:n}=X(T),M=y(()=>{var e,u;return!!((u=(e=n==null?void 0:n.value.user)==null?void 0:e.modules)!=null&&u.includes(J.EXPENS.CREATE))}),a=E({fullName:""}),F=y(()=>({fullName:{required:Y}})),s=W(F,a),K=E([{id:1,model:"fullName",label:"nameExpensesLabel",placeholder:"nameExpensesPlaceholder",icon:"input-company",errorKey:"fullName"}]),{mutate:q}=ee({mutationFn:e=>te("cost",e),onSuccess:e=>{e!=null&&e.success&&(a.value=O(a.value),m.invalidateQueries({queryKey:["expenses"]}),m.invalidateQueries({queryKey:["costsList"]}),w.push(V.EXPENS.path),setTimeout(()=>x.success(B("createToast")),150))}}),H=()=>{if(s.value.$validate(),s.value.$errors.length)return;const e={...a.value};q(e),s.value.$reset()};return(e,u)=>{var i,d;const P=c("ManageHead"),D=c("FormInput"),I=c("CustomButton");return M.value?(r(),l("section",ae,[N("div",se,[g(P,{title:"addNewExpensesTitle",to:o(V).EXPENS.path},null,8,["to"]),N("form",{class:"manage__form form-manage",onSubmit:A(H,["prevent"])},[(r(!0),l($,null,j(K.value,t=>{var p,_,h,v,f;return r(),l($,{key:t.id},[t!=null&&t.select?C("",!0):(r(),G(D,{key:0,modelValue:a.value[t.model],"onUpdate:modelValue":L=>a.value[t.model]=L,width:500,placeholder:e.$t(t.placeholder),name:t.icon,error:(_=(p=o(s))==null?void 0:p[t.errorKey])==null?void 0:_.$error,textError:(f=(v=(h=o(s))==null?void 0:h[t.errorKey])==null?void 0:v.$errors[0])==null?void 0:f.$message},{default:S(()=>[b(k(e.$t(t.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"]))],64)}),128)),g(I,{className:`form__submit ${(d=(i=o(s))==null?void 0:i.fullName.$errors[0])!=null&&d.$message?"centered":""}`},{default:S(()=>[b(k(e.$t("formButton")),1)]),_:1},8,["className"])],32)])])):C("",!0)}}};export{ce as default};
