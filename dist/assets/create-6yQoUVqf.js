import{u as Y,a as Z,r as g,z as w,c as y,y as ee,d as v,e as O,k as B,h as s,w as re,F as C,C as L,D as f,l as ae,m as h,o as u,B as F,A as q,f as I,t as $}from"./index-qZ69CyC7.js";import{u as oe,r as _}from"./i18n-validators-dGSGbQKY.js";import{a as te,u as se}from"./generic.services-34GP1Yc8.js";import{u as E}from"./useQuery-IZNqF3Xo.js";import{c as ne}from"./crud.services-qYEmjzHd.js";import{m as ie,a as de}from"./manual.services-BxKPmsPu.js";const le={class:"manage section-height shadowed"},ce={class:"manage__inner section-padding"},ve={__name:"create",async setup(ue){let a,m;const j=te(),k=ae();Y(),Z();const K=g(!1),o=g({name:"",address:"",regionId:[],districtId:[]}),{data:M,isSuccess:N,isLoading:x}=([a,m]=w(()=>E({queryKey:["regions"],queryFn:()=>ie()})),a=await a,m(),a),p=y(()=>o.value.regionId),D=y(()=>!!p.value.length);ee(p,()=>{K.value||(o.value.districtId=[])},{immediate:!0});const{data:R,isSuccess:T,isLoading:P}=([a,m]=w(()=>E({queryKey:["districts",{districtId:p}],queryFn:()=>de(p.value),enabled:D})),a=await a,m(),a),Q=y(()=>({name:{required:_},address:{required:_},regionId:{required:_},districtId:{required:_}})),t=oe(Q,o),U=g([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),H=g([{id:1,model:"regionId",label:"regionObjectLabel",placeholder:"regionObjectPlaceholder",errorKey:"regionId",options:M,success:N,loading:x},{id:2,model:"districtId",label:"districtObjectLabel",placeholder:"districtObjectPlaceholder",errorKey:"districtId",options:R,success:T,loading:P}]),{mutate:A}=se({onMutate:r=>{K.value=!0,r.regionId=r.regionId[0],r.districtId=r.districtId[0]},mutationFn:r=>ne("building_object",r),onSuccess:()=>{j.invalidateQueries({queryKey:["objects"]}),j.invalidateQueries({queryKey:["objectsList"]}),k.push(F.OBJECTS.path)}}),G=()=>{t.value.$validate(),!t.value.$errors.length&&(A(o.value),t.value.$reset())};return(r,me)=>{var S,V;const J=h("ManageHead"),z=h("FormInput"),W=h("FormSelect"),X=h("CustomButton");return u(),v("section",le,[O("div",ce,[B(J,{title:"addNewObjectTitle",to:s(F).OBJECTS.path},null,8,["to"]),O("form",{class:"manage__form form-manage",onSubmit:re(G,["prevent"])},[(u(!0),v(C,null,L(U.value,e=>{var n,i,d,l,c;return u(),q(z,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":b=>o.value[e.model]=b,width:500,placeholder:r.$t(e.placeholder),name:e.icon,error:(i=(n=s(t))==null?void 0:n[e.errorKey])==null?void 0:i.$error,textError:(c=(l=(d=s(t))==null?void 0:d[e.errorKey])==null?void 0:l.$errors[0])==null?void 0:c.$message},{default:f(()=>[I($(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(u(!0),v(C,null,L(H.value,e=>{var n,i,d,l,c;return u(),q(W,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":b=>o.value[e.model]=b,width:500,options:e.options,error:(i=(n=s(t))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:i.$error,placeholder:e==null?void 0:e.placeholder,textError:(c=(l=(d=s(t))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:f(()=>[I($(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),B(X,{className:`form__submit ${(V=(S=s(t))==null?void 0:S.districtId.$errors[0])!=null&&V.$message?"centered":""}`},{default:f(()=>[I($(r.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{ve as default};
//# sourceMappingURL=create-6yQoUVqf.js.map
