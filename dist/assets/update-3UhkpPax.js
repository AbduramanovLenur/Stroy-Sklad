import{u as ee,a as ae,r as y,y as p,c as se,x as oe,b as K,d as w,f as B,B as I,w as te,F as V,e as F,k as m,g as re,C as ie,h as b,o as g,i as _,t as v,z as O,A as C}from"./index-qu9jH8U4.js";import{u as ne,r as i}from"./i18n-validators-18WrXdQ3.js";import{a as de,u as le}from"./generic.services-TvKn_bvi.js";import{u as h}from"./useQuery-HXp8dDXQ.js";import{a as ue,u as ce}from"./crud.services-RAdlH-I4.js";import{m as me,a as ge,b as ye}from"./manual.services-HqI37590.js";const pe={class:"manage section-height shadowed"},Ie={class:"manage__inner section-padding"},je={__name:"update",async setup(be){let s,t;const f=de(),j=re(),z=ie();ee(),ae();const $=y(z.params.id),{data:E,isSuccess:k,isLoading:N}=([s,t]=p(()=>h({queryKey:["regions"],queryFn:()=>me()})),s=await s,t(),s),{data:T,isSuccess:x,isLoading:Q}=([s,t]=p(()=>h({queryKey:["districts"],queryFn:()=>ge()})),s=await s,t(),s),{data:R,isSuccess:D,isLoading:M}=([s,t]=p(()=>h({queryKey:["states"],queryFn:()=>ye()})),s=await s,t(),s),o=y({id:"",name:"",address:"",organizationId:"",regionId:"",districtId:"",stateId:""}),U=se(()=>({id:{required:i},name:{required:i},address:{required:i},organizationId:{required:i},regionId:{required:i},districtId:{required:i},stateId:{required:i}})),r=ne(U,o),G=y([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),A=y([{id:1,model:"regionId",label:"regionObjectLabel",options:E,errorKey:"regionId",success:k,loading:N},{id:2,model:"districtId",label:"districtObjectLabel",options:T,errorKey:"districtId",success:x,loading:Q},{id:3,model:"stateId",label:"stateObjectLabel",options:R,success:D,loading:M}]),{isError:H}=([s,t]=p(()=>h({queryKey:["objectById",$],queryFn:()=>ue("building_object",$.value),select:a=>{o.value.id=a.id,o.value.name=a.fullName,o.value.organizationId=a.organizationId,o.value.regionId=a.regionId,o.value.districtId=a.districtId,o.value.address=a.address,o.value.stateId=a.stateId}})),s=await s,t(),s);oe(H,a=>{a&&j.push(C.HOME.path)});const{mutate:P}=le({mutationFn:a=>ce("building_object",a),onSuccess:()=>{f.invalidateQueries({queryKey:["objects"]}),f.invalidateQueries({queryKey:["objectById",$]}),f.invalidateQueries({queryKey:["objectsList"]}),j.push(C.OBJECTS.path)}}),J=async()=>{const a=localStorage.getItem("organizationId");o.value.organizationId=a,r.value.$validate(),!r.value.$errors.length&&(P(o.value),r.value.$reset())};return(a,_e)=>{var q,L;const W=b("Title"),X=b("FormInput"),Y=b("FormSelect"),Z=b("CustomButton");return g(),K("section",pe,[w("div",Ie,[B(W,null,{default:I(()=>[_(`\r
                `+v(a.$t("editObjectTitle"))+`\r
            `,1)]),_:1}),w("form",{class:"manage__form form-manage",onSubmit:te(J,["prevent"])},[(g(!0),K(V,null,F(G.value,e=>{var n,d,l,u,c;return g(),O(X,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":S=>o.value[e.model]=S,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(d=(n=m(r))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(r))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message},{default:I(()=>[_(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(g(!0),K(V,null,F(A.value,e=>{var n,d,l,u,c;return g(),O(Y,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":S=>o.value[e.model]=S,width:500,options:e.options,error:(d=(n=m(r))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$error,textError:(c=(u=(l=m(r))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:I(()=>[_(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),B(Z,{className:`form__submit ${(L=(q=m(r))==null?void 0:q.stateId.$errors[0])!=null&&L.$message?"centered":""}`},{default:I(()=>[_(v(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{je as default};
//# sourceMappingURL=update-3UhkpPax.js.map
