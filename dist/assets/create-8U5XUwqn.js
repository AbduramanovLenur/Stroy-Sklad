import{u as R,a as U,b as A,y as P,c as y,r as C,d as l,e as g,k as $,h as o,w as j,F as N,C as z,D as S,i as T,l as G,m as c,o as r,s as b,A as J,f as V,t as k,H as W,E as X}from"./index--ASsptNz.js";import{u as Y,r as Z}from"./i18n-validators-hHlX57Cz.js";import{u as ee}from"./generic.services-OmFX1-7T.js";import{u as te}from"./useMutation-KDcbY73c.js";import{c as ae}from"./crud.services-J6Vd6xLE.js";const se={key:0,class:"manage section-height shadowed"},oe={class:"manage__inner section-padding"},ie={__name:"create",setup(re){const m=ee(),w=G(),B=R(),{t:E}=U(),M=A(),{user:n}=P(M),F=y(()=>{var e,u;return!!((u=(e=n==null?void 0:n.value.user)==null?void 0:e.modules)!=null&&u.includes(W.COST.CREATE))}),a=C({fullName:""}),K=y(()=>({fullName:{required:Z}})),s=Y(K,a),q=C([{id:1,model:"fullName",label:"nameCostsLabel",placeholder:"nameCostsPlaceholder",icon:"input-company",errorKey:"fullName"}]),{mutate:H,status:x}=te({mutationFn:e=>ae("cost",e),onSuccess:e=>{e!=null&&e.success&&(a.value=X(a.value),m.invalidateQueries({queryKey:["costs"]}),m.invalidateQueries({queryKey:["costsList"]}),w.push(b.COST.path),setTimeout(()=>B.success(E("createToast")),150))}}),D=()=>{if(s.value.$validate(),s.value.$errors.length)return;const e={...a.value};H(e),s.value.$reset()};return(e,u)=>{var i,d;const I=c("ManageHead"),L=c("FormInput"),O=c("CustomButton");return F.value?(r(),l("section",se,[g("div",oe,[$(I,{title:"addNewCostsTitle",to:o(b).COST.path},null,8,["to"]),g("form",{class:"manage__form form-manage",onSubmit:j(D,["prevent"])},[(r(!0),l(N,null,z(q.value,t=>{var p,_,h,v,f;return r(),l(N,{key:t.id},[t!=null&&t.select?T("",!0):(r(),J(L,{key:0,modelValue:a.value[t.model],"onUpdate:modelValue":Q=>a.value[t.model]=Q,width:500,placeholder:e.$t(t.placeholder),name:t.icon,error:(_=(p=o(s))==null?void 0:p[t.errorKey])==null?void 0:_.$error,textError:(f=(v=(h=o(s))==null?void 0:h[t.errorKey])==null?void 0:v.$errors[0])==null?void 0:f.$message},{default:S(()=>[V(k(e.$t(t.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"]))],64)}),128)),$(O,{className:`form__submit ${(d=(i=o(s))==null?void 0:i.fullName.$errors[0])!=null&&d.$message?"centered":""}`,disabled:o(x)==="pending"},{default:S(()=>[V(k(e.$t("formButton")),1)]),_:1},8,["className","disabled"])],32)])])):T("",!0)}}};export{ie as default};
