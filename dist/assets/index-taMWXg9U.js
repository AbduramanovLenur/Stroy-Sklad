import{q as V,s as x,r as p,x as z,y as H,z as K,d as k,e as U,k as q,h as e,A as D,i as m,t as F,m as c,o as i,B as A}from"./index-qZ69CyC7.js";import{a as W,u as $}from"./generic.services-34GP1Yc8.js";import{u as j}from"./useQuery-IZNqF3Xo.js";import{g as G,d as J}from"./crud.services-qYEmjzHd.js";import{r as X}from"./index-hYdXxYyx.js";const Y={class:"products"},Z={class:"products__inner section-padding"},ee={key:2,class:"empty-table shadowed"},ce={__name:"index",async setup(te){let n,_;const y=W(),g=V(),{setSearchValue:S,setPagePagination:B}=g,{page:u,limit:l,search:h}=x(g),I=p(localStorage.getItem("organizationId"));z(()=>{S("")}),H(h,()=>{B(1)});const b=p(""),f=X(h,500),N=p([{id:1,label:"productsName",width:725},{id:4,label:"productsState"},{id:5,label:"productsAction"}]),{data:a,isLoading:w,isSuccess:d,isError:E}=([n,_]=K(()=>j({queryKey:["products",{page:u,limit:l,debouncedSearch:f,organizationId:I}],queryFn:()=>G("construction_material",u.value,l.value,f.value),select:t=>{let o=[...t==null?void 0:t.constructionMaterial];return o=o.map(r=>{const s={...r,material:r.fullName};return delete s.fullName,delete s.quantityType,s}),{constructionMaterial:o,count:t==null?void 0:t.count}}})),n=await n,_(),n),{mutate:M}=$({mutationFn:t=>J("construction_material",t),onSuccess:()=>{y.invalidateQueries({queryKey:["products"]}),y.invalidateQueries({queryKey:["productsById",b]})}}),L=async t=>{b.value=t,M(t)};return(t,o)=>{var T,P,v,C;const r=c("HeadPage"),s=c("Table"),O=c("Pagination"),Q=c("Spinner");return i(),k("section",Y,[U("div",Z,[q(r,{title:"productsTitle",to:e(A).CREATE_PRODUCTS.path,onOnSearch:o[0]||(o[0]=R=>e(S)(R))},null,8,["to"]),e(d)&&((T=e(a))!=null&&T.count)?(i(),D(s,{key:0,headers:N.value,table:(P=e(a))==null?void 0:P.constructionMaterial,to:e(A).UPDATE_PRODUCTS.name,options:{page:e(u),limit:e(l)},onOnActionDelete:L},null,8,["headers","table","to","options"])):m("",!0),q(O,{count:(v=e(a))==null?void 0:v.count,isSucces:e(d)},null,8,["count","isSucces"]),e(w)?(i(),D(Q,{key:1})):m("",!0),e(d)&&!((C=e(a))!=null&&C.count)||e(E)?(i(),k("div",ee,F(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{ce as default};
//# sourceMappingURL=index-taMWXg9U.js.map
