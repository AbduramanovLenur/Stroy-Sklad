import{u as de,a as ie,r as d,y as b,c as S,x as C,b as $,d as E,j as M,g as i,w as ne,F as k,B as x,C as K,k as le,D as ue,l as v,o as p,A as L,z as N,e as O,t as q}from"./index-LIAghTzt.js";import{u as ce,r as n}from"./i18n-validators-Soiy62qZ.js";import{a as me,u as ge}from"./generic.services-g7-190gM.js";import{u as y}from"./useQuery-lbUIVZoa.js";import{a as pe,u as he}from"./crud.services-v10L7FpB.js";import{m as be,a as ve,b as ye}from"./manual.services-T8eI6v5K.js";const Ie={class:"manage section-height shadowed"},_e={class:"manage__inner section-padding"},Be={__name:"update",async setup(fe){let s,r;const I=me(),B=le(),R=ue();de(),ie();const _=d(R.params.id),w=d(!1),f=d(!1),t=d({id:"",name:"",address:"",regionId:[],districtId:[],stateId:[]}),{data:D,isSuccess:Q,isLoading:T}=([s,r]=b(()=>y({queryKey:["regions"],queryFn:()=>be()})),s=await s,r(),s),h=S(()=>t.value.regionId),H=S(()=>!!h.value.length);C(h,()=>{!f.value&&!w.value&&(t.value.districtId=[]),f.value=!1},{immediate:!0});const{data:P,isSuccess:U,isLoading:G}=([s,r]=b(()=>y({queryKey:["districts",{districtId:h}],queryFn:()=>ve(h.value),enabled:H})),s=await s,r(),s),{data:A,isSuccess:J,isLoading:z}=([s,r]=b(()=>y({queryKey:["states"],queryFn:()=>ye()})),s=await s,r(),s),W=S(()=>({id:{required:n},name:{required:n},address:{required:n},regionId:{required:n},districtId:{required:n},stateId:{required:n}})),o=ce(W,t),X=d([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),Y=d([{id:1,model:"regionId",label:"regionObjectLabel",placeholder:"regionObjectPlaceholder",options:D,errorKey:"regionId",success:Q,loading:T},{id:2,model:"districtId",label:"districtObjectLabel",placeholder:"districtObjectPlaceholder",options:P,errorKey:"districtId",success:U,loading:G},{id:3,model:"stateId",label:"stateObjectLabel",placeholder:"stateObjectLabel",options:A,success:J,loading:z}]),{isError:Z}=([s,r]=b(()=>y({queryKey:["objectById",_],queryFn:()=>pe("building_object",_.value),select:a=>{t.value.id=a.id,t.value.name=a.fullName,t.value.address=a.address,t.value.regionId=[a.regionId],t.value.districtId=[a.districtId],t.value.stateId=[a.stateId],f.value=!0}})),s=await s,r(),s);C(Z,a=>{a&&B.push(L.HOME.path)});const{mutate:ee}=ge({onMutate:a=>{w.value=!0,a.regionId=a.regionId[0],a.districtId=a.districtId[0],a.stateId=a.stateId[0]},mutationFn:a=>he("building_object",a),onSuccess:()=>{I.invalidateQueries({queryKey:["objects"]}),I.invalidateQueries({queryKey:["objectById",_]}),I.invalidateQueries({queryKey:["objectsList"]}),B.push(L.OBJECTS.path)}}),ae=async()=>{o.value.$validate(),!o.value.$errors.length&&(ee(t.value),o.value.$reset())};return(a,je)=>{var F,V;const se=v("ManageHead"),te=v("FormInput"),re=v("FormSelect"),oe=v("CustomButton");return p(),$("section",Ie,[E("div",_e,[M(se,{title:"editObjectTitle",to:i(L).OBJECTS.path},null,8,["to"]),E("form",{class:"manage__form form-manage",onSubmit:ne(ae,["prevent"])},[(p(!0),$(k,null,x(X.value,e=>{var l,u,c,m,g;return p(),N(te,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":j=>t.value[e.model]=j,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(u=(l=i(o))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(g=(m=(c=i(o))==null?void 0:c[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:g.$message},{default:K(()=>[O(q(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),$(k,null,x(Y.value,e=>{var l,u,c,m,g;return p(),N(re,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":j=>t.value[e.model]=j,width:500,options:e.options,error:(u=(l=i(o))==null?void 0:l[e==null?void 0:e.errorKey])==null?void 0:u.$error,placeholder:e==null?void 0:e.placeholder,textError:(g=(m=(c=i(o))==null?void 0:c[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:g.$message,success:e.success,loading:e.loading},{default:K(()=>[O(q(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),M(oe,{className:`form__submit ${(V=(F=i(o))==null?void 0:F.stateId.$errors[0])!=null&&V.$message?"centered":""}`},{default:K(()=>[O(q(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Be as default};
//# sourceMappingURL=update-FeXiQvAm.js.map
