import{_ as Q,n as V,s as F,r as d,q as H,x as K,y as L,b as I,d as M,j as P,g as e,z,h as p,t as G,l as r,o as i,A as R}from"./index-90cmhfpq.js";import{a as j,u as W}from"./generic.services-UXrdyhxI.js";import{u as $}from"./useQuery-7_07upSr.js";import{g as J,d as X}from"./crud.services-IxzF5w0J.js";import{r as Y}from"./index-fOfPrRnA.js";const Z={class:"employees"},ee={class:"employees__inner section-padding"},te={key:2,class:"empty-table shadowed"},oe={__name:"index",async setup(se){let n,y;const _=j(),g=V(),{setSearchValue:h,setPagePagination:k}=g,{page:c,limit:u,search:b}=F(g),S=d(localStorage.getItem("organizationId"));H(()=>{h("")}),K(b,()=>{k(1)});const f=d(""),v=Y(b,500),q=d([{id:1,label:"employeesFullName",width:300},{id:2,label:"employeesOrganization",width:320},{id:3,label:"employeesPhone",width:255},{id:4,label:"employeesRole",width:195},{id:5,label:"employeesState"},{id:8,label:"employeesAction"}]),{data:l,isLoading:A,isSuccess:m,isError:C}=([n,y]=L(()=>$({queryKey:["orgUser",{page:c,limit:u,debouncedSearch:v,organizationId:S}],queryFn:()=>J("user",c.value,u.value,v.value,{organizationId:S.value}),select:t=>{let a={...t};return a.users=t==null?void 0:t.users.map(o=>{const s={...o,phone:o.phoneNumber,company:o.organizationName,name:o.fullName};return delete s.fullName,delete s.phoneNumber,delete s.organizationName,s}),a}})),n=await n,y(),n),{mutate:U}=W({mutationFn:t=>X("user",t),onSuccess:()=>{_.invalidateQueries({queryKey:["orgUser"]}),_.invalidateQueries({queryKey:["orgUserById",f]})}}),x=t=>{f.value=t,U(t)};return(t,a)=>{var N,E,T,w;const o=r("HeadPage"),s=r("Table"),B=r("Pagination"),O=r("Spinner");return i(),I("section",Z,[M("div",ee,[P(o,{title:"employeesTitle",to:e(R).CREATE_ORG_USER.path,onOnSearch:a[0]||(a[0]=D=>e(h)(D))},null,8,["to"]),e(m)&&((N=e(l))!=null&&N.count)?(i(),z(s,{key:0,headers:q.value,table:(E=e(l))==null?void 0:E.users,to:e(R).UPDATE_ORG_USER.name,options:{page:e(c),limit:e(u)},onOnActionDelete:x},null,8,["headers","table","to","options"])):p("",!0),P(B,{count:(T=e(l))==null?void 0:T.count,isSucces:e(m)},null,8,["count","isSucces"]),e(A)?(i(),z(O,{key:1})):p("",!0),e(m)&&!((w=e(l))!=null&&w.count)||e(C)?(i(),I("div",te,G(t.$t("emptyTableTitle")),1)):p("",!0)])])}}},ce=Q(oe,[["__scopeId","data-v-e4b8a72e"]]);export{ce as default};
//# sourceMappingURL=index-kkTwn21u.js.map
