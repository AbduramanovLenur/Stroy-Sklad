import{g as X,d as Y}from"./crud.services-6H1cbtzh.js";import{u as Z,a as ee,x as te,y as O,b as se,c as oe,r as q,z as ae,d as L,e as ne,k as Q,h as e,A as I,i,t as ie,m as c,o as u,s as J,H as r}from"./index-qYaOSAk5.js";import{a as ce,u as ue}from"./generic.services-uSp9rJcx.js";import{u as re}from"./useQuery-3KlBkAoQ.js";import{r as le}from"./index-_P5IqAvG.js";const de={key:0,class:"object"},me={class:"object__inner section-padding"},be={key:2,class:"empty-table shadowed"},Ee={__name:"index",async setup(_e){let a,_;const o=ce(),K=Z(),{t:P}=ee(),U=te(),{page:l,limit:d,search:H}=O(U),N=se(),{user:s}=O(N),y=oe(()=>{var t,b;return!!((b=(t=s==null?void 0:s.value.user)==null?void 0:t.modules)!=null&&b.includes(r.OBJECT.READ))}),p=q(""),h=le(H,500),R=q([{id:1,label:"objectName",width:40},{id:2,label:"objectAddress",width:30}]),{data:n,isLoading:x,isSuccess:m,isError:z}=([a,_]=ae(()=>re({queryKey:["objects",{page:l,limit:d,debouncedSearch:h,organizationId:s.value.user.organizationId}],queryFn:()=>X("building_object",l.value,d.value,h.value),enabled:y})),a=await a,_(),a),{mutate:V}=ue({mutationFn:t=>Y("building_object",t),onSuccess:t=>{t!=null&&t.success&&(o.invalidateQueries({queryKey:["objects"]}),o.invalidateQueries({queryKey:["objectById",p]}),o.invalidateQueries({queryKey:["objectsList"]}),o.invalidateQueries({queryKey:["blocks"]}),o.invalidateQueries({queryKey:["blocksList"]}),setTimeout(()=>K.success(P("deleteToast")),150))}}),F=async t=>{p.value=t,V(t)};return(t,b)=>{var T,S,E,g,j,v,C,f,w,B,k,D,A;const M=c("HeadPage"),W=c("Table"),$=c("Pagination"),G=c("Spinner");return y.value?(u(),L("section",de,[ne("div",me,[Q(M,{title:"objectTitle",to:e(J).CREATE_OBJECT.path,isShowCreate:(E=(S=(T=e(s))==null?void 0:T.user)==null?void 0:S.modules)==null?void 0:E.includes(e(r).OBJECT.CREATE)},null,8,["to","isShowCreate"]),e(m)&&((g=e(n))!=null&&g.count)?(u(),I(W,{key:0,headers:R.value,table:(j=e(n))==null?void 0:j.objects,to:e(J).UPDATE_OBJECT.name,options:{page:e(l),limit:e(d)},isShowUpdate:(f=(C=(v=e(s))==null?void 0:v.user)==null?void 0:C.modules)==null?void 0:f.includes(e(r).OBJECT.UPDATE),isShowDelete:(k=(B=(w=e(s))==null?void 0:w.user)==null?void 0:B.modules)==null?void 0:k.includes(e(r).OBJECT.DELETE),onOnActionDelete:F},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):i("",!0),Q($,{count:(D=e(n))==null?void 0:D.count,isSucces:e(m)},null,8,["count","isSucces"]),e(x)?(u(),I(G,{key:1})):i("",!0),e(m)&&!((A=e(n))!=null&&A.count)||e(z)?(u(),L("div",be,ie(t.$t("emptyTableTitle")),1)):i("",!0)])])):i("",!0)}}};export{Ee as default};
