import{u as X,a as Y,r as g,y as k,c as Z,b as F,d as K,f as O,B as p,w as ee,F as B,e as S,k as m,g as oe,h as y,o as b,i as f,t as _,z as V,A as re}from"./index-Lv7ic83i.js";import{u as se,r as a}from"./i18n-validators-8szgixBa.js";import{a as ae,u as te}from"./generic.services-CPrETf56.js";import{u as I}from"./useQuery-lDv7UXdT.js";import{c as le}from"./crud.services-33u2viHl.js";import{m as ne,a as ie,e as de}from"./manual.services-myeRcQdP.js";const ce={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},ke={__name:"create",async setup(me){let o,t;const w=ae(),N=oe();X(),Y();const L=g(localStorage.getItem("organizationId")),{data:j,isSuccess:q,isLoading:C}=([o,t]=k(()=>I({queryKey:["regions"],queryFn:()=>ne()})),o=await o,t(),o),{data:R,isSuccess:E,isLoading:T}=([o,t]=k(()=>I({queryKey:["districts"],queryFn:()=>ie()})),o=await o,t(),o),{data:x,isSuccess:A,isLoading:D}=([o,t]=k(()=>I({queryKey:["objectsList",{organizationId:L}],queryFn:()=>de(L.value)})),o=await o,t(),o),l=g({fullname:"",numberOfFloors:"",roomsOnFloor:"",address:"",buildingObjectId:"",regionId:"",districtId:""}),P=Z(()=>({fullname:{required:a},numberOfFloors:{required:a},roomsOnFloor:{required:a},address:{required:a},buildingObjectId:{required:a},regionId:{required:a},districtId:{required:a}})),r=se(P,l),U=g([{id:1,model:"fullname",label:"blocksFullNameLabel",placeholder:"blocksFullNamePlaceholder",icon:"input-company",errorKey:"fullname"},{id:2,model:"numberOfFloors",label:"blocksNumberLabel",placeholder:"blocksNumberPlaceholder",icon:"signature",errorKey:"numberOfFloors"},{id:3,model:"roomsOnFloor",label:"blocksRoomsLabel",placeholder:"blocksRoomsPlaceholder",icon:"door",errorKey:"roomsOnFloor"},{id:4,model:"address",label:"blocksAddressLabel",placeholder:"blocksAddressPlaceholder",icon:"address",errorKey:"address"}]),z=g([{id:1,model:"buildingObjectId",label:"buildIdBlocksLabel",options:x,errorKey:"buildingObjectId",success:A,loading:D},{id:2,model:"regionId",label:"regionBlocksLabel",options:j,errorKey:"regionId",success:q,loading:C},{id:3,model:"districtId",label:"districtBlocksLabel",options:R,errorKey:"districtId",success:E,loading:T}]),{mutate:G}=te({mutationFn:s=>le("building_block",s),onSuccess:()=>{w.invalidateQueries({queryKey:["blocks"]}),N.push(re.BLOCKS.path)}}),M=()=>{r.value.$validate(),!r.value.$errors.length&&(G(l.value),r.value.$reset())};return(s,be)=>{var $,v;const Q=y("Title"),H=y("FormInput"),J=y("FormSelect"),W=y("CustomButton");return b(),F("section",ce,[K("div",ue,[O(Q,null,{default:p(()=>[f(`\r
                `+_(s.$t("addNewBlocksTitle"))+`\r
            `,1)]),_:1}),K("form",{class:"manage__form form-manage",onSubmit:ee(M,["prevent"])},[(b(!0),F(B,null,S(U.value,e=>{var n,i,d,c,u;return b(),V(H,{key:e.id,modelValue:l.value[e.model],"onUpdate:modelValue":h=>l.value[e.model]=h,width:500,placeholder:s.$t(e.placeholder),name:e.icon,error:(i=(n=m(r))==null?void 0:n[e.errorKey])==null?void 0:i.$error,textError:(u=(c=(d=m(r))==null?void 0:d[e.errorKey])==null?void 0:c.$errors[0])==null?void 0:u.$message},{default:p(()=>[f(_(s.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(b(!0),F(B,null,S(z.value,e=>{var n,i,d,c,u;return b(),V(J,{key:e.id,modelValue:l.value[e.model],"onUpdate:modelValue":h=>l.value[e.model]=h,width:500,options:e.options,error:(i=(n=m(r))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:i.$error,textError:(u=(c=(d=m(r))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:c.$errors[0])==null?void 0:u.$message,success:e.success,loading:e.loading},{default:p(()=>[f(_(s.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),O(W,{className:`form__submit ${(v=($=m(r))==null?void 0:$.districtId.$errors[0])!=null&&v.$message?"centered":""}`},{default:p(()=>[f(_(s.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{ke as default};
//# sourceMappingURL=create-ZxmO4WIi.js.map
