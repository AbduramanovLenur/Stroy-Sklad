import{_ as he,n as fe,s as Fe,r as l,c as $,q as _,d as c,o as d,e as f,f as A,l as K,j as s,x as F,k as L,t as S,y as q,F as H,g as P,h as V,w as Se}from"./index-lIBmWoQk.js";import{d as qe,u as Oe,a as M,c as R,b as j}from"./generic.services-wyHkLZNP.js";import{u as I,c as we,a as $e,d as Ke,m as Le,b as Ve,e as Me,g as Be,f as Te}from"./manual.services-hDEKQQqT.js";const ke={class:"object"},Ee={class:"object__inner section-padding"},Ne={key:2,class:"empty-table"},ze={__name:"objects",async setup(Ce){let o,n;const m=qe(),B=fe(),{toggleIsOpenModalForm:T}=B,{isOpenModalForm:O}=Fe(B),k=l("addNewObjectTitle"),b=l(""),g=l(0),E=$(()=>O),N=$(()=>O&&b.value==="edit"),{data:U,isSuccess:G,isLoading:W}=([o,n]=_(()=>I({queryKey:["regions"],queryFn:()=>Le(),enabled:E})),o=await o,n(),o),{data:J,isSuccess:X,isLoading:Y}=([o,n]=_(()=>I({queryKey:["districts"],queryFn:()=>Ve(),enabled:E})),o=await o,n(),o),{data:Z,isSuccess:ee,isLoading:te}=([o,n]=_(()=>I({queryKey:["states"],queryFn:()=>Me(),enabled:N})),o=await o,n(),o),a=l({id:"",name:"",organizationId:"",regionId:"",districtId:"",address:"",stateId:"",search:""}),ae=$(()=>({name:{required:j},organizationId:{required:j},regionId:{required:j},districtId:{required:j},address:{required:j}})),oe=l([{id:1,label:"objectName"},{id:2,label:"objectOrganization"},{id:3,label:"objectAddress"},{id:4,label:"objectState"},{id:5,label:"objectAction"}]),se=l([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),re=l([{id:1,model:"regionId",label:"regionObjectLabel",options:U,errorKey:"regionId",success:G,loading:W,show:["create","edit"]},{id:2,model:"districtId",label:"districtObjectLabel",options:J,errorKey:"districtId",success:X,loading:Y,show:["create","edit"]},{id:3,model:"stateId",label:"stateObjectLabel",options:Z,success:ee,loading:te,show:"update",show:["edit"]}]),i=Oe(ae,a),{data:w,isLoading:ne,isSuccess:z,isError:ie}=([o,n]=_(()=>I({queryKey:["objects"],queryFn:()=>Be("building_object")})),o=await o,n(),o);[o,n]=_(()=>I({queryKey:["objectById",g],queryFn:()=>Te("building_object",g.value),select:e=>{a.value.id=e.id,a.value.name=e.fullname,a.value.organizationId=e.organizationId,a.value.regionId=e.regionId,a.value.districtId=e.districtId,a.value.address=e.address,a.value.stateId=e.stateId},enabled:N})),o=await o,n();const{mutate:de}=M({mutationFn:e=>we("building_object",e),onSuccess:()=>{m.invalidateQueries({queryKey:["objects"]})}}),{mutate:le}=M({mutationFn:e=>$e("building_object",e),onSuccess:()=>{m.invalidateQueries({queryKey:["objects"]}),m.invalidateQueries({queryKey:["objectById",g]})}}),{mutate:ce}=M({mutationFn:e=>Ke("building_object",e),onSuccess:()=>{m.invalidateQueries({queryKey:["objects"]}),m.invalidateQueries({queryKey:["objectById",g]})}}),C=(e,r)=>{k.value=e,b.value=r,T(),b.value==="create"&&O.value&&(a.value=R(a.value),i.value.$reset())},Q=(e,r)=>{if(e==="edit"&&r){g.value=r,C("editObjectTitle","edit");return}C("addNewObjectTitle","create")},ue=async e=>{ce(e)},me=async()=>{a.value.organizationId=1,i.value.$validate(),!i.value.$errors.length&&(b.value==="create"?(delete a.value.id,delete a.value.stateId,delete a.value.search,de(a.value)):le(a.value),a.value=R(a.value),T(),i.value.$reset())};return(e,r)=>{const be=c("HeadPage"),ge=c("Table"),ye=c("Spinner"),ve=c("FormInput"),pe=c("FormSelect"),_e=c("CustomButton"),je=c("FormModal");return d(),f("section",ke,[A("div",Ee,[K(be,{title:"objectTitle",onOnSearch:r[0]||(r[0]=u=>a.value.search=u),onOnOpenFormModal:r[1]||(r[1]=()=>Q("create"))}),s(z)&&s(w).length?(d(),F(ge,{key:0,headers:oe.value,table:s(w),onOnActionEdit:r[2]||(r[2]=u=>Q("edit",u)),onOnActionDelete:ue},null,8,["headers","table"])):L("",!0),s(ne)?(d(),F(ye,{key:1})):L("",!0),s(z)&&!s(w).length||s(ie)?(d(),f("div",Ne,S(e.$t("emptyTableTitle")),1)):L("",!0)]),K(je,{title:k.value},{default:q(()=>{var u,D;return[A("form",{class:"object__form",onSubmit:Se(me,["prevent"])},[(d(!0),f(H,null,P(se.value,t=>{var y,v,p;return d(),F(ve,{key:t.id,modelValue:a.value[t.model],"onUpdate:modelValue":h=>a.value[t.model]=h,width:500,placeholder:e.$t(t.placeholder),name:t.icon,error:(y=s(i))==null?void 0:y[t.errorKey].$error,textError:(p=(v=s(i))==null?void 0:v[t.errorKey].$errors[0])==null?void 0:p.$message},{default:q(()=>[V(S(e.$t(t.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(d(!0),f(H,null,P(re.value,t=>{var y,v,p,h,x;return d(),F(pe,{key:t.id,modelValue:a.value[t.model],"onUpdate:modelValue":Ie=>a.value[t.model]=Ie,width:500,options:t.options,error:(v=(y=s(i))==null?void 0:y[t==null?void 0:t.errorKey])==null?void 0:v.$error,textError:(x=(h=(p=s(i))==null?void 0:p[t==null?void 0:t.errorKey])==null?void 0:h.$errors[0])==null?void 0:x.$message,success:t.success,loading:t.loading,show:t==null?void 0:t.show,requestFlag:b.value},{default:q(()=>[V(S(e.$t(t.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading","show","requestFlag"])}),128)),K(_e,{className:`form__submit ${(D=(u=s(i))==null?void 0:u.districtId.$errors[0])!=null&&D.$message?"centered":""}`},{default:q(()=>[V(S(e.$t("formButton")),1)]),_:1},8,["className"])],32)]}),_:1},8,["title"])])}}},Ae=he(ze,[["__scopeId","data-v-df01810a"]]);export{Ae as default};
//# sourceMappingURL=objects-5zg1FS4D.js.map
