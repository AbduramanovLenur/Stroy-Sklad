import{g as M,d as O}from"./crud.services-J6Vd6xLE.js";import{_ as Q,u as F,a as H,x as K,y as R,r as S,z as V,d as T,e as Y,k as v,h as t,A as N,i as p,t as U,m as l,o as i,s as P}from"./index--ASsptNz.js";import{u as W}from"./generic.services-OmFX1-7T.js";import{u as $}from"./useQuery-aJZefqwx.js";import{u as j}from"./useMutation-KDcbY73c.js";import{r as G}from"./index-QW6gxCzp.js";const J={class:"employees"},X={class:"employees__inner section-padding"},Z={key:2,class:"empty-table shadowed"},ee={__name:"index",async setup(te){let a,d;const y=W(),k=F(),{t:w}=H(),C=K(),{page:r,limit:c,search:q}=R(C),_=S(""),h=G(q,500),x=S([{id:1,label:"employeesFullName",width:30},{id:2,label:"employeesOrganization",width:30},{id:3,label:"employeesPhone",width:20},{id:4,label:"employeesRole",width:15}]),{data:n,isLoading:A,isSuccess:u,isError:B}=([a,d]=V(()=>$({queryKey:["employees",{page:r,limit:c,debouncedSearch:h}],queryFn:()=>M("user",r.value,c.value,h.value),select:e=>{let m={...e};return m.users=e==null?void 0:e.users.map(s=>{const o={...s,phone:s.phoneNumber,company:s.organizationName,name:s.fullName};return delete o.fullName,delete o.phoneNumber,delete o.organizationName,o}),m}})),a=await a,d(),a),{mutate:I}=j({mutationFn:e=>O("user",e),onSuccess:e=>{e!=null&&e.success&&(y.invalidateQueries({queryKey:["employees"]}),y.invalidateQueries({queryKey:["employeeById",_]}),setTimeout(()=>k.success(w("deleteToast")),150))}}),L=e=>{_.value=e,I(e)};return(e,m)=>{var b,f,g,E;const s=l("HeadPage"),o=l("Table"),z=l("Pagination"),D=l("Spinner");return i(),T("section",J,[Y("div",X,[v(s,{title:"employeesTitle",to:t(P).CREATE_EMPLOYEES.path},null,8,["to"]),t(u)&&((b=t(n))!=null&&b.count)?(i(),N(o,{key:0,headers:x.value,table:(f=t(n))==null?void 0:f.users,to:t(P).UPDATE_EMPLOYEES.name,options:{page:t(r),limit:t(c)},onOnActionDelete:L},null,8,["headers","table","to","options"])):p("",!0),v(z,{count:(g=t(n))==null?void 0:g.count,isSucces:t(u)},null,8,["count","isSucces"]),t(A)?(i(),N(D,{key:1})):p("",!0),t(u)&&!((E=t(n))!=null&&E.count)||t(B)?(i(),T("div",Z,U(e.$t("emptyTableTitle")),1)):p("",!0)])])}}},re=Q(ee,[["__scopeId","data-v-4cbed5b4"]]);export{re as default};
