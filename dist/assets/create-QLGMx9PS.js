import{u as Y,a as j,b as J,x as W,c as L,r as g,y as X,d as f,e as S,k as V,h as s,w as Z,F as R,C as K,D as N,i as ee,l as oe,m as h,o as c,A as C,z as F,f as b,t as v,G as re}from"./index-JvbhfmnW.js";import{u as ae,r as l,m as se}from"./i18n-validators-pdrHvBMx.js";import{a as le,u as te}from"./generic.services-nPQjChLr.js";import{u as ne}from"./useQuery-83Oo_vnt.js";import{c as de}from"./crud.services-ysnFdDpK.js";import{e as ue}from"./manual.services-jHvvpFhH.js";const me={key:0,class:"manage section-height shadowed"},ie={class:"manage__inner section-padding"},Ne={__name:"create",async setup(ce){let p,w;const P=le(),M=oe();Y(),j();const U=J(),{user:t}=W(U),$=L(()=>{var o,y;return!!((y=(o=t==null?void 0:t.value.user)==null?void 0:o.modules)!=null&&y.includes(re.EMPLOYEES.CREATE))}),a=g({fullName:"",userName:"",password:"",phoneNumber:"",organizationId:t.value.user.organizationId,roleId:[]}),k=L(()=>({fullName:{required:l},userName:{required:l},password:{required:l,minLength:se},phoneNumber:{required:l},organizationId:{required:l},roleId:{required:l}})),r=ae(k,a),{data:B,isSuccess:x,isLoading:z}=([p,w]=X(()=>ne({queryKey:["rolesList",{organizationId:t.value.user.organizationId}],queryFn:()=>ue(),enabled:$})),p=await p,w(),p),q=g([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password",errorKey:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),T=g([{id:1,model:"roleId",label:"employeesRoleLabel",placeholder:"employeesRolePlaceholder",errorKey:"roleId",options:B,success:x,loading:z}]),{mutate:G}=te({onMutate:o=>{o.roleId=o.roleId[0]},mutationFn:o=>de("user",o),onSuccess:()=>{P.invalidateQueries({queryKey:["orgUsers"]}),M.push(C.ORG_USER.path)}}),A=()=>{r.value.$validate(),!r.value.$errors.length&&(G(a.value),r.value.$reset())};return(o,y)=>{var I,E;const H=h("ManageHead"),O=h("FormInput"),Q=h("FormSelect"),D=h("CustomButton");return $.value?(c(),f("section",me,[S("div",ie,[V(H,{title:"addNewEmployeesTitle",to:s(C).ORG_USER.path},null,8,["to"]),S("form",{class:"manage__form form-manage",onSubmit:Z(A,["prevent"])},[(c(!0),f(R,null,K(q.value,e=>{var n,d,u,m,i;return c(),F(O,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":_=>a.value[e.model]=_,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(d=(n=s(r))==null?void 0:n[e.errorKey])==null?void 0:d.$error,textError:(i=(m=(u=s(r))==null?void 0:u[e.errorKey])==null?void 0:m.$errors[0])==null?void 0:i.$message},{default:N(()=>[b(v(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(c(!0),f(R,null,K(T.value,e=>{var n,d,u,m,i;return c(),F(Q,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":_=>a.value[e.model]=_,width:500,options:e.options,error:(d=(n=s(r))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$error,placeholder:e==null?void 0:e.placeholder,textError:(i=(m=(u=s(r))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:i.$message,success:e.success,loading:e.loading},{default:N(()=>[b(v(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),V(D,{className:`form__submit ${(E=(I=s(r))==null?void 0:I.roleId.$errors[0])!=null&&E.$message?"centered":""}`},{default:N(()=>[b(v(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])):ee("",!0)}}};export{Ne as default};
//# sourceMappingURL=create-QLGMx9PS.js.map
