import{u as J,a as z,y as K,r as h,c as W,b as y,d as V,j as O,g as t,w as X,F as S,B as w,C as b,k as Y,l as p,o as u,A as B,z as C,e as f,t as v}from"./index-u_2KKI46.js";import{u as Z,r as g}from"./i18n-validators-SGtCpuoI.js";import{a as ee,u as re}from"./generic.services-Zkt5ZkSV.js";import{u as L}from"./useQuery-n3W-mpu_.js";import{c as oe}from"./crud.services-WcX_HSPp.js";import{m as ae,a as se}from"./manual.services-W9iJUjqa.js";const te={class:"manage section-height shadowed"},ne={class:"manage__inner section-padding"},_e={__name:"create",async setup(de){let o,m;const $=ee(),F=Y();J(),z();const{data:q,isSuccess:E,isLoading:k}=([o,m]=K(()=>L({queryKey:["regions"],queryFn:()=>ae()})),o=await o,m(),o),{data:M,isSuccess:N,isLoading:x}=([o,m]=K(()=>L({queryKey:["districts"],queryFn:()=>se()})),o=await o,m(),o),s=h({name:"",address:"",regionId:[],districtId:[]}),T=W(()=>({name:{required:g},address:{required:g},regionId:{required:g},districtId:{required:g}})),a=Z(T,s),D=h([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),P=h([{id:1,model:"regionId",label:"regionObjectLabel",placeholder:"regionObjectPlaceholder",errorKey:"regionId",options:q,success:E,loading:k},{id:2,model:"districtId",label:"districtObjectLabel",placeholder:"districtObjectPlaceholder",errorKey:"districtId",options:M,success:N,loading:x}]),{mutate:Q}=re({onMutate:r=>{r.regionId=r.regionId[0],r.districtId=r.districtId[0]},mutationFn:r=>oe("building_object",r),onSuccess:()=>{$.invalidateQueries({queryKey:["objects"]}),$.invalidateQueries({queryKey:["objectsList"]}),F.push(B.OBJECTS.path)}}),R=()=>{a.value.$validate(),!a.value.$errors.length&&(Q(s.value),a.value.$reset())};return(r,ie)=>{var I,j;const U=p("ManageHead"),H=p("FormInput"),A=p("FormSelect"),G=p("CustomButton");return u(),y("section",te,[V("div",ne,[O(U,{title:"addNewObjectTitle",to:t(B).OBJECTS.path},null,8,["to"]),V("form",{class:"manage__form form-manage",onSubmit:X(R,["prevent"])},[(u(!0),y(S,null,w(D.value,e=>{var n,d,i,l,c;return u(),C(H,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":_=>s.value[e.model]=_,width:500,placeholder:r.$t(e.placeholder),name:e.icon,error:(d=(n=t(a))==null?void 0:n[e.errorKey])==null?void 0:d.$error,textError:(c=(l=(i=t(a))==null?void 0:i[e.errorKey])==null?void 0:l.$errors[0])==null?void 0:c.$message},{default:b(()=>[f(v(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(u(!0),y(S,null,w(P.value,e=>{var n,d,i,l,c;return u(),C(A,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":_=>s.value[e.model]=_,width:500,options:e.options,error:(d=(n=t(a))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:d.$error,placeholder:e==null?void 0:e.placeholder,textError:(c=(l=(i=t(a))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:b(()=>[f(v(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),O(G,{className:`form__submit ${(j=(I=t(a))==null?void 0:I.districtId.$errors[0])!=null&&j.$message?"centered":""}`},{default:b(()=>[f(v(r.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{_e as default};
//# sourceMappingURL=create-UitpuJBI.js.map
