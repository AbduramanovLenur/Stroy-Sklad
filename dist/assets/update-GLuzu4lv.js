import{u as ae,a as te,r as m,y as b,c as le,x as de,b as k,d as B,f as q,B as I,w as ie,F as w,e as V,k as g,g as ne,C as ue,h as f,o as y,i as _,t as h,z as j,A as C}from"./index-qu9jH8U4.js";import{u as ce,r as t}from"./i18n-validators-18WrXdQ3.js";import{a as me,u as be}from"./generic.services-TvKn_bvi.js";import{u as p}from"./useQuery-HXp8dDXQ.js";import{a as ge,u as ye}from"./crud.services-RAdlH-I4.js";import{m as pe,a as Ie,e as fe,b as _e}from"./manual.services-HqI37590.js";const he={class:"manage section-height shadowed"},ve={class:"manage__inner section-padding"},qe={__name:"update",async setup(Fe){let o,a;const O=me(),L=ne(),N=ue();ae(),te();const v=m(N.params.id),K=m(localStorage.getItem("organizationId")),{data:E,isSuccess:R,isLoading:x}=([o,a]=b(()=>p({queryKey:["regions"],queryFn:()=>pe()})),o=await o,a(),o),{data:T,isSuccess:A,isLoading:D}=([o,a]=b(()=>p({queryKey:["districts"],queryFn:()=>Ie()})),o=await o,a(),o),{data:G,isSuccess:M,isLoading:P}=([o,a]=b(()=>p({queryKey:["objectsList",{organizationId:K}],queryFn:()=>fe(K.value)})),o=await o,a(),o),{data:Q,isSuccess:U,isLoading:z}=([o,a]=b(()=>p({queryKey:["states"],queryFn:()=>_e()})),o=await o,a(),o),r=m({id:"",fullname:"",numberOfFloors:"",roomsOnFloor:"",address:"",buildingObjectId:1,regionId:"",districtId:"",stateId:""}),H=le(()=>({id:{required:t},fullname:{required:t},numberOfFloors:{required:t},roomsOnFloor:{required:t},address:{required:t},buildingObjectId:{required:t},regionId:{required:t},districtId:{required:t},stateId:{required:t}})),l=ce(H,r),W=m([{id:1,model:"fullname",label:"blocksFullNameLabel",placeholder:"blocksFullNamePlaceholder",icon:"input-company",errorKey:"fullname"},{id:2,model:"numberOfFloors",label:"blocksNumberLabel",placeholder:"blocksNumberPlaceholder",icon:"signature",errorKey:"numberOfFloors"},{id:3,model:"roomsOnFloor",label:"blocksRoomsLabel",placeholder:"blocksRoomsPlaceholder",icon:"door",errorKey:"roomsOnFloor"},{id:4,model:"address",label:"blocksAddressLabel",placeholder:"blocksAddressPlaceholder",icon:"address",errorKey:"address"}]),J=m([{id:1,model:"buildingObjectId",label:"buildIdBlocksLabel",options:G,errorKey:"buildingObjectId",success:M,loading:P},{id:2,model:"regionId",label:"regionBlocksLabel",options:E,errorKey:"regionId",success:R,loading:x},{id:3,model:"districtId",label:"districtBlocksLabel",options:T,errorKey:"districtId",success:A,loading:D},{id:4,model:"stateId",label:"stateBlocksLabel",options:Q,success:U,loading:z,errorKey:"stateId"}]),{isError:X}=([o,a]=b(()=>p({queryKey:["blocksById",v],queryFn:()=>ge("building_block",v.value),select:s=>{r.value.id=s.id,r.value.fullname=s.fullName,r.value.numberOfFloors=s.numberOfFloors,r.value.roomsOnFloor=s.roomsOnFloor,r.value.address=s.address,r.value.buildingObjectId=s.buildingObjectId,r.value.regionId=s.regionId,r.value.districtId=s.districtId,r.value.stateId=s.stateId}})),o=await o,a(),o);de(X,s=>{s&&L.push(C.HOME.path)});const{mutate:Y}=be({mutationFn:s=>ye("building_block",s),onSuccess:()=>{O.invalidateQueries({queryKey:["blocks"]}),O.invalidateQueries({queryKey:["blocksById",v]}),L.push(C.BLOCKS.path)}}),Z=async()=>{l.value.$validate(),!l.value.$errors.length&&(Y(r.value),l.value.$reset())};return(s,ke)=>{var S,$;const ee=f("Title"),oe=f("FormInput"),se=f("FormSelect"),re=f("CustomButton");return y(),k("section",he,[B("div",ve,[q(ee,null,{default:I(()=>[_(`\r
                `+h(s.$t("editCompanyTitle"))+`\r
            `,1)]),_:1}),B("form",{class:"manage__form form-manage",onSubmit:ie(Z,["prevent"])},[(y(!0),k(w,null,V(W.value,e=>{var d,i,n,u,c;return y(),j(oe,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":F=>r.value[e.model]=F,width:500,placeholder:s.$t(e.placeholder),name:e.icon,error:(i=(d=g(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:i.$error,textError:(c=(u=(n=g(l))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message},{default:I(()=>[_(h(s.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(y(!0),k(w,null,V(J.value,e=>{var d,i,n,u,c;return y(),j(se,{key:e.id,modelValue:r.value[e.model],"onUpdate:modelValue":F=>r.value[e.model]=F,width:500,options:e.options,error:(i=(d=g(l))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:i.$error,textError:(c=(u=(n=g(l))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:I(()=>[_(h(s.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),q(re,{className:`form__submit ${($=(S=g(l))==null?void 0:S.stateId.$errors[0])!=null&&$.$message?"centered":""}`},{default:I(()=>[_(h(s.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{qe as default};
//# sourceMappingURL=update-GLuzu4lv.js.map
