import{_ as D,x as I,y as M,r as S,z as O,d as v,e as Q,k as N,h as e,A as T,i as p,t as F,m as l,o as r,s as P}from"./index-xaxvmeln.js";import{a as H,u as K}from"./generic.services-fBvasRgP.js";import{u as R}from"./useQuery-5RNqZlmw.js";import{g as V,d as Y}from"./crud.services-MNtnlh6b.js";import{r as U}from"./index-GttGB5Im.js";const W={class:"employees"},$={class:"employees__inner section-padding"},j={key:2,class:"empty-table shadowed"},G={__name:"index",async setup(J){let n,d;const y=H(),k=I(),{page:i,limit:c,search:w}=M(k),_=S(""),h=U(w,500),C=S([{id:1,label:"employeesFullName",width:30},{id:2,label:"employeesOrganization",width:30},{id:3,label:"employeesPhone",width:20},{id:4,label:"employeesRole",width:15}]),{data:a,isLoading:q,isSuccess:u,isError:x}=([n,d]=O(()=>R({queryKey:["employees",{page:i,limit:c,debouncedSearch:h}],queryFn:()=>V("user",i.value,c.value,h.value),select:t=>{let m={...t};return m.users=t==null?void 0:t.users.map(s=>{const o={...s,phone:s.phoneNumber,company:s.organizationName,name:s.fullName};return delete o.fullName,delete o.phoneNumber,delete o.organizationName,o}),m}})),n=await n,d(),n),{mutate:A}=K({mutationFn:t=>Y("user",t),onSuccess:t=>{y.invalidateQueries({queryKey:["employees"]}),y.invalidateQueries({queryKey:["employeeById",_]})}}),B=t=>{_.value=t,A(t)};return(t,m)=>{var b,g,f,E;const s=l("HeadPage"),o=l("Table"),L=l("Pagination"),z=l("Spinner");return r(),v("section",W,[Q("div",$,[N(s,{title:"employeesTitle",to:e(P).CREATE_EMPLOYEES.path},null,8,["to"]),e(u)&&((b=e(a))!=null&&b.count)?(r(),T(o,{key:0,headers:C.value,table:(g=e(a))==null?void 0:g.users,to:e(P).UPDATE_EMPLOYEES.name,options:{page:e(i),limit:e(c)},onOnActionDelete:B},null,8,["headers","table","to","options"])):p("",!0),N(L,{count:(f=e(a))==null?void 0:f.count,isSucces:e(u)},null,8,["count","isSucces"]),e(q)?(r(),T(z,{key:1})):p("",!0),e(u)&&!((E=e(a))!=null&&E.count)||e(x)?(r(),v("div",j,F(t.$t("emptyTableTitle")),1)):p("",!0)])])}}},oe=D(G,[["__scopeId","data-v-bc87e900"]]);export{oe as default};
