import{u as X,a as Y,q as Z,r as h,z as I,c as ee,y as oe,d as f,e as V,k as q,h as d,w as ae,F as B,C as E,D as v,l as re,E as se,m as y,o as p,B as N,A as R,f as b,t as S}from"./index-8f2nY-tA.js";import{u as le,r as l}from"./i18n-validators-fCwa1ZSs.js";import{a as te,u as de}from"./generic.services-2-3LJT-B.js";import{u as $}from"./useQuery-eGcy0OjN.js";import{a as ne,u as ue}from"./crud.services-swolhUoO.js";import{d as me,b as ie}from"./manual.services-mSBZeXJB.js";const ce={class:"manage section-height shadowed"},pe={class:"manage__inner section-padding"},be={__name:"update",async setup(he){let r,t;const w=te(),K=re(),P=se();X(),Y(),Z();const g=h(P.params.id),{data:U,isSuccess:C,isLoading:M}=([r,t]=I(()=>$({queryKey:["roles"],queryFn:()=>me()})),r=await r,t(),r),{data:k,isSuccess:x,isLoading:z}=([r,t]=I(()=>$({queryKey:["states"],queryFn:()=>ie()})),r=await r,t(),r),a=h({id:"",fullName:"",userName:"",password:"",phoneNumber:"",organizationId:"",roleId:[],stateId:[]}),G=ee(()=>({id:{required:l},fullName:{required:l},userName:{required:l},phoneNumber:{required:l},organizationId:{required:l},roleId:{required:l},stateId:{required:l}})),s=le(G,a),H=h([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),Q=h([{id:1,model:"roleId",label:"employeesRoleLabel",placeholder:"employeesRolePlaceholder",errorKey:"roleId",options:U,success:C,loading:M},{id:2,model:"stateId",label:"employeesStateLabel",placeholder:"employeesStatePlaceholder",errorKey:"stateId",options:k,success:x,loading:z}]),{isError:T}=([r,t]=I(()=>$({queryKey:["orgUserById",g],queryFn:()=>ne("user",g.value),select:o=>{a.value.id=o.id,a.value.fullName=o.fullName,a.value.userName=o.userName,a.value.phoneNumber=o.phoneNumber,a.value.organizationId=o.organizationId,a.value.roleId=[o.roleId],a.value.stateId=[o.stateId]}})),r=await r,t(),r);oe(T,o=>{o&&K.push(N.HOME.path)});const{mutate:O}=de({onMutate:o=>{o.roleId=o.roleId[0],o.stateId=o.stateId[0]},mutationFn:o=>ue("user",o),onSuccess:()=>{w.invalidateQueries({queryKey:["orgUsers"]}),w.invalidateQueries({queryKey:["orgUserById",g]}),K.push(N.ORG_USER.path)}}),A=async()=>{s.value.$validate(),!s.value.$errors.length&&(O(a.value),s.value.$reset())};return(o,ye)=>{var L,F;const D=y("ManageHead"),W=y("FormInput"),j=y("FormSelect"),J=y("CustomButton");return p(),f("section",ce,[V("div",pe,[q(D,{title:"editEmployeesTitle",to:d(N).ORG_USER.path},null,8,["to"]),V("form",{class:"manage__form form-manage",onSubmit:ae(A,["prevent"])},[(p(!0),f(B,null,E(H.value,e=>{var n,u,m,i,c;return p(),R(W,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":_=>a.value[e.model]=_,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(u=(n=d(s))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(c=(i=(m=d(s))==null?void 0:m[e==null?void 0:e.errorKey])==null?void 0:i.$errors[0])==null?void 0:c.$message},{default:v(()=>[b(S(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),f(B,null,E(Q.value,e=>{var n,u,m,i,c;return p(),R(j,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":_=>a.value[e.model]=_,width:500,options:e.options,error:(u=(n=d(s))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:u.$error,placeholder:e==null?void 0:e.placeholder,textError:(c=(i=(m=d(s))==null?void 0:m[e==null?void 0:e.errorKey])==null?void 0:i.$errors[0])==null?void 0:c.$message,success:e.success,loading:e.loading},{default:v(()=>[b(S(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),q(J,{className:`form__submit ${(F=(L=d(s))==null?void 0:L.stateId.$errors[0])!=null&&F.$message?"centered":""}`},{default:v(()=>[b(S(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{be as default};
//# sourceMappingURL=update-jBQYJVN9.js.map
