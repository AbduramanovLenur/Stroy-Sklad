import{n as V,s as x,r as c,q as F,x as H,y as R,b as B,d as M,f as T,k as e,z as C,l as i,t as j,h as s,o as n,A}from"./index-qu9jH8U4.js";import{a as U,u as W}from"./generic.services-TvKn_bvi.js";import{u as $}from"./useQuery-HXp8dDXQ.js";import{g as G,d as J}from"./crud.services-RAdlH-I4.js";import{r as X}from"./index-r1nzloiF.js";const Y={class:"blocks"},Z={class:"blocks__inner section-padding"},ee={key:2,class:"empty-table shadowed"},ce={__name:"index",async setup(te){let a,r;const d=U(),u=V(),{setSearchValue:b,setPagePagination:E}=u,{page:m,limit:_,search:k}=x(u),p=c(localStorage.getItem("organizationId"));F(()=>{b("")}),H(k,()=>{E(1)});const h=c(""),y=X(k,500),I=c([{id:1,label:"blockName",width:185},{id:2,label:"blockObject",width:205},{id:3,label:"blockOrganization",width:260},{id:4,label:"blockFloors",width:230},{id:5,label:"blockRooms",width:235},{id:6,label:"blockAddress",width:150},{id:7,label:"blockState",width:140},{id:8,label:"blockAction",width:125}]),{data:o,isLoading:P,isSuccess:l,isError:q}=([a,r]=R(()=>$({queryKey:["blocks",{page:m,limit:_,debouncedSearch:y,organizationId:p}],queryFn:()=>G("building_block",m.value,_.value,y.value,{organizationId:p.value})})),a=await a,r(),a),{mutate:O}=W({mutationFn:t=>J("building_block",t),onSuccess:()=>{d.invalidateQueries({queryKey:["blocks"]}),d.invalidateQueries({queryKey:["blocksById",h]})}}),z=async t=>{h.value=t,O(t)};return(t,g)=>{var S,f,w,v;const D=s("HeadPage"),K=s("Table"),L=s("Pagination"),N=s("Spinner");return n(),B("section",Y,[M("div",Z,[T(D,{title:"blockTitle",to:e(A).CREATE_BLOCKS.path,onOnSearch:g[0]||(g[0]=Q=>e(b)(Q))},null,8,["to"]),e(l)&&((S=e(o))!=null&&S.count)?(n(),C(K,{key:0,headers:I.value,table:(f=e(o))==null?void 0:f.blocks,to:e(A).UPDATE_BLOCKS.name,onOnActionDelete:z},null,8,["headers","table","to"])):i("",!0),T(L,{count:(w=e(o))==null?void 0:w.count,isSucces:e(l),isEmpty:!!((v=e(o))!=null&&v.count)},null,8,["count","isSucces","isEmpty"]),e(P)?(n(),C(N,{key:1})):i("",!0),e(l)&&!e(o).count||e(q)?(n(),B("div",ee,j(t.$t("emptyTableTitle")),1)):i("",!0)])])}}};export{ce as default};
//# sourceMappingURL=index-MyCkVeES.js.map
