import{_ as I,n as Q,s as V,q as F,x as H,r as P,y as K,b as T,d as R,j as w,g as e,z as k,h as p,t as Y,l as i,o as r,A as q}from"./index-LIAghTzt.js";import{a as j,u as U}from"./generic.services-g7-190gM.js";import{u as W}from"./useQuery-lbUIVZoa.js";import{g as $,d as G}from"./crud.services-v10L7FpB.js";import{r as J}from"./index-YHyICAjd.js";const X={class:"employees"},Z={class:"employees__inner section-padding"},ee={key:2,class:"empty-table shadowed"},te={__name:"index",async setup(oe){let a,d;const y=j(),_=Q(),{setSearchValue:h,setPagePagination:A}=_,{page:c,limit:u,search:b}=V(_);F(()=>{h("")}),H(b,()=>{A(1)});const g=P(""),S=J(b,500),C=P([{id:1,label:"employeesFullName",width:300},{id:2,label:"employeesOrganization",width:320},{id:3,label:"employeesPhone",width:255},{id:4,label:"employeesRole",width:195},{id:5,label:"employeesState"},{id:8,label:"employeesAction"}]),{data:l,isLoading:x,isSuccess:m,isError:B}=([a,d]=K(()=>W({queryKey:["employees",{page:c,limit:u,debouncedSearch:S}],queryFn:()=>$("user",c.value,u.value,S.value),select:t=>{let n={...t};return n.users=t==null?void 0:t.users.map(o=>{const s={...o,phone:o.phoneNumber,company:o.organizationName,name:o.fullName};return delete s.fullName,delete s.phoneNumber,delete s.organizationName,s}),n}})),a=await a,d(),a),{mutate:L}=U({mutationFn:t=>G("user",t),onSuccess:()=>{y.invalidateQueries({queryKey:["employees"]}),y.invalidateQueries({queryKey:["employeesById",g]})}}),M=t=>{g.value=t,L(t)};return(t,n)=>{var f,E,v,N;const o=i("HeadPage"),s=i("Table"),O=i("Pagination"),z=i("Spinner");return r(),T("section",X,[R("div",Z,[w(o,{title:"employeesTitle",to:e(q).CREATE_EMPLOYEES.path,onOnSearch:n[0]||(n[0]=D=>e(h)(D))},null,8,["to"]),e(m)&&((f=e(l))!=null&&f.count)?(r(),k(s,{key:0,headers:C.value,table:(E=e(l))==null?void 0:E.users,to:e(q).UPDATE_EMPLOYEES.name,options:{page:e(c),limit:e(u)},onOnActionDelete:M},null,8,["headers","table","to","options"])):p("",!0),w(O,{count:(v=e(l))==null?void 0:v.count,isSucces:e(m)},null,8,["count","isSucces"]),e(x)?(r(),k(z,{key:1})):p("",!0),e(m)&&!((N=e(l))!=null&&N.count)||e(B)?(r(),T("div",ee,Y(t.$t("emptyTableTitle")),1)):p("",!0)])])}}},re=I(te,[["__scopeId","data-v-5ac9f85c"]]);export{re as default};
//# sourceMappingURL=index-GNKObxCN.js.map
