import{_ as I,n as Q,s as V,q as F,r as T,x as H,b as w,d as K,f as P,k as e,y as k,l as c,t as R,h as i,o as r,z as q}from"./index-_BFdtwee.js";import{a as Y,u as U}from"./generic.services-_wmr52k_.js";import{u as W}from"./useQuery-pyMv0qYl.js";import{g as $,d as j}from"./crud.services-oazsYCL2.js";import{r as G}from"./index-jQR_nEaD.js";const J={class:"employees section-height"},X={class:"employees__inner section-padding"},Z={key:2,class:"empty-table"},ee={__name:"index",async setup(te){let l,u;const m=Y(),p=Q(),{setSearchValue:A}=p,{page:d,limit:y,search:_}=V(p);F(()=>{A("")});const C=T(""),h=G(_,500),x=T([{id:1,label:"employeesFullName",width:300},{id:2,label:"employeesOrganization",width:320},{id:3,label:"employeesPhone",width:255},{id:4,label:"employeesRole",width:195},{id:5,label:"employeesState",width:250},{id:8,label:"employeesAction",width:190}]),{data:n,isLoading:b,isSuccess:S,isError:B}=([l,u]=H(()=>W({queryKey:["employees",{page:d,limit:y,debouncedSearch:h,isAdmin:!0}],queryFn:()=>$("user",d.value,y.value,h.value,!0),select:t=>{let a={...t};return a.users=t==null?void 0:t.users.map(s=>{const o={...s,phone:s.phoneNumber,company:s.organizationName,name:s.fullName};return delete o.fullName,delete o.phoneNumber,delete o.organizationName,o}),a}})),l=await l,u(),l),{mutate:L}=U({mutationFn:t=>j("user",t),onSuccess:()=>{m.invalidateQueries({queryKey:["employees"]}),m.invalidateQueries({queryKey:["employeesById"]})}}),M=t=>{C.value=t,L(t)};return(t,a)=>{var f,g,E,v,N;const s=i("HeadPage"),o=i("Table"),O=i("Pagination"),z=i("Spinner");return r(),w("section",J,[K("div",X,[P(s,{title:"employeesTitle",to:e(q).CREATE_EMPLOYEES.path,onOnSearch:a[0]||(a[0]=D=>_.value=D)},null,8,["to"]),e(S)&&((f=e(n))!=null&&f.count)?(r(),k(o,{key:0,headers:x.value,table:(g=e(n))==null?void 0:g.users,to:e(q).UPDATE_EMPLOYEES.name,onOnActionDelete:M},null,8,["headers","table","to"])):c("",!0),P(O,{count:(E=e(n))==null?void 0:E.count,isSucces:e(b),isEmpty:!!((v=e(n))!=null&&v.count)},null,8,["count","isSucces","isEmpty"]),e(b)?(r(),k(z,{key:1})):c("",!0),e(S)&&!((N=e(n))!=null&&N.count)||e(B)?(r(),w("div",Z,R(t.$t("emptyTableTitle")),1)):c("",!0)])])}}},ie=I(ee,[["__scopeId","data-v-9b1799d5"]]);export{ie as default};
//# sourceMappingURL=index-nppFvwVy.js.map
