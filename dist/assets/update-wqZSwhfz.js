import{u as se,a as re,n as le,r as y,y as g,c as te,x as ne,b as L,d as z,f as F,B as h,w as ue,F as q,e as P,k as c,g as ie,C as de,h as b,o as p,i as f,t as _,z as V,A as B}from"./index-VQIUi_yG.js";import{u as me,r as t}from"./i18n-validators-yInBhSOi.js";import{a as ce,u as pe}from"./generic.services-qeqkLGxM.js";import{u as I}from"./useQuery-p6XK-aiu.js";import{a as ye,u as ge}from"./crud.services-xidt0Eez.js";import{c as he,d as be,b as fe}from"./manual.services-1CioQ53F.js";const _e={class:"manage section-height shadowed"},Ie={class:"manage__inner section-padding"},Fe={__name:"update",async setup(ve){let a,r;const S=ce(),$=ie(),E=de();se(),re();const C=le(),{setPagePagination:k,setLimitPagination:O}=C,v=y(E.params.id),{data:R,isSuccess:T,isLoading:x}=([a,r]=g(()=>I({queryKey:["organizations"],queryFn:()=>he()})),a=await a,r(),a),{data:M,isSuccess:Q,isLoading:U}=([a,r]=g(()=>I({queryKey:["roles"],queryFn:()=>be()})),a=await a,r(),a),{data:G,isSuccess:A,isLoading:H}=([a,r]=g(()=>I({queryKey:["states"],queryFn:()=>fe()})),a=await a,r(),a),s=y({id:"",fullName:"",userName:"",password:"",phoneNumber:"",organizationId:"",roleId:"",stateId:""}),D=te(()=>({id:{required:t},fullName:{required:t},userName:{required:t},phoneNumber:{required:t},organizationId:{required:t},roleId:{required:t},stateId:{required:t}})),l=me(D,s),W=y([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),Y=y([{id:1,model:"organizationId",label:"employeesOrganizationLabel",options:R,errorKey:"organizationId",success:T,loading:x},{id:2,model:"roleId",label:"employeesRoleLabel",options:M,errorKey:"roleId",success:Q,loading:U},{id:3,model:"stateId",label:"employeesStateLabel",options:G,success:A,loading:H}]),{isError:j}=([a,r]=g(()=>I({queryKey:["employeesById",v],queryFn:()=>ye("user",v.value),select:o=>{s.value.id=o.id,s.value.fullName=o.fullName,s.value.userName=o.userName,s.value.phoneNumber=o.phoneNumber,s.value.organizationId=o.organizationId,s.value.roleId=o.roleId,s.value.stateId=o.stateId}})),a=await a,r(),a);ne(j,o=>{o&&$.push(B.HOME.path)});const{mutate:J}=pe({mutationFn:o=>ge("user",o),onSuccess:()=>{S.invalidateQueries({queryKey:["employees"]}),S.invalidateQueries({queryKey:["employeesById",v]}),k(1),O(10),$.push(B.EMPLOYEES.path)}}),X=async()=>{l.value.$validate(),!l.value.$errors.length&&(J(s.value),l.value.$reset())};return(o,Ne)=>{var w,K;const Z=b("Title"),ee=b("FormInput"),oe=b("FormSelect"),ae=b("CustomButton");return p(),L("section",_e,[z("div",Ie,[F(Z,null,{default:h(()=>[f(`\r
                `+_(o.$t("editEmployeesTitle"))+`\r
            `,1)]),_:1}),z("form",{class:"manage__form form-manage",onSubmit:ue(X,["prevent"])},[(p(!0),L(q,null,P(W.value,e=>{var n,u,i,d,m;return p(),V(ee,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":N=>s.value[e.model]=N,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(u=(n=c(l))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(m=(d=(i=c(l))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:m.$message},{default:h(()=>[f(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(p(!0),L(q,null,P(Y.value,e=>{var n,u,i,d,m;return p(),V(oe,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":N=>s.value[e.model]=N,width:500,options:e.options,error:(u=(n=c(l))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:u.$error,textError:(m=(d=(i=c(l))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:m.$message,success:e.success,loading:e.loading},{default:h(()=>[f(_(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),F(ae,{className:`form__submit ${(K=(w=c(l))==null?void 0:w.stateId.$errors[0])!=null&&K.$message?"centered":""}`},{default:h(()=>[f(_(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Fe as default};
//# sourceMappingURL=update-wqZSwhfz.js.map
