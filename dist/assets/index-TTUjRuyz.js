import{n as Q,s as V,r,q as x,x as F,y as H,b as v,d as R,j as w,g as e,z as B,h as d,t as j,l as a,o as n,A as T}from"./index-LIAghTzt.js";import{a as M,u as U}from"./generic.services-g7-190gM.js";import{u as W}from"./useQuery-lbUIVZoa.js";import{g as $,d as G}from"./crud.services-v10L7FpB.js";import{r as J}from"./index-YHyICAjd.js";const X={class:"blocks"},Y={class:"blocks__inner section-padding"},Z={key:2,class:"empty-table shadowed"},le={__name:"index",async setup(ee){let o,u;const b=M(),m=Q(),{setSearchValue:_,setPagePagination:C}=m,{page:l,limit:c,search:k}=V(m),A=r(localStorage.getItem("organizationId"));x(()=>{_("")}),F(k,()=>{C(1)});const p=r(""),g=J(k,500),P=r([{id:1,label:"blockName",width:185},{id:2,label:"blockObject",width:205},{id:3,label:"blockOrganization",width:260},{id:4,label:"blockFloors",width:230},{id:5,label:"blockRooms",width:235},{id:6,label:"blockAddress",width:150},{id:7,label:"blockState"},{id:8,label:"blockAction"}]),{data:s,isLoading:q,isSuccess:i,isError:I}=([o,u]=H(()=>W({queryKey:["blocks",{page:l,limit:c,debouncedSearch:g,organizationId:A}],queryFn:()=>$("building_block",l.value,c.value,g.value)})),o=await o,u(),o),{mutate:O}=U({mutationFn:t=>G("building_block",t),onSuccess:()=>{b.invalidateQueries({queryKey:["blocks"]}),b.invalidateQueries({queryKey:["blocksById",p]})}}),D=async t=>{p.value=t,O(t)};return(t,h)=>{var y,S,f;const E=a("HeadPage"),K=a("Table"),L=a("Pagination"),z=a("Spinner");return n(),v("section",X,[R("div",Y,[w(E,{title:"blockTitle",to:e(T).CREATE_BLOCKS.path,onOnSearch:h[0]||(h[0]=N=>e(_)(N))},null,8,["to"]),e(i)&&((y=e(s))!=null&&y.count)?(n(),B(K,{key:0,headers:P.value,table:(S=e(s))==null?void 0:S.blocks,to:e(T).UPDATE_BLOCKS.name,options:{page:e(l),limit:e(c)},onOnActionDelete:D},null,8,["headers","table","to","options"])):d("",!0),w(L,{count:(f=e(s))==null?void 0:f.count,isSucces:e(i)},null,8,["count","isSucces"]),e(q)?(n(),B(z,{key:1})):d("",!0),e(i)&&!e(s).count||e(I)?(n(),v("div",Z,j(t.$t("emptyTableTitle")),1)):d("",!0)])])}}};export{le as default};
//# sourceMappingURL=index-TTUjRuyz.js.map
