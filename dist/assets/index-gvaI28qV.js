import{g as O,d as Q}from"./crud.services-WjFvBV25.js";import{_ as V,u as F,a as H,x as K,y as R,r as S,z as Y,d as T,e as $,k as v,A as U,h as t,B as N,i as d,t as w,m as l,o as i,f as W,s as P}from"./index-_sW-sQTC.js";import{u as j}from"./generic.services-lrsWuSGG.js";import{u as G}from"./useQuery-__dxNVMJ.js";import{u as J}from"./useMutation-A_gT2E6W.js";import{r as X}from"./index-zI2a6Eei.js";const Z={class:"employees"},ee={class:"employees__inner section-padding"},te={key:2,class:"empty-table shadowed"},se={__name:"index",async setup(oe){let a,p;const y=j(),k=F(),{t:B}=H(),C=K(),{page:r,limit:c,search:x}=R(C),_=S(""),h=X(x,500),q=S([{id:1,label:"employeesFullName",width:30},{id:2,label:"employeesOrganization",width:30},{id:3,label:"employeesPhone",width:20},{id:4,label:"employeesRole",width:15}]),{data:n,isLoading:A,isSuccess:u,isError:I}=([a,p]=Y(()=>G({queryKey:["employees",{page:r,limit:c,debouncedSearch:h}],queryFn:()=>O("user",r.value,c.value,h.value),select:e=>{let m={...e};return m.users=e==null?void 0:e.users.map(s=>{const o={...s,phone:s.phoneNumber,company:s.organizationName,name:s.fullName};return delete o.fullName,delete o.phoneNumber,delete o.organizationName,o}),m}})),a=await a,p(),a),{mutate:L}=J({mutationFn:e=>Q("user",e),onSuccess:e=>{e!=null&&e.success&&(y.invalidateQueries({queryKey:["employees"]}),y.invalidateQueries({queryKey:["employeeById",_]}),setTimeout(()=>k.success(B("deleteToast")),150))}}),z=e=>{_.value=e,L(e)};return(e,m)=>{var f,b,g,E;const s=l("HeadPage"),o=l("Table"),D=l("Pagination"),M=l("Spinner");return i(),T("section",Z,[$("div",ee,[v(s,{title:"employeesTitle",to:t(P).CREATE_EMPLOYEES.path},{default:U(()=>[W(w(e.$t("addButton")),1)]),_:1},8,["to"]),t(u)&&((f=t(n))!=null&&f.count)?(i(),N(o,{key:0,headers:q.value,table:(b=t(n))==null?void 0:b.users,to:t(P).UPDATE_EMPLOYEES.name,options:{page:t(r),limit:t(c)},onOnActionDelete:z},null,8,["headers","table","to","options"])):d("",!0),v(D,{count:(g=t(n))==null?void 0:g.count,isSucces:t(u)},null,8,["count","isSucces"]),t(A)?(i(),N(M,{key:1})):d("",!0),t(u)&&!((E=t(n))!=null&&E.count)||t(I)?(i(),T("div",te,w(e.$t("emptyTableTitle")),1)):d("",!0)])])}}},ue=V(se,[["__scopeId","data-v-897edddc"]]);export{ue as default};
