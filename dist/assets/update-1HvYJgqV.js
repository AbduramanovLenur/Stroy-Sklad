import{u as ee,a as oe,r as y,z as g,c as ae,y as te,d as v,e as F,k as re,h as r,w as se,F as L,C as k,A as h,i as N,D as M,l as le,E as ue,m as n,o as l,B as $,f as I,t as S}from"./index-8f2nY-tA.js";import{u as ne,r as V}from"./i18n-validators-fCwa1ZSs.js";import{a as de,u as me}from"./generic.services-2-3LJT-B.js";import{u as R}from"./useQuery-eGcy0OjN.js";import{a as ie,u as ce}from"./crud.services-swolhUoO.js";import{e as pe,b as he}from"./manual.services-mSBZeXJB.js";const ye={class:"manage section-height shadowed"},_e={class:"manage__inner section-padding"},Se={__name:"update",async setup(fe){let a,u;const b=de(),K=le(),C=ue();ee(),oe();const _=y(C.params.id),{data:x,isLoading:U,isSuccess:w}=([a,u]=g(()=>R({queryKey:["modules"],queryFn:()=>pe()})),a=await a,u(),a),{data:A,isSuccess:H,isLoading:Q}=([a,u]=g(()=>R({queryKey:["states"],queryFn:()=>he()})),a=await a,u(),a),t=y({shortName:"",fullName:"",roleModules:[],stateId:[]}),O=ae(()=>({shortName:{required:V},fullName:{required:V},stateId:{required:V}})),s=ne(O,t),P=y([{id:1,model:"fullName",label:"fullNameRoleLabel",placeholder:"fullNameRolePlaceholder",icon:"role",errorKey:"fullName"},{id:2,model:"shortName",label:"shortNameRoleLabel",placeholder:"shortNameRolePlaceholder",icon:"role",errorKey:"shortName"}]),T=y([{id:1,model:"stateId",label:"stateRoleLabel",placeholder:"stateRolePlaceholder",errorKey:"stateId",options:A,success:H,loading:Q}]),{isError:D}=([a,u]=g(()=>R({queryKey:["rolesById",_],queryFn:()=>ie("Role",_.value),select:o=>{t.value.shortName=o.shortName,t.value.fullName=o.fullName,t.value.roleModules=[...o.roleModules],t.value.stateId=[o.stateId]}})),a=await a,u(),a);te(D,o=>{o&&K.push($.HOME.path)});const{mutate:G}=me({onMutate:o=>{o.stateId=o.stateId[0]},mutationFn:o=>ce("Role",o),onSuccess:()=>{b.invalidateQueries({queryKey:["roles"]}),b.invalidateQueries({queryKey:["rolesById",_]}),K.push($.ROLES.path)}}),z=()=>{s.value.$validate(),!s.value.$errors.length&&(G(t.value),s.value.$reset())};return(o,B)=>{var q,E;const W=n("ManageHead"),j=n("FormInput"),J=n("FormSelect"),X=n("ActionsModules"),Y=n("CustomButton"),Z=n("Spinner");return l(),v("section",ye,[F("div",_e,[re(W,{title:"editRolesTitle",to:r($).ROLES.path},null,8,["to"]),F("form",{class:"manage__form form-manage",onSubmit:se(z,["prevent"])},[(l(!0),v(L,null,k(P.value,e=>{var d,m,i,c,p;return l(),h(j,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":f=>t.value[e.model]=f,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(m=(d=r(s))==null?void 0:d[e.errorKey])==null?void 0:m.$error,textError:(p=(c=(i=r(s))==null?void 0:i[e.errorKey])==null?void 0:c.$errors[0])==null?void 0:p.$message},{default:M(()=>[I(S(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(l(!0),v(L,null,k(T.value,e=>{var d,m,i,c,p;return l(),h(J,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":f=>t.value[e.model]=f,width:500,options:e.options,error:(m=(d=r(s))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:m.$error,placeholder:e==null?void 0:e.placeholder,textError:(p=(c=(i=r(s))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:c.$errors[0])==null?void 0:p.$message,success:e.success,loading:e.loading},{default:M(()=>[I(S(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),r(w)?(l(),h(X,{key:0,modelValue:t.value.roleModules,"onUpdate:modelValue":B[0]||(B[0]=e=>t.value.roleModules=e),actions:r(x)},null,8,["modelValue","actions"])):N("",!0),r(w)?(l(),h(Y,{key:1,className:`form__submit manage__submit ${(E=(q=r(s))==null?void 0:q.fullName.$errors[0])!=null&&E.$message?"centered":""}`},{default:M(()=>[I(S(o.$t("formButton")),1)]),_:1},8,["className"])):N("",!0)],32),r(U)?(l(),h(Z,{key:0})):N("",!0)])])}}};export{Se as default};
//# sourceMappingURL=update-1HvYJgqV.js.map
