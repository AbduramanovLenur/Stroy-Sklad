import{u as O,a as W,r as p,y as B,c as j,x as J,b as f,d as b,f as w,k as r,w as Y,F as K,e as F,B as I,g as Z,C as ee,h as g,o as m,A as v,z as q,i as E,t as $}from"./index-lJf7jXP7.js";import{u as ae,r as h}from"./i18n-validators-uxPccHio.js";import{a as oe,u as te}from"./generic.services-Aa1SKJf_.js";import{u as z}from"./useQuery-aSnCbYw0.js";import{a as se,u as re}from"./crud.services-puo1KH10.js";import{b as ne}from"./manual.services-vTvsoS9S.js";const le={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},_e={__name:"update",async setup(de){let t,c;const S=oe(),x=Z(),C=ee();O(),W();const y=p(C.params.id),{data:M,isSuccess:k,isLoading:L}=([t,c]=B(()=>z({queryKey:["states"],queryFn:()=>ne()})),t=await t,c(),t),o=p({id:"",fullName:"",organizationId:"",stateId:[]}),H=j(()=>({id:{required:h},fullName:{required:h},organizationId:{required:h},stateId:{required:h}})),s=ae(H,o),P=p([{id:1,model:"fullName",label:"nameExpensesLabel",placeholder:"nameExpensesPlaceholder",icon:"input-company",errorKey:"fullName"}]),Q=p([{id:1,model:"stateId",label:"stateExpensesLabel",placeholder:"stateExpensesPlaceholder",errorKey:"stateId",options:M,success:k,loading:L}]),{isError:U}=([t,c]=B(()=>z({queryKey:["expensesById",y],queryFn:()=>se("cost",y.value),select:a=>{o.value.id=a.id,o.value.fullName=a.fullname,o.value.organizationId=a.organizationId,o.value.stateId=[a.stateId]}})),t=await t,c(),t);J(U,a=>{a&&x.push(v.HOME.path)});const{mutate:T}=te({onMutate:a=>{a.stateId=a.stateId[0]},mutationFn:a=>re("cost",a),onSuccess:()=>{S.invalidateQueries({queryKey:["expenses"]}),S.invalidateQueries({queryKey:["expensesById",y]}),x.push(v.EXPENSES.path)}}),A=async()=>{const a=localStorage.getItem("organizationId");o.value.organizationId=a,s.value.$validate(),!s.value.$errors.length&&(T(o.value),s.value.$reset())};return(a,ie)=>{var N,V;const R=g("ManageHead"),X=g("FormInput"),D=g("FormSelect"),G=g("CustomButton");return m(),f("section",le,[b("div",ue,[w(R,{title:"editExpensesTitle",to:r(v).EXPENSES.path},null,8,["to"]),b("form",{class:"manage__form form-manage",onSubmit:Y(A,["prevent"])},[(m(!0),f(K,null,F(P.value,e=>{var n,l,u,d,i;return m(),q(X,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":_=>o.value[e.model]=_,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(l=(n=r(s))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:l.$error,textError:(i=(d=(u=r(s))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:i.$message},{default:I(()=>[E($(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(m(!0),f(K,null,F(Q.value,e=>{var n,l,u,d,i;return m(),q(D,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":_=>o.value[e.model]=_,width:500,options:e.options,error:(l=(n=r(s))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:l.$error,placeholder:e==null?void 0:e.placeholder,textError:(i=(d=(u=r(s))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:i.$message,success:e.success,loading:e.loading},{default:I(()=>[E($(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),w(G,{className:`form__submit ${(V=(N=r(s))==null?void 0:N.stateId.$errors[0])!=null&&V.$message?"centered":""}`},{default:I(()=>[E($(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{_e as default};
//# sourceMappingURL=update-sm-jEI1-.js.map
