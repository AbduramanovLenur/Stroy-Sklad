import{u as j,a as J,b as W,x as X,c as w,r as h,y as Y,d as f,e as I,k as P,h as r,w as Z,F as S,C as K,D as T,i as ee,l as ae,m as c,o as i,A as k,z as F,f as g,t as v,G as oe}from"./index-FhX-5zgX.js";import{u as te,r as U}from"./i18n-validators-EN8tShbO.js";import{a as re,u as se}from"./generic.services-shCmd6Kx.js";import{u as ne}from"./useQuery-F-m0HCTz.js";import{c as ue}from"./crud.services--J3Fp5qL.js";import{k as le}from"./manual.services-VeWEuMUr.js";const de={key:0,class:"manage section-height shadowed"},ie={class:"manage__inner section-padding"},Te={__name:"create",async setup(me){let m,$;const q=re(),B=ae();j(),J();const E=W(),{user:p}=X(E),C=w(()=>{var a,y;return!!((y=(a=p==null?void 0:p.value.user)==null?void 0:a.modules)!=null&&y.includes(oe.PRODUCT.CREATE))}),t=h({fullname:"",quantityTypeId:[]}),M=w(()=>({fullname:{required:U},quantityTypeId:{required:U}})),o=te(M,t),{data:N,isSuccess:Q,isLoading:x}=([m,$]=Y(()=>ne({queryKey:["types"],queryFn:()=>le(),enabled:C})),m=await m,$(),m),L=h([{id:1,model:"fullname",label:"nameProductsLabel",placeholder:"nameProductsPlaceholder",icon:"pen",errorKey:"fullname"}]),R=h([{id:1,model:"quantityTypeId",label:"qunatityTypesProductsLabel",placeholder:"qunatityTypesProductsPlaceholder",errorKey:"quantityTypeId",options:N,success:Q,loading:x}]),{mutate:D}=se({onMutate:a=>{a.quantityTypeId=a.quantityTypeId[0]},mutationFn:a=>ue("construction_material",a),onSuccess:()=>{q.invalidateQueries({queryKey:["products"]}),q.invalidateQueries({queryKey:["materialsList"]}),B.push(k.PRODUCT.path)}}),A=()=>{o.value.$validate(),!o.value.$errors.length&&(D(t.value),o.value.$reset())};return(a,y)=>{var V,b;const H=c("ManageHead"),O=c("FormInput"),z=c("FormSelect"),G=c("CustomButton");return C.value?(i(),f("section",de,[I("div",ie,[P(H,{title:"addNewProductTitle",to:r(k).PRODUCT.path},null,8,["to"]),I("form",{class:"manage__form form-manage",onSubmit:Z(A,["prevent"])},[(i(!0),f(S,null,K(L.value,e=>{var s,n,u,l,d;return i(),F(O,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":_=>t.value[e.model]=_,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(n=(s=r(o))==null?void 0:s[e.errorKey])==null?void 0:n.$error,textError:(d=(l=(u=r(o))==null?void 0:u[e.errorKey])==null?void 0:l.$errors[0])==null?void 0:d.$message},{default:T(()=>[g(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(i(!0),f(S,null,K(R.value,e=>{var s,n,u,l,d;return i(),F(z,{key:e.id,modelValue:t.value[e.model],"onUpdate:modelValue":_=>t.value[e.model]=_,width:500,options:e.options,error:(n=(s=r(o))==null?void 0:s[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(d=(l=(u=r(o))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:l.$errors[0])==null?void 0:d.$message,success:e.success,loading:e.loading},{default:T(()=>[g(v(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),P(G,{className:`form__submit ${(b=(V=r(o))==null?void 0:V.quantityTypeId.$errors[0])!=null&&b.$message?"centered":""}`},{default:T(()=>[g(v(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])):ee("",!0)}}};export{Te as default};
//# sourceMappingURL=create-pHxxNhS9.js.map
