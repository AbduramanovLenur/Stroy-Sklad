import{u as T,a as A,r as p,z as D,c as O,d as g,e as w,k as I,h as s,w as j,F as V,C as K,D as _,l as J,m as h,o as i,B as L,A as F,f,t as N}from"./index-qZ69CyC7.js";import{u as W,r as l,m as X}from"./i18n-validators-dGSGbQKY.js";import{a as Y,u as Z}from"./generic.services-34GP1Yc8.js";import{u as ee}from"./useQuery-IZNqF3Xo.js";import{c as oe}from"./crud.services-qYEmjzHd.js";import{d as re}from"./manual.services-BxKPmsPu.js";const ae={class:"manage section-height shadowed"},se={class:"manage__inner section-padding"},pe={__name:"create",async setup(le){let c,b;const R=Y(),S=J();T(),A();const P=p(localStorage.getItem("organizationId")),{data:B,isSuccess:C,isLoading:E}=([c,b]=D(()=>ee({queryKey:["roles"],queryFn:()=>re()})),c=await c,b(),c),a=p({fullName:"",userName:"",password:"",phoneNumber:"",organizationId:P.value,roleId:[]}),U=O(()=>({fullName:{required:l},userName:{required:l},password:{required:l,minLength:X},phoneNumber:{required:l},organizationId:{required:l},roleId:{required:l}})),r=W(U,a),k=p([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password",errorKey:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),M=p([{id:1,model:"roleId",label:"employeesRoleLabel",placeholder:"employeesRolePlaceholder",errorKey:"roleId",options:B,success:C,loading:E}]),{mutate:q}=Z({onMutate:o=>{o.roleId=o.roleId[0]},mutationFn:o=>oe("user",o),onSuccess:()=>{R.invalidateQueries({queryKey:["orgUsers"]}),S.push(L.ORG_USER.path)}}),x=()=>{r.value.$validate(),!r.value.$errors.length&&(q(a.value),r.value.$reset())};return(o,te)=>{var v,$;const z=h("ManageHead"),G=h("FormInput"),H=h("FormSelect"),Q=h("CustomButton");return i(),g("section",ae,[w("div",se,[I(z,{title:"addNewEmployeesTitle",to:s(L).ORG_USER.path},null,8,["to"]),w("form",{class:"manage__form form-manage",onSubmit:j(x,["prevent"])},[(i(!0),g(V,null,K(k.value,e=>{var t,n,d,m,u;return i(),F(G,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":y=>a.value[e.model]=y,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(n=(t=s(r))==null?void 0:t[e.errorKey])==null?void 0:n.$error,textError:(u=(m=(d=s(r))==null?void 0:d[e.errorKey])==null?void 0:m.$errors[0])==null?void 0:u.$message},{default:_(()=>[f(N(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(i(!0),g(V,null,K(M.value,e=>{var t,n,d,m,u;return i(),F(H,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":y=>a.value[e.model]=y,width:500,options:e.options,error:(n=(t=s(r))==null?void 0:t[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(u=(m=(d=s(r))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:u.$message,success:e.success,loading:e.loading},{default:_(()=>[f(N(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),I(Q,{className:`form__submit ${($=(v=s(r))==null?void 0:v.roleId.$errors[0])!=null&&$.$message?"centered":""}`},{default:_(()=>[f(N(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{pe as default};
//# sourceMappingURL=create-4l8BKMA7.js.map
