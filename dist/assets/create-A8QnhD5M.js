import{u as Y,a as Z,r as b,y as _,c as ee,b as f,d as B,f as K,k as i,w as oe,F as $,e as S,B as y,g as re,h as p,o as g,A as V,z as j,i as I,t as k}from"./index-lJf7jXP7.js";import{u as se,r as a}from"./i18n-validators-uxPccHio.js";import{a as ae,u as te}from"./generic.services-Aa1SKJf_.js";import{u as F}from"./useQuery-aSnCbYw0.js";import{c as le}from"./crud.services-puo1KH10.js";import{m as ie,a as de,e as ne}from"./manual.services-vTvsoS9S.js";const ce={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},Ie={__name:"create",async setup(me){let r,t;const w=ae(),N=re();Y(),Z();const L=b(localStorage.getItem("organizationId")),{data:q,isSuccess:C,isLoading:P}=([r,t]=_(()=>F({queryKey:["regions"],queryFn:()=>ie()})),r=await r,t(),r),{data:M,isSuccess:R,isLoading:x}=([r,t]=_(()=>F({queryKey:["districts"],queryFn:()=>de()})),r=await r,t(),r),{data:E,isSuccess:A,isLoading:D}=([r,t]=_(()=>F({queryKey:["objectsList",{organizationId:L}],queryFn:()=>ne(L.value)})),r=await r,t(),r),l=b({fullname:"",numberOfFloors:"",roomsOnFloor:"",address:"",buildingObjectId:[],regionId:[],districtId:[]}),U=ee(()=>({fullname:{required:a},numberOfFloors:{required:a},roomsOnFloor:{required:a},address:{required:a},buildingObjectId:{required:a},regionId:{required:a},districtId:{required:a}})),s=se(U,l),z=b([{id:1,model:"fullname",label:"blocksFullNameLabel",placeholder:"blocksFullNamePlaceholder",icon:"input-company",errorKey:"fullname"},{id:2,model:"numberOfFloors",label:"blocksNumberLabel",placeholder:"blocksNumberPlaceholder",icon:"signature",errorKey:"numberOfFloors"},{id:3,model:"roomsOnFloor",label:"blocksRoomsLabel",placeholder:"blocksRoomsPlaceholder",icon:"door",errorKey:"roomsOnFloor"},{id:4,model:"address",label:"blocksAddressLabel",placeholder:"blocksAddressPlaceholder",icon:"address",errorKey:"address"}]),G=b([{id:1,model:"buildingObjectId",label:"buildIdBlocksLabel",placeholder:"buildIdBlocksPlaceholder",errorKey:"buildingObjectId",options:E,success:A,loading:D},{id:2,model:"regionId",label:"regionBlocksLabel",placeholder:"regionBlocksPlaceholder",errorKey:"regionId",options:q,success:C,loading:P},{id:3,model:"districtId",label:"districtBlocksLabel",placeholder:"districtBlocksPlaceholder",errorKey:"districtId",options:M,success:R,loading:x}]),{mutate:H}=te({onMutate:o=>{o.buildingObjectId=o.buildingObjectId[0],o.regionId=o.regionId[0],o.districtId=o.districtId[0]},mutationFn:o=>le("building_block",o),onSuccess:()=>{w.invalidateQueries({queryKey:["blocks"]}),N.push(V.BLOCKS.path)}}),Q=()=>{s.value.$validate(),!s.value.$errors.length&&(H(l.value),s.value.$reset())};return(o,ge)=>{var O,v;const T=p("ManageHead"),J=p("FormInput"),W=p("FormSelect"),X=p("CustomButton");return g(),f("section",ce,[B("div",ue,[K(T,{title:"addNewBlocksTitle",to:i(V).BLOCKS.path},null,8,["to"]),B("form",{class:"manage__form form-manage",onSubmit:oe(Q,["prevent"])},[(g(!0),f($,null,S(z.value,e=>{var d,n,c,u,m;return g(),j(J,{key:e.id,modelValue:l.value[e.model],"onUpdate:modelValue":h=>l.value[e.model]=h,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(n=(d=i(s))==null?void 0:d[e.errorKey])==null?void 0:n.$error,textError:(m=(u=(c=i(s))==null?void 0:c[e.errorKey])==null?void 0:u.$errors[0])==null?void 0:m.$message},{default:y(()=>[I(k(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(g(!0),f($,null,S(G.value,e=>{var d,n,c,u,m;return g(),j(W,{key:e.id,modelValue:l.value[e.model],"onUpdate:modelValue":h=>l.value[e.model]=h,width:500,options:e.options,error:(n=(d=i(s))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(m=(u=(c=i(s))==null?void 0:c[e==null?void 0:e.errorKey])==null?void 0:u.$errors[0])==null?void 0:m.$message,success:e.success,loading:e.loading},{default:y(()=>[I(k(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),K(X,{className:`form__submit ${(v=(O=i(s))==null?void 0:O.districtId.$errors[0])!=null&&v.$message?"centered":""}`},{default:y(()=>[I(k(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{Ie as default};
//# sourceMappingURL=create-A8QnhD5M.js.map
