import{_ as M,u as O,a as Q,x as F,y as H,r as S,z as K,d as T,e as R,k as v,h as t,A as N,i as p,t as V,m as l,o as i,s as P}from"./index-OVII3y0P.js";import{a as Y,u as U}from"./generic.services-XQd1T_L7.js";import{u as W}from"./useQuery-Vw29GMwA.js";import{g as $,d as j}from"./crud.services-xzSCaXGM.js";import{r as G}from"./index-StCLE0Ix.js";const J={class:"employees"},X={class:"employees__inner section-padding"},Z={key:2,class:"empty-table shadowed"},ee={__name:"index",async setup(te){let a,d;const y=Y(),k=O(),{t:w}=Q(),C=F(),{page:c,limit:r,search:q}=H(C),_=S(""),h=G(q,500),x=S([{id:1,label:"employeesFullName",width:30},{id:2,label:"employeesOrganization",width:30},{id:3,label:"employeesPhone",width:20},{id:4,label:"employeesRole",width:15}]),{data:n,isLoading:A,isSuccess:u,isError:B}=([a,d]=K(()=>W({queryKey:["employees",{page:c,limit:r,debouncedSearch:h}],queryFn:()=>$("user",c.value,r.value,h.value),select:e=>{let m={...e};return m.users=e==null?void 0:e.users.map(s=>{const o={...s,phone:s.phoneNumber,company:s.organizationName,name:s.fullName};return delete o.fullName,delete o.phoneNumber,delete o.organizationName,o}),m}})),a=await a,d(),a),{mutate:I}=U({mutationFn:e=>j("user",e),onSuccess:e=>{e!=null&&e.success&&(y.invalidateQueries({queryKey:["employees"]}),y.invalidateQueries({queryKey:["employeeById",_]}),setTimeout(()=>k.success(w("deleteToast")),150))}}),L=e=>{_.value=e,I(e)};return(e,m)=>{var b,f,g,E;const s=l("HeadPage"),o=l("Table"),z=l("Pagination"),D=l("Spinner");return i(),T("section",J,[R("div",X,[v(s,{title:"employeesTitle",to:t(P).CREATE_EMPLOYEES.path},null,8,["to"]),t(u)&&((b=t(n))!=null&&b.count)?(i(),N(o,{key:0,headers:x.value,table:(f=t(n))==null?void 0:f.users,to:t(P).UPDATE_EMPLOYEES.name,options:{page:t(c),limit:t(r)},onOnActionDelete:L},null,8,["headers","table","to","options"])):p("",!0),v(z,{count:(g=t(n))==null?void 0:g.count,isSucces:t(u)},null,8,["count","isSucces"]),t(A)?(i(),N(D,{key:1})):p("",!0),t(u)&&!((E=t(n))!=null&&E.count)||t(B)?(i(),T("div",Z,V(e.$t("emptyTableTitle")),1)):p("",!0)])])}}},ie=M(ee,[["__scopeId","data-v-16f3ae89"]]);export{ie as default};
