import{u as P,a as H,y as V,r as h,c as J,b as v,d as S,f as j,B as p,w as W,F as w,e as L,k as u,g as X,h as _,o as c,i as y,t as b,z as B,A as Y}from"./index-TqTqIbHh.js";import{u as Z,r as m}from"./i18n-validators-zAZPYeBJ.js";import{a as ee,u as re}from"./generic.services-wmG985Iz.js";import{u as F}from"./useQuery-ZuTrOc-G.js";import{c as oe}from"./crud.services-ChiVIUDS.js";import{m as ae,a as se}from"./manual.services-2IlJk8n9.js";const te={class:"manage section-height shadowed"},ne={class:"manage__inner section-padding"},_e={__name:"create",async setup(ie){let o,g;const I=ee(),q=X();P(),H();const{data:C,isSuccess:O,isLoading:k}=([o,g]=V(()=>F({queryKey:["regions"],queryFn:()=>ae()})),o=await o,g(),o),{data:z,isSuccess:E,isLoading:N}=([o,g]=V(()=>F({queryKey:["districts"],queryFn:()=>se()})),o=await o,g(),o),s=h({name:"",address:"",organizationId:"",regionId:"",districtId:""}),T=J(()=>({name:{required:m},address:{required:m},organizationId:{required:m},regionId:{required:m},districtId:{required:m}})),a=Z(T,s),x=h([{id:1,model:"name",label:"nameObjectLabel",placeholder:"nameObjectPlaceholder",icon:"input-company",errorKey:"name"},{id:2,model:"address",label:"addressObjectLabel",placeholder:"addressObjectPlaceholder",icon:"address",errorKey:"address"}]),D=h([{id:1,model:"regionId",label:"regionObjectLabel",options:C,errorKey:"regionId",success:O,loading:k},{id:2,model:"districtId",label:"districtObjectLabel",options:z,errorKey:"districtId",success:E,loading:N}]),{mutate:Q}=re({mutationFn:r=>oe("building_object",r),onSuccess:()=>{I.invalidateQueries({queryKey:["objects"]}),I.invalidateQueries({queryKey:["objectsList"]}),q.push(Y.OBJECTS.path)}}),R=()=>{const r=localStorage.getItem("organizationId");s.value.organizationId=r,a.value.$validate(),!a.value.$errors.length&&(Q(s.value),a.value.$reset())};return(r,de)=>{var $,K;const U=_("Title"),M=_("FormInput"),A=_("FormSelect"),G=_("CustomButton");return c(),v("section",te,[S("div",ne,[j(U,null,{default:p(()=>[y(`\r
                `+b(r.$t("addNewObjectTitle"))+`\r
            `,1)]),_:1}),S("form",{class:"manage__form form-manage",onSubmit:W(R,["prevent"])},[(c(!0),v(w,null,L(x.value,e=>{var t,n,i,d,l;return c(),B(M,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":f=>s.value[e.model]=f,width:500,placeholder:r.$t(e.placeholder),name:e.icon,error:(n=(t=u(a))==null?void 0:t[e.errorKey])==null?void 0:n.$error,textError:(l=(d=(i=u(a))==null?void 0:i[e.errorKey])==null?void 0:d.$errors[0])==null?void 0:l.$message},{default:p(()=>[y(b(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(c(!0),v(w,null,L(D.value,e=>{var t,n,i,d,l;return c(),B(A,{key:e.id,modelValue:s.value[e.model],"onUpdate:modelValue":f=>s.value[e.model]=f,width:500,options:e.options,error:(n=(t=u(a))==null?void 0:t[e==null?void 0:e.errorKey])==null?void 0:n.$error,textError:(l=(d=(i=u(a))==null?void 0:i[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:l.$message,success:e.success,loading:e.loading},{default:p(()=>[y(b(r.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","textError","success","loading"])}),128)),j(G,{className:`form__submit ${(K=($=u(a))==null?void 0:$.districtId.$errors[0])!=null&&K.$message?"centered":""}`},{default:p(()=>[y(b(r.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{_e as default};
//# sourceMappingURL=create-pJq39Uao.js.map
