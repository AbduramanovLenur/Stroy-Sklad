import{_ as Q,n as V,s as F,q as H,x as K,r as P,y as R,b as T,d as Y,f as A,k as e,z as k,l as p,t as U,h as i,o as r,A as q}from"./index-83KN3zvu.js";import{a as W,u as $}from"./generic.services-Nv3JxhQ5.js";import{u as j}from"./useQuery-08AU-ufr.js";import{g as G,d as J}from"./crud.services-VbQaEYyd.js";import{r as X}from"./index-21n7PQ3x.js";const Z={class:"employees"},ee={class:"employees__inner section-padding"},te={key:2,class:"empty-table shadowed"},se={__name:"index",async setup(oe){let l,d;const y=W(),_=V(),{setSearchValue:h,setPagePagination:C}=_,{page:c,limit:u,search:b}=F(_);H(()=>{h("")}),K(b,()=>{C(1)});const g=P(""),S=X(b,500),x=P([{id:1,label:"employeesFullName",width:300},{id:2,label:"employeesOrganization",width:320},{id:3,label:"employeesPhone",width:255},{id:4,label:"employeesRole",width:195},{id:5,label:"employeesState",width:250},{id:8,label:"employeesAction",width:190}]),{data:n,isLoading:B,isSuccess:m,isError:L}=([l,d]=R(()=>j({queryKey:["employees",{page:c,limit:u,debouncedSearch:S,isAdmin:!0}],queryFn:()=>G("user",c.value,u.value,S.value,{isAdmin:!0}),select:t=>{let a={...t};return a.users=t==null?void 0:t.users.map(s=>{const o={...s,phone:s.phoneNumber,company:s.organizationName,name:s.fullName};return delete o.fullName,delete o.phoneNumber,delete o.organizationName,o}),a}})),l=await l,d(),l),{mutate:M}=$({mutationFn:t=>J("user",t),onSuccess:()=>{y.invalidateQueries({queryKey:["employees"]}),y.invalidateQueries({queryKey:["employeesById",g]})}}),O=t=>{g.value=t,M(t)};return(t,a)=>{var f,E,v,w,N;const s=i("HeadPage"),o=i("Table"),z=i("Pagination"),D=i("Spinner");return r(),T("section",Z,[Y("div",ee,[A(s,{title:"employeesTitle",to:e(q).CREATE_EMPLOYEES.path,onOnSearch:a[0]||(a[0]=I=>e(h)(I))},null,8,["to"]),e(m)&&((f=e(n))!=null&&f.count)?(r(),k(o,{key:0,headers:x.value,table:(E=e(n))==null?void 0:E.users,to:e(q).UPDATE_EMPLOYEES.name,options:{page:e(c),limit:e(u)},onOnActionDelete:O},null,8,["headers","table","to","options"])):p("",!0),A(z,{count:(v=e(n))==null?void 0:v.count,isSucces:e(m),isEmpty:!!((w=e(n))!=null&&w.count)},null,8,["count","isSucces","isEmpty"]),e(B)?(r(),k(D,{key:1})):p("",!0),e(m)&&!((N=e(n))!=null&&N.count)||e(L)?(r(),T("div",te,U(t.$t("emptyTableTitle")),1)):p("",!0)])])}}},ce=Q(se,[["__scopeId","data-v-87eeb1d0"]]);export{ce as default};
//# sourceMappingURL=index-rWkQKbEV.js.map
