import{u as X,a as Y,x as Z,y as O,b as ee,c as te,r as q,z as se,d as I,e as oe,k as L,A as ae,h as e,B as N,i as n,t as P,m as c,o as i,f as ne,s as Q,H as u}from"./index-pq3Ws-Lw.js";import{u as ce}from"./generic.services-Jxa47SEI.js";import{u as ie}from"./useQuery-m-uVwu1-.js";import{u as ue}from"./useMutation--Rfohlpk.js";import{g as re,d as le}from"./crud.services-NB-ZHYe_.js";import{r as de}from"./index-rXmDg-2v.js";const me={key:0,class:"costs"},pe={class:"costs__inner section-padding"},_e={key:2,class:"empty-table shadowed"},ge={__name:"index",async setup(Se){let o,_;const r=ce(),U=X(),{t:x}=Y(),H=Z(),{page:l,limit:d,search:K}=O(H),R=ee(),{user:s}=O(R),S=te(()=>{var t,p;return!!((p=(t=s==null?void 0:s.value.user)==null?void 0:t.modules)!=null&&p.includes(u.COST.READ))}),y=q(""),h=de(K,500),V=q([{id:1,label:"costsName",width:70}]),{data:a,isLoading:z,isSuccess:m,isError:F}=([o,_]=se(()=>ie({queryKey:["costs",{page:l,limit:d,debouncedSearch:h,organizationId:s.value.user.organizationId,name:s.value.user.fullName}],queryFn:()=>re("cost",l.value,d.value,h.value),enabled:S})),o=await o,_(),o),{mutate:M}=ue({mutationFn:t=>le("cost",t),onSuccess:t=>{t!=null&&t.success&&(r.invalidateQueries({queryKey:["costs"]}),r.invalidateQueries({queryKey:["costById",y.value.toString()]}),r.invalidateQueries({queryKey:["costsList"]}),setTimeout(()=>U.success(x("deleteToast")),150))}}),$=async t=>{y.value=t,M(t)};return(t,p)=>{var T,C,f,v,g,b,w,E,D,k,A,B;const W=c("HeadPage"),j=c("Table"),G=c("Pagination"),J=c("Spinner");return S.value?(i(),I("section",me,[oe("div",pe,[L(W,{title:"applicationCost",to:e(Q).CREATE_COST.path,isShowCreate:(f=(C=(T=e(s))==null?void 0:T.user)==null?void 0:C.modules)==null?void 0:f.includes(e(u).COST.CREATE)},{default:ae(()=>[ne(P(t.$t("addButton")),1)]),_:1},8,["to","isShowCreate"]),e(m)&&((v=e(a))!=null&&v.count)?(i(),N(j,{key:0,headers:V.value,table:(g=e(a))==null?void 0:g.cost,to:e(Q).UPDATE_COST.name,options:{page:e(l),limit:e(d)},isShowUpdate:(E=(w=(b=e(s))==null?void 0:b.user)==null?void 0:w.modules)==null?void 0:E.includes(e(u).COST.UPDATE),isShowDelete:(A=(k=(D=e(s))==null?void 0:D.user)==null?void 0:k.modules)==null?void 0:A.includes(e(u).COST.DELETE),onOnActionDelete:$},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):n("",!0),L(G,{count:(B=e(a))==null?void 0:B.count,isSucces:e(m)},null,8,["count","isSucces"]),e(z)?(i(),N(J,{key:1})):n("",!0),e(m)&&!e(a).count||e(F)?(i(),I("div",_e,P(t.$t("emptyTableTitle")),1)):n("",!0)])])):n("",!0)}}};export{ge as default};
