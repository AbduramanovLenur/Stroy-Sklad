import{u as G,a as J,x as Y,y as k,b as Z,c as ee,r as A,z as se,d as q,e as te,k as I,h as e,A as L,i as n,t as oe,m as i,o as c,s as X,H as u}from"./index-Su5VrTfH.js";import{a as ae,u as ne}from"./generic.services-Bjs5T0kb.js";import{u as ie}from"./useQuery-TVdyHrTE.js";import{g as ce,d as ue}from"./crud.services-Tdi7grz4.js";import{r as re}from"./index-VWVnq_Gp.js";const le={key:0,class:"expenses"},de={class:"expenses__inner section-padding"},me={key:2,class:"empty-table shadowed"},Te={__name:"index",async setup(pe){let o,_;const r=ae(),B=G(),{t:Q}=J(),U=Y(),{page:l,limit:d,search:H}=k(U),K=Z(),{user:t}=k(K),E=ee(()=>{var s,p;return!!((p=(s=t==null?void 0:t.value.user)==null?void 0:s.modules)!=null&&p.includes(u.EXPENS.READ))}),S=A(""),y=re(H,500),R=A([{id:1,label:"expensesName",width:70}]),{data:a,isLoading:z,isSuccess:m,isError:V}=([o,_]=se(()=>ie({queryKey:["expenses",{page:l,limit:d,debouncedSearch:y,organizationId:t.value.user.organizationId}],queryFn:()=>ce("cost",l.value,d.value,y.value),enabled:E})),o=await o,_(),o),{mutate:F}=ne({mutationFn:s=>ue("cost",s),onSuccess:s=>{s!=null&&s.success&&(r.invalidateQueries({queryKey:["expenses"]}),r.invalidateQueries({queryKey:["expensesById",S]}),r.invalidateQueries({queryKey:["costsList"]}),setTimeout(()=>B.success(Q("deleteToast")),150))}}),M=async s=>{S.value=s,F(s)};return(s,p)=>{var h,T,g,v,x,b,f,P,w,D,N,C;const O=i("HeadPage"),W=i("Table"),$=i("Pagination"),j=i("Spinner");return E.value?(c(),q("section",le,[te("div",de,[I(O,{title:"expensesTitle",to:e(X).CREATE_EXPENS.path,isShowCreate:(g=(T=(h=e(t))==null?void 0:h.user)==null?void 0:T.modules)==null?void 0:g.includes(e(u).EXPENS.CREATE)},null,8,["to","isShowCreate"]),e(m)&&((v=e(a))!=null&&v.count)?(c(),L(W,{key:0,headers:R.value,table:(x=e(a))==null?void 0:x.cost,to:e(X).UPDATE_EXPENS.name,options:{page:e(l),limit:e(d)},isShowUpdate:(P=(f=(b=e(t))==null?void 0:b.user)==null?void 0:f.modules)==null?void 0:P.includes(e(u).EXPENS.UPDATE),isShowDelete:(N=(D=(w=e(t))==null?void 0:w.user)==null?void 0:D.modules)==null?void 0:N.includes(e(u).EXPENS.DELETE),onOnActionDelete:M},null,8,["headers","table","to","options","isShowUpdate","isShowDelete"])):n("",!0),I($,{count:(C=e(a))==null?void 0:C.count,isSucces:e(m)},null,8,["count","isSucces"]),e(z)?(c(),L(j,{key:1})):n("",!0),e(m)&&!e(a).count||e(V)?(c(),q("div",me,oe(s.$t("emptyTableTitle")),1)):n("",!0)])])):n("",!0)}}};export{Te as default};
