import{u as Q,a as T,y as A,r as g,c as O,b as y,d as w,f as I,k as s,w as D,F as V,e as K,B as _,g as j,h as p,o as i,A as L,z as F,i as f,t as N}from"./index-x0me4eeV.js";import{u as J,r as l,m as W}from"./i18n-validators-N3krClQx.js";import{a as X,u as Y}from"./generic.services-3OPQu4nG.js";import{u as Z}from"./useQuery-xv1pFEHU.js";import{c as ee}from"./crud.services-2_QkeFR9.js";import{d as oe}from"./manual.services-gWBYdErO.js";const re={class:"manage section-height shadowed"},ae={class:"manage__inner section-padding"},ce={__name:"create",async setup(se){let c,b;const R=X(),S=j();Q(),T();const{data:P,isSuccess:B,isLoading:E}=([c,b]=A(()=>Z({queryKey:["roles"],queryFn:()=>oe()})),c=await c,b(),c),a=g({fullName:"",userName:"",password:"",phoneNumber:"",organizationId:"",roleId:[]}),C=O(()=>({fullName:{required:l},userName:{required:l},password:{required:l,minLength:W},phoneNumber:{required:l},organizationId:{required:l},roleId:{required:l}})),r=J(C,a),U=g([{id:1,model:"fullName",label:"employeesFullNameLabel",placeholder:"employeesFullNamePlaceholder",icon:"person",errorKey:"fullName"},{id:2,model:"userName",label:"employeesLoginLabel",placeholder:"employeesLoginPlaceholder",icon:"login",errorKey:"userName"},{id:3,model:"password",label:"employeesPasswordLabel",placeholder:"employeesPasswordPlaceholder",icon:"password",errorKey:"password"},{id:4,model:"phoneNumber",label:"employeesPhoneLabel",placeholder:"employeesPhonePlaceholder",icon:"phone",errorKey:"phoneNumber"}]),k=g([{id:1,model:"roleId",label:"employeesRoleLabel",placeholder:"employeesRolePlaceholder",errorKey:"roleId",options:P,success:B,loading:E}]),{mutate:z}=Y({onMutate:o=>{o.roleId=o.roleId[0]},mutationFn:o=>ee("user",o),onSuccess:()=>{R.invalidateQueries({queryKey:["orgUser"]}),S.push(L.ORG_USER.path)}}),M=()=>{const o=localStorage.getItem("organizationId");a.value.organizationId=o,r.value.$validate(),!r.value.$errors.length&&(z(a.value),r.value.$reset())};return(o,le)=>{var v,$;const q=p("ManageHead"),x=p("FormInput"),G=p("FormSelect"),H=p("CustomButton");return i(),y("section",re,[w("div",ae,[I(q,{title:"addNewEmployeesTitle",to:s(L).ORG_USER.path},null,8,["to"]),w("form",{class:"manage__form form-manage",onSubmit:D(M,["prevent"])},[(i(!0),y(V,null,K(U.value,e=>{var t,n,d,m,u;return i(),F(x,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":h=>a.value[e.model]=h,width:500,placeholder:o.$t(e.placeholder),name:e.icon,error:(n=(t=s(r))==null?void 0:t[e.errorKey])==null?void 0:n.$error,textError:(u=(m=(d=s(r))==null?void 0:d[e.errorKey])==null?void 0:m.$errors[0])==null?void 0:u.$message},{default:_(()=>[f(N(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(i(!0),y(V,null,K(k.value,e=>{var t,n,d,m,u;return i(),F(G,{key:e.id,modelValue:a.value[e.model],"onUpdate:modelValue":h=>a.value[e.model]=h,width:500,options:e.options,error:(n=(t=s(r))==null?void 0:t[e==null?void 0:e.errorKey])==null?void 0:n.$error,placeholder:e==null?void 0:e.placeholder,textError:(u=(m=(d=s(r))==null?void 0:d[e==null?void 0:e.errorKey])==null?void 0:m.$errors[0])==null?void 0:u.$message,success:e.success,loading:e.loading},{default:_(()=>[f(N(o.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),I(H,{className:`form__submit ${($=(v=s(r))==null?void 0:v.roleId.$errors[0])!=null&&$.$message?"centered":""}`},{default:_(()=>[f(N(o.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{ce as default};
//# sourceMappingURL=create-hhx0mTnn.js.map
