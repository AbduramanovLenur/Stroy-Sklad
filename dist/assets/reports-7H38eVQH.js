import{j as I,k as U}from"./crud.services-WjFvBV25.js";import{_ as N,u as A,a as O,b as V,y as j,c as z,z as D,d as y,e as n,k,A as F,h as t,t as p,B as v,i,m as d,o as c,f as M,H as $}from"./index-_sW-sQTC.js";import{u as q}from"./useQuery-__dxNVMJ.js";import{u as Q}from"./useMutation-A_gT2E6W.js";import"./generic.services-lrsWuSGG.js";const H={key:0,class:"reports"},K={class:"reports__inner"},P={class:"reports__head shadowed"},W={class:"reports__download-icon"},G={class:"reports__download-value"},J={key:2,class:"empty-table shadowed"},X={__name:"reports",async setup(Y){let r,_;const S=A(),{t:T}=O(),R=V(),{user:a}=j(R),m=z(()=>{var e,o;return!!((o=(e=a==null?void 0:a.value.user)==null?void 0:e.modules)!=null&&o.includes($.REPORTS.READ))}),g=[{id:1,label:"reportsMaterial",width:30},{id:2,label:"reportsQuantity",width:10},{id:3,label:"reportsObyekt",width:20},{id:4,label:"reportsBlock",width:20},{id:5,label:"reportsFloor",width:10},{id:6,label:"reportsBudget",width:10}],{data:u,isLoading:x,isSuccess:h,isError:B}=([r,_]=D(()=>q({queryKey:["reports",{organizationId:a.value.user.organizationId,name:a.value.user.fullName}],queryFn:()=>I(),enabled:m})),r=await r,_(),r),{mutate:w}=Q({mutationFn:()=>U(),onSuccess:e=>{if(!(e!=null&&e.success))return;const o=new Blob([e.data],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),l=window.URL.createObjectURL(o),s=document.createElement("a");s.href=l,s.setAttribute("download","filename.xlsx"),document.body.appendChild(s),s.click(),window.URL.revokeObjectURL(l),document.body.removeChild(s),setTimeout(()=>S.success(T("downloadToast")),150)}});return(e,o)=>{var b,f;const l=d("Title"),s=d("Icon"),C=d("Table"),L=d("Spinner");return m.value?(c(),y("section",H,[n("div",K,[n("div",P,[k(l,null,{default:F(()=>[M(`\r
                    `+p(e.$t("reportsTitle"))+`\r
                `,1)]),_:1}),n("button",{class:"reports__download hovered",type:"button",onClick:o[0]||(o[0]=(...E)=>t(w)&&t(w)(...E))},[n("span",W,[k(s,{name:"download"})]),n("span",G,p(e.$t("downloadLink")),1)])]),t(h)&&((b=t(u))!=null&&b.length)?(c(),v(C,{key:0,headers:g,table:t(u),options:{page:1,limit:10},isShowUpdate:!1,isShowDelete:!1,isShowState:!1},null,8,["table"])):i("",!0),t(x)?(c(),v(L,{key:1})):i("",!0),t(h)&&!((f=t(u))!=null&&f.length)||t(B)?(c(),y("div",J,p(e.$t("emptyTableTitle")),1)):i("",!0)])])):i("",!0)}}},ae=N(X,[["__scopeId","data-v-52de30d4"]]);export{ae as default};
