import{n as Q,s as V,r,q as x,x as F,y as H,b as w,d as R,f as B,k as e,z as T,l as d,t as M,h as s,o as n,A as C}from"./index-TSEQ-eOA.js";import{a as j,u as U}from"./generic.services-DL6v4nvc.js";import{u as W}from"./useQuery-LbR7akY7.js";import{g as $,d as G}from"./crud.services-TcfslZre.js";import{r as J}from"./index-iqNYHYNl.js";const X={class:"blocks"},Y={class:"blocks__inner section-padding"},Z={key:2,class:"empty-table shadowed"},le={__name:"index",async setup(ee){let o,u;const b=j(),m=Q(),{setSearchValue:_,setPagePagination:A}=m,{page:l,limit:c,search:k}=V(m),p=r(localStorage.getItem("organizationId"));x(()=>{_("")}),F(k,()=>{A(1)});const g=r(""),h=J(k,500),I=r([{id:1,label:"blockName",width:185},{id:2,label:"blockObject",width:205},{id:3,label:"blockOrganization",width:260},{id:4,label:"blockFloors",width:230},{id:5,label:"blockRooms",width:235},{id:6,label:"blockAddress",width:150},{id:7,label:"blockState"},{id:8,label:"blockAction"}]),{data:a,isLoading:P,isSuccess:i,isError:q}=([o,u]=H(()=>W({queryKey:["blocks",{page:l,limit:c,debouncedSearch:h,organizationId:p}],queryFn:()=>$("building_block",l.value,c.value,h.value,{organizationId:p.value})})),o=await o,u(),o),{mutate:O}=U({mutationFn:t=>G("building_block",t),onSuccess:()=>{b.invalidateQueries({queryKey:["blocks"]}),b.invalidateQueries({queryKey:["blocksById",g]})}}),z=async t=>{g.value=t,O(t)};return(t,y)=>{var S,f,v;const D=s("HeadPage"),E=s("Table"),K=s("Pagination"),L=s("Spinner");return n(),w("section",X,[R("div",Y,[B(D,{title:"blockTitle",to:e(C).CREATE_BLOCKS.path,onOnSearch:y[0]||(y[0]=N=>e(_)(N))},null,8,["to"]),e(i)&&((S=e(a))!=null&&S.count)?(n(),T(E,{key:0,headers:I.value,table:(f=e(a))==null?void 0:f.blocks,to:e(C).UPDATE_BLOCKS.name,options:{page:e(l),limit:e(c)},onOnActionDelete:z},null,8,["headers","table","to","options"])):d("",!0),B(K,{count:(v=e(a))==null?void 0:v.count,isSucces:e(i)},null,8,["count","isSucces"]),e(P)?(n(),T(L,{key:1})):d("",!0),e(i)&&!e(a).count||e(q)?(n(),w("div",Z,M(t.$t("emptyTableTitle")),1)):d("",!0)])])}}};export{le as default};
//# sourceMappingURL=index-3XJBDYCp.js.map
