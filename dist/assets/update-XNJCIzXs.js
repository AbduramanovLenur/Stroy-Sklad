import{u as O,a as W,r as p,z as B,c as j,y as J,d as f,e as w,k as K,h as r,w as Y,F as b,C as F,D as g,l as Z,E as ee,m as h,o as i,B as v,A as q,f as E,t as I}from"./index-qZ69CyC7.js";import{u as ae,r as $}from"./i18n-validators-dGSGbQKY.js";import{a as oe,u as se}from"./generic.services-34GP1Yc8.js";import{u as C}from"./useQuery-IZNqF3Xo.js";import{a as te,u as re}from"./crud.services-qYEmjzHd.js";import{b as ne}from"./manual.services-BxKPmsPu.js";const le={class:"manage section-height shadowed"},ue={class:"manage__inner section-padding"},fe={__name:"update",async setup(de){let s,c;const S=oe(),x=Z(),M=ee();O(),W();const y=p(M.params.id),{data:k,isSuccess:L,isLoading:H}=([s,c]=B(()=>C({queryKey:["states"],queryFn:()=>ne()})),s=await s,c(),s),o=p({id:"",fullName:"",stateId:[]}),P=j(()=>({id:{required:$},fullName:{required:$},stateId:{required:$}})),t=ae(P,o),Q=p([{id:1,model:"fullName",label:"nameExpensesLabel",placeholder:"nameExpensesPlaceholder",icon:"input-company",errorKey:"fullName"}]),U=p([{id:1,model:"stateId",label:"stateExpensesLabel",placeholder:"stateExpensesPlaceholder",errorKey:"stateId",options:k,success:L,loading:H}]),{isError:T}=([s,c]=B(()=>C({queryKey:["expensesById",y],queryFn:()=>te("cost",y.value),select:a=>{o.value.id=a.id,o.value.fullName=a.fullname,o.value.stateId=[a.stateId]}})),s=await s,c(),s);J(T,a=>{a&&x.push(v.HOME.path)});const{mutate:A}=se({onMutate:a=>{a.stateId=a.stateId[0]},mutationFn:a=>re("cost",a),onSuccess:()=>{S.invalidateQueries({queryKey:["expenses"]}),S.invalidateQueries({queryKey:["expensesById",y]}),x.push(v.EXPENSES.path)}}),D=async()=>{t.value.$validate(),!t.value.$errors.length&&(A(o.value),t.value.$reset())};return(a,me)=>{var N,V;const R=h("ManageHead"),X=h("FormInput"),z=h("FormSelect"),G=h("CustomButton");return i(),f("section",le,[w("div",ue,[K(R,{title:"editExpensesTitle",to:r(v).EXPENSES.path},null,8,["to"]),w("form",{class:"manage__form form-manage",onSubmit:Y(D,["prevent"])},[(i(!0),f(b,null,F(Q.value,e=>{var n,l,u,d,m;return i(),q(X,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":_=>o.value[e.model]=_,width:500,placeholder:a.$t(e.placeholder),name:e.icon,error:(l=(n=r(t))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:l.$error,textError:(m=(d=(u=r(t))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:m.$message},{default:g(()=>[E(I(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","placeholder","name","error","textError"])}),128)),(i(!0),f(b,null,F(U.value,e=>{var n,l,u,d,m;return i(),q(z,{key:e.id,modelValue:o.value[e.model],"onUpdate:modelValue":_=>o.value[e.model]=_,width:500,options:e.options,error:(l=(n=r(t))==null?void 0:n[e==null?void 0:e.errorKey])==null?void 0:l.$error,placeholder:e==null?void 0:e.placeholder,textError:(m=(d=(u=r(t))==null?void 0:u[e==null?void 0:e.errorKey])==null?void 0:d.$errors[0])==null?void 0:m.$message,success:e.success,loading:e.loading},{default:g(()=>[E(I(a.$t(e.label)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","error","placeholder","textError","success","loading"])}),128)),K(G,{className:`form__submit ${(V=(N=r(t))==null?void 0:N.stateId.$errors[0])!=null&&V.$message?"centered":""}`},{default:g(()=>[E(I(a.$t("formButton")),1)]),_:1},8,["className"])],32)])])}}};export{fe as default};
//# sourceMappingURL=update-XNJCIzXs.js.map
