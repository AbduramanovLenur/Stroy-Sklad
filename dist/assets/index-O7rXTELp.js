import{n as R,s as V,r as p,q as x,x as H,y as K,b as D,d as U,f as I,k as e,z as q,l as m,t as F,h as r,o as c,A}from"./index-rVcEkfs7.js";import{a as W,u as $}from"./generic.services-VYFQaCza.js";import{u as j}from"./useQuery-2Cvei3en.js";import{g as G,d as J}from"./crud.services-eAS52g5X.js";import{r as X}from"./index-Jhl1hIUk.js";const Y={class:"products"},Z={class:"products__inner section-padding"},ee={key:2,class:"empty-table shadowed"},ce={__name:"index",async setup(te){let s,_;const y=W(),g=R(),{setSearchValue:S,setPagePagination:w}=g,{page:i,limit:u,search:h}=V(g),b=p(localStorage.getItem("organizationId"));x(()=>{S("")}),H(h,()=>{w(1)});const f=p(""),v=X(h,500),z=p([{id:1,label:"productsName",width:725},{id:4,label:"productsState"},{id:5,label:"productsAction"}]),{data:n,isLoading:B,isSuccess:l,isError:E}=([s,_]=K(()=>j({queryKey:["products",{page:i,limit:u,debouncedSearch:v,organizationId:b}],queryFn:()=>G("construction_material",i.value,u.value,v.value,{organizationId:b.value}),select:t=>{let o=[...t==null?void 0:t.constructionMaterial];return o=o.map(d=>{const a={...d};return delete a.organizationName,a}),{constructionMaterial:o,count:t==null?void 0:t.count}}})),s=await s,_(),s),{mutate:M}=$({mutationFn:t=>J("construction_material",t),onSuccess:()=>{y.invalidateQueries({queryKey:["products"]}),y.invalidateQueries({queryKey:["productsById",f]})}}),N=async t=>{f.value=t,M(t)};return(t,o)=>{var P,T,C,k;const d=r("HeadPage"),a=r("Table"),L=r("Pagination"),O=r("Spinner");return c(),D("section",Y,[U("div",Z,[I(d,{title:"productsTitle",to:e(A).CREATE_PRODUCTS.path,onOnSearch:o[0]||(o[0]=Q=>e(S)(Q))},null,8,["to"]),e(l)&&((P=e(n))!=null&&P.count)?(c(),q(a,{key:0,headers:z.value,table:(T=e(n))==null?void 0:T.constructionMaterial,to:e(A).UPDATE_PRODUCTS.name,options:{page:e(i),limit:e(u)},onOnActionDelete:N},null,8,["headers","table","to","options"])):m("",!0),I(L,{count:(C=e(n))==null?void 0:C.count,isSucces:e(l)},null,8,["count","isSucces"]),e(B)?(c(),q(O,{key:1})):m("",!0),e(l)&&!((k=e(n))!=null&&k.count)||e(E)?(c(),D("div",ee,F(t.$t("emptyTableTitle")),1)):m("",!0)])])}}};export{ce as default};
//# sourceMappingURL=index-O7rXTELp.js.map
